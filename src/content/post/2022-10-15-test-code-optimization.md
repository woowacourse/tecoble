---
layout: post
title: "í…ŒìŠ¤íŠ¸ì½”ë“œ ì„±ëŠ¥ ê°œì„ ê¸°"
tags: ['Test', 'Spring Boot']
author: [4ê¸°_ìˆ˜ë‹¬]
date : "2022-10-27T13:10:00.000Z"
draft : false
image: ../teaser/testing-server.jpg
---
## ë“¤ì–´ê°€ë©°

> ì½”ë“œë¥¼ ìˆ˜ì •í•˜ë©´, ê²€í†  ìš”ì²­(PR) ê³¼ì •ì˜ ì²« ë²ˆì§¸ì— **ì „ì²´ í…ŒìŠ¤íŠ¸ ì½”ë“œ**ê°€ ì˜ ëŒì•„ê°€ëŠ”ì§€ í™•ì¸í•˜ëŠ” ê³¼ì •ì´ ì£¼ê¸°ì ìœ¼ë¡œ ì¼ì–´ë‚˜ê³  ìˆì–´ìš”.


í˜¼ì ê°œë°œí•˜ë©° í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì ‘í–ˆì„ ë•ŒëŠ” ë¹„ì§€ë‹ˆìŠ¤ ë¡œì§ì˜ ì•ˆì •ì„±ì„ ë³´ì¥í•´ì£¼ê³ , ë¬¸ì„œí™” ê¸°ëŠ¥ë„ ìˆì–´ í…ŒìŠ¤íŠ¸ëŠ” ë¬´ì¡°ê±´ ë§ìœ¼ë©´ ì¢‹ì€ ê²ƒì´ë¼ê³  ìƒê°í–ˆì—ˆì–´ìš”. 
ê·¸ëŸ¬ë‚˜ í”„ë¡œì íŠ¸ê°€ ì§„í–‰ë˜ë©´ì„œ ìš”êµ¬ì‚¬í•­ì´ ê³„ì† ì¶”ê°€ë˜ë‹¤ë³´ë‹ˆ í…ŒìŠ¤íŠ¸ ê°œìˆ˜ì™€ ìœ ì§€ë³´ìˆ˜ í¬ì¸íŠ¸ê°€ ëŠ˜ì–´ë‚¬ìŠµë‹ˆë‹¤. ì´ì—ë”°ë¼ ì†ë„ê°€ ì €í•˜ë˜ì–´ ê°œë°œ ìƒì‚°ì„±ì´ ë‚®ì•„ì§€ëŠ” ê²½í—˜ì„ í–ˆìŠµë‹ˆë‹¤.

'ì´ê²ƒì´ ë‹¨ìˆœíˆ í…ŒìŠ¤íŠ¸ ê°œìˆ˜ì˜ ë¬¸ì œ ì¼ê¹Œ?'í•˜ëŠ” ê¶ê¸ˆì¦ì´ ë“¤ì—ˆê³ , ì†ë„ë¥¼ ê°œì„ ì„ ì§„í–‰í•˜ë©° ëŠê¼ˆë˜ ì ì„ ê³µìœ í•˜ê³ ì í•©ë‹ˆë‹¤.

## ë§ˆí‹´ íŒŒìš¸ëŸ¬ì˜ í…ŒìŠ¤íŠ¸ í”¼ë¼ë¯¸ë“œì— ë§ì¶°ì„œ í…ŒìŠ¤íŠ¸ ë¹„ìœ¨ ì¡°ì •í•˜ê¸°

> í…ŒìŠ¤íŠ¸ í”¼ë¼ë¯¸ë“œëŠ” ìƒìœ„ ê³„ì¸µì˜ í…ŒìŠ¤íŠ¸ì¼ìˆ˜ë¡ ë¹„ìš©ì´ ë†’ê¸° ë•Œë¬¸ì— ìµœëŒ€í•œ ì ì€ ë¹„ìœ¨ë¡œ ìœ ì§€í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤ëŠ” ê²ƒì„ ë‚˜íƒ€ë‚´ìš”.

![í…ŒìŠ¤íŠ¸ í”¼ë¼ë¯¸ë“œ](../images/2022-10-15-test-optimization1.png)

### **ì¸ìˆ˜ í…ŒìŠ¤íŠ¸(**UI Test**)**

> ì¸ìˆ˜ í…ŒìŠ¤íŠ¸ëŠ” ì‚¬ìš©ì ìŠ¤í† ë¦¬(ì‹œë‚˜ë¦¬ì˜¤)ì— ë§ì¶° ìˆ˜í–‰í•˜ëŠ” í…ŒìŠ¤íŠ¸ì´ë‹¤. ì‹œë‚˜ë¦¬ì˜¤ì—ì„œ ìš”êµ¬í•˜ëŠ” ê²ƒì€ `ëˆ„ê°€, ì–´ë–¤ ëª©ì ìœ¼ë¡œ, ë¬´ì—‡ì„ í•˜ëŠ”ê°€`ì´ë‹¤. ì´ëŠ” APIë¥¼ í†µí•´ ë“œëŸ¬ë‚œë‹¤.  ì¸ìˆ˜ í…ŒìŠ¤íŠ¸ëŠ” ì†Œí”„íŠ¸ì›¨ì–´ ì¸ìˆ˜ë¥¼ ëª©ì ìœ¼ë¡œ í•˜ëŠ” í…ŒìŠ¤íŠ¸ì´ë‹¤. ì†Œí”„íŠ¸ì›¨ì–´ë¥¼ ì¸ìˆ˜í•˜ê¸° ì „ì— ëª…ì„¸í•œ ìš”êµ¬ì‚¬í•­(ì¸ìˆ˜ ì¡°ê±´)ëŒ€ë¡œ ì˜ ì‘ë™í•˜ëŠ”ì§€ ê²€ì¦ì´ í•„ìš”í•˜ë‹¤.


[ì €í¬ í”„ë¡œì íŠ¸](https://github.com/woowacourse-teams/2022-ternoko)ì—ì„œëŠ” `RestAssured` ë¥¼ ì‚¬ìš©í•˜ì—¬ 
ì‹¤ì œ HTTP ìš”ì²­ì„ ë³´ë‚´ ì¸ìˆ˜ í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•˜ê³  ìˆì–´ìš”. ë„¤íŠ¸ì›Œí¬ ì‘ë‹µ ëŒ€ê¸° ì‹œê°„ì´ ì†Œìš”ë˜ê¸° ë•Œë¬¸ì— ì¸ìˆ˜ í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰í•˜ëŠ”ë° ê°€ì¥ ì˜¤ëœ ì‹œê°„ì´ ê±¸ë ¸ì–´ìš”.

ì™œê·¸ëŸ´ê¹Œ ì‚´í´ë³´ë‹ˆ **ì¸ìˆ˜í…ŒìŠ¤íŠ¸**ì—ì„œ ê²€ì¦í•˜ëŠ” ëŒ€ë‹¤ìˆ˜ì˜ í–‰ìœ„ë¥¼ **í†µí•©í…ŒìŠ¤íŠ¸**ì—ì„œ **ì¤‘ë³µí•´ì„œ ê²€ì¦**í•˜ê³  ìˆì—ˆì–´ìš”. ì˜ˆì™¸ ì¼€ì´ìŠ¤ ê¹Œì§€ë„ìš”. 
ì €í¬ê°€ ì¸ìˆ˜í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•œ ëª©ì ì€ ì„œë¹„ìŠ¤ì˜ ìš”êµ¬ì‚¬í•­ì´ ì œëŒ€ë¡œ ë™ì‘í•˜ëŠ” ê°€ë¥¼ í™•ì¸í•˜ê¸° ìœ„í•¨ì´ì—ˆëŠ”ë° ë§ì´ì£ .

ë”°ë¼ì„œ ì¸ìˆ˜í…ŒìŠ¤íŠ¸ì—ì„œëŠ” APIì˜ ì„±ê³µ ì‚¬ë¡€ë“¤ë§Œ ê²€ì¦í•˜ê³ , **ì˜ˆì™¸ ì²˜ë¦¬ì— ëŒ€í•´ì„œëŠ” í†µí•©í…ŒìŠ¤íŠ¸ë¡œ ë‚´ë¦¬ë©´** í…ŒìŠ¤íŠ¸ ì‹œê°„ë„ ì¤„ì¼ ìˆ˜ ìˆê³ , í…ŒìŠ¤íŠ¸ ëª©ì ì—ë„ ë” ë¶€í•©í•˜ì§€ 
ì•Šì„ê¹Œ ìƒê°ë˜ì—ˆìŠµë‹ˆë‹¤.

### **í†µí•© í…ŒìŠ¤íŠ¸(Integration Test)**

> í†µí•© í…ŒìŠ¤íŠ¸ëŠ” ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ë³´ë‹¤ ë” í° ë™ì‘ì„ ë‹¬ì„±í•˜ê¸° ìœ„í•´ ì—¬ëŸ¬ ëª¨ë“ˆë“¤ì„ ëª¨ì•„ ì´ë“¤ì´ ì˜ë„ëŒ€ë¡œ í˜‘ë ¥í•˜ëŠ”ì§€ í™•ì¸í•˜ëŠ” í…ŒìŠ¤íŠ¸ì´ë‹¤. @SpringBootTest ë¥¼ ì‚¬ìš©í•˜ì—¬ 
> ì‘ì„±í•  ìˆ˜ ìˆë‹¤. í†µí•© í…ŒìŠ¤íŠ¸ëŠ” ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ì™€ ë‹¬ë¦¬ ê°œë°œìê°€ ë³€ê²½í•  ìˆ˜ ì—†ëŠ” ë¶€ë¶„(ex. ì™¸ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬)ê¹Œì§€ ë¬¶ì–´ ê²€ì¦í•  ë•Œ ì‚¬ìš©í•œë‹¤. 
> ì´ëŠ” DBì— ì ‘ê·¼í•˜ê±°ë‚˜ ì „ì²´ ì½”ë“œì™€ ë‹¤ì–‘í•œ í™˜ê²½ì´ ì œëŒ€ë¡œ ì‘ë™í•˜ëŠ”ì§€ í™•ì¸í•˜ëŠ”ë° í•„ìš”í•œ ëª¨ë“  ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆë‹¤.

í†µí•©í…ŒìŠ¤íŠ¸ëŠ” @SpringBootTest ì• ë„ˆí…Œì´ì…˜ì„ ì‚¬ìš©í•˜ì—¬ ì—¬ëŸ¬ ê°ì²´ë“¤ì´ ì„œë¡œ ì˜ í˜‘ë ¥í•˜ëŠ”ì§€, í˜‘ë ¥í•˜ëŠ” ê³¼ì •ì—ì„œ side effect ê°€ ë°œìƒí•˜ì§€ëŠ” ì•ŠëŠ”ì§€ í™•ì¸í•˜ëŠ” ìš©ë„ë¡œ ì‘ì„±í–ˆì–´ìš”.

ê·¸ëŸ°ë° ì½”ë“œë¥¼ ì‚´í´ë³´ë‹ˆ, ê°ì²´ ê°„ í˜‘ë ¥ì´ ì•„ë‹Œ ë„ë©”ì¸ ë¡œì§ì˜ ê²€ì¦ì´ Service ë‚˜ Controller ì— ì‘ì„±ë˜ì–´ ìˆì—ˆìŠµë‹ˆë‹¤. ì¦‰ ì—¬ëŸ¬ ê°ì²´ ì‚¬ì´ì˜ ìƒí˜¸ ì‘ìš©ì´ ì•„ë‹ˆë¼ ë‹¨ì¼ ê°ì²´ì— ëŒ€í•œ í…ŒìŠ¤íŠ¸ê°€ ì§„í–‰ë˜ê³  ìˆì—ˆìŠµë‹ˆë‹¤.

í•´ë‹¹ í…ŒìŠ¤íŠ¸ ê³„ì¸µì˜ ì±…ì„ì´ ì•„ë‹ˆë¼ê³  íŒë‹¨ë˜ì–´ ê° ë‹¨ìœ„ë¡œ ì ì ˆí•˜ê²Œ ì±…ì„ì„ ë‚´ë ¤ì£¼ì—ˆìŠµë‹ˆë‹¤.

### **ë‹¨ìœ„ í…ŒìŠ¤íŠ¸(Unit Test)**

> ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ëŠ” ì‘ìš© í”„ë¡œê·¸ë¨ì—ì„œ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥í•œ ê°€ì¥ ì‘ì€ ì†Œí”„íŠ¸ì›¨ì–´ë¥¼ ì‹¤í–‰í•˜ì—¬ ì˜ˆìƒëŒ€ë¡œ ë™ì‘í•˜ëŠ”ì§€ í™•ì¸í•˜ëŠ” í…ŒìŠ¤íŠ¸ì´ë‹¤.

ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ëŠ” í…ŒìŠ¤íŠ¸ í”¼ë¼ë¯¸ë“œ ê°€ì¥ ì•„ë˜ì— ìœ„ì¹˜í•˜ëŠ” í…ŒìŠ¤íŠ¸ ì…ë‹ˆë‹¤. ë…ë¦½ì ì¸ ê°ì²´ í…ŒìŠ¤íŠ¸ì´ê¸° ë•Œë¬¸ì— í…ŒìŠ¤íŠ¸ ë¹„ìš©ì´ ê°€ì¥ ì ìŠµë‹ˆë‹¤. 
ë¹„ì¦ˆë‹ˆìŠ¤ë¥¼ êµ¬ì„±í•  ë•Œ ê° ë„ë©”ì¸ì´ ìœ íš¨ì„± ê²€ì¦ì— ëŒ€í•œ ì±…ì„ê³¼ í–‰ìœ„ì— ëŒ€í•œ ì±…ì„ ë“± ì ì ˆí•œ ì±…ì„ì„ ê°€ì§€ê³  ìˆìœ¼ë©´ ê°ì²´ ë¼ë¦¬ ë©”ì„¸ì§€ë¥¼ ì£¼ê³  ë°›ê¸° ìˆ˜ì›”í•´ì§€ê³  
ê°ì²´ì§€í–¥ì ì„ì— í•œê±¸ìŒ ë‹¤ê°€ê°ˆ ìˆ˜ ìˆê²Œ ë˜ëŠ” ê²ƒ ê°™ì•„ìš”.

ë”°ë¼ì„œ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ëŠ” ê¼¼ê¼¼í•˜ê²Œ ì‘ì„±í•´ì£¼ë©´ ì¢‹ì•„ìš”.

### í…ŒìŠ¤íŠ¸ í”¼ë¼ë¯¸ë“œì— ë§ì¶°ì„œ í…ŒìŠ¤íŠ¸ ë¹„ìœ¨ ì¡°ì •í•´ë³´ë©°

ë¶ˆí•„ìš”í•œ í…ŒìŠ¤íŠ¸ ë¹„ìš©ì„ ì œê±°í•˜ë‹ˆ ê°™ì€ ë¡œì§ì„ ë” ë¹ ë¥´ê²Œ í…ŒìŠ¤íŠ¸ í•  ìˆ˜ ìˆê²Œ ë˜ì—ˆì–´ìš”. ğŸ˜€ì—¬ê¸°ì„œ ì£¼ì˜í•  ì ì€ **ëª¨ë“  ê²½ìš°ì— í•­ìƒ í”¼ë¼ë¯¸ë“œí˜• í…ŒìŠ¤íŠ¸ ë¹„ìœ¨ì„ 
ìœ ì§€í•  ìˆ˜ëŠ” ì—†ë‹¤**ëŠ” ì ì´ì˜ˆìš”. ë„ë©”ì¸ì´ ê°„ë‹¨í•´ í•„ìš”í•œ í…ŒìŠ¤íŠ¸ì˜ ì–‘ì´ ë§ì§€ ì•Šì€ ê²½ìš°ì— API ê°œìˆ˜ë§Œí¼ ì¸ìˆ˜í…ŒìŠ¤íŠ¸ë¥¼ ì‘ì„±í•œë‹¤ê³  ê°€ì •í•˜ë©´ ì•„ë˜ì²˜ëŸ¼ ì¸ìˆ˜ í…ŒìŠ¤íŠ¸ì˜ 
ë¹„ìœ¨ê³¼ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ì˜ ë¹„ìœ¨ì´ ë¹„ìŠ·í•  ìˆ˜ë„ ìˆê² ì£ ? ë”°ë¼ì„œ í˜„ì¬ ê°€ì§€ê³  ìˆëŠ” ë„ë©”ì¸ì˜ íŠ¹ì„±ì„ íŒŒì•…í•´ì„œ í…ŒìŠ¤íŠ¸ ë¹„ìœ¨ì„ ì¡°ì •í•˜ê² ë‹¤ëŠ” ìœ ì—°í•œ ì‚¬ê³ ë¥¼ í•œë‹¤ë©´ ë” ì¢‹ê² ë„¤ìš”.

![test pyramid](../images/2022-10-15-test-optimization2.png)

## Application Context  ë¥¼ ì‚´í´ë³´ì.

ê·¸ ë‹¤ìŒìœ¼ë¡œëŠ” Application Context ì— ëŒ€í•œ í•™ìŠµì„ ì§„í–‰í–ˆì–´ìš”. ì „ì²´ í…ŒìŠ¤íŠ¸ë¥¼ ëŒë¦¬ë©´ ìŠ¤í”„ë§ ë¶€íŠ¸ê°€ ì—¬ëŸ¬ë²ˆ ë„ì›Œì§€ëŠ” ê²½ìš°ë¥¼ ë³´ì…¨ì„ê±°ì˜ˆìš”. 
ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë¡œë“œí•  ë•Œ Application Contextì— ë¹ˆì„ ë“±ë¡í•˜ê¸° ìœ„í•´ì„œ @Bean ìœ¼ë¡œ ì„ ì–¸ëœ ê°ì²´ë“¤ì„ ì°¾ëŠ” ë“±ì˜ ì‘ì—…ì´ ì§„í–‰ë˜ê¸° ë•Œë¬¸ì— ì‹œê°„ì´ ì˜¤ë˜ ê±¸ë ¤ìš”. 
ë”°ë¼ì„œ Application Context ì¬ì‚¬ìš©í•˜ë©´, ì „ì²´ í…ŒìŠ¤íŠ¸ë¥¼ ëŒë¦¬ëŠ” ì‹œê°„ë„ ì¤„ê² ë‹¤ê³  ìƒê°í–ˆì–´ìš”.

![boot](../images/2022-10-15-test-optimization3.png)

í˜„ì¬ ì•„ë˜ì™€ ê°™ì€ í•­ëª©ì— ëŒ€í•´ì„œ Application Contextë¥¼ ì‚¬ìš©í•˜ê³  ìˆì–´ìš”.

- Acceptance Test
- Service Test
- DataJpa Test
- WebMvc Test

ë”°ë¼ì„œ ê° ê³„ì¸µë§ˆë‹¤ í•œë²ˆì”©ë§Œ Application Contextê°€ ë„ì›Œì§€ëŠ” ê²ƒì„ ëª©í‘œë¡œ ì‚¼ê³  ë¦¬íŒ©í„°ë§ì„ ì§„í–‰í•´ë´¤ì–´ìš”.

### @DirtiesContext ê±·ì–´ë‚´ê¸°

> Use this annotation if a test has modified the context â€” for example, by modifying the state of a singleton bean, modifying the state of an embedded database, etc. Subsequent tests that request the same context will be supplied a new context.

**ë°ì´í„° ê²©ë¦¬**ë¥¼ ìœ„í•´ ì‚¬ìš©í–ˆë˜ [@DirtiesContext](https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/test/annotation/DirtiesContext.html) 
ë•Œë¬¸ì— ëª¨ë“  í…ŒìŠ¤íŠ¸ê°€ ì¢…ë£Œë˜ê³  Context ë¥¼ ì¬ìƒì„±í•˜ê¸° ë•Œë¬¸ì— ì‹œê°„ì´ ì˜¤ë˜ ê±¸ë ¸ì–´ìš”.

**ë°ì´í„° ê²©ë¦¬**ë¼ëŠ” ëª©ì ì€ Bean ì¬ìƒì„± ì—†ì´ DBë¥¼ ìˆ˜ë™ìœ¼ë¡œ  ì´ˆê¸°í™” í•´ì£¼ë©´ ë˜ê² ë‹¤ëŠ” ìƒê°ìœ¼ë¡œ ì´ì–´ì¡Œê³ , DirtiesContext ë¥¼ ê±·ì–´ë‚´ê³ , 
DataBaseCleaner ë¥¼ ì‚¬ìš©í•´ì„œ Context ì¬ìƒì„±ì„ ì¤„ì˜€ìŠµë‹ˆë‹¤.

```java
public class DatabaseCleaner {

    private EntityManager entityManager;
    private List<String> tableNames;

....

@Transactional
    public void tableClear() {
        entityManager.flush();
        entityManager.clear();

        entityManager.createNativeQuery("SET REFERENTIAL_INTEGRITY FALSE").executeUpdate();

        for (String tableName : tableNames) {
            entityManager.createNativeQuery("TRUNCATE TABLE " + tableName + " RESTART IDENTITY ").executeUpdate();
        }

        entityManager.createNativeQuery("SET REFERENTIAL_INTEGRITY TRUE").executeUpdate();
    }
```

### **Context Caching**

> Once the TestContext framework loads an ApplicationContext (or WebApplicationContext) for a test, that context is cached and reused for all subsequent tests that declare the same unique context configuration within the same test suite. To understand how caching works, it is important to understand what is meant by â€œuniqueâ€ and â€œtest suite.â€

ë˜í•œ SpringBootTest ë¥¼ ì‚¬ìš©í•˜ë©´ì„œ [Contextë¥¼ ìºì‹±](https://docs.spring.io/spring-framework/docs/current/reference/html/testing.html#testcontext-ctx-management-caching)í•  
ìˆ˜ ìˆë‹¤ëŠ” ì ì„ ë°œê²¬í•˜ê²Œ ë˜ì—ˆì–´ìš”.

'ë™ì¼í•œ ê³ ìœ  ì»¨í…ìŠ¤íŠ¸ êµ¬ì„±ì„ ì„ ì–¸í•˜ëŠ” ëª¨ë“  í›„ì† í…ŒìŠ¤íŠ¸ì— ì¬ì‚¬ìš© ëœë‹¤'ëŠ” ë¶€ë¶„ì—ì„œ `ê³ ìœ  ì»¨í…ìŠ¤íŠ¸ êµ¬ì„±`ì´ ë¬´ì—‡ì„ ì˜ë¯¸í•˜ëŠ”ì§€ ì‚´í´ë´¤ì–´ìš”. ê·¸ì¤‘ì—ì„œ ì•„ë˜ ë¶€ë¶„ì´ ëˆˆì— ë„ì—ˆì–´ìš”.

- `contextCustomizers`(from `ContextCustomizerFactory`) â€“ this includes `@DynamicPropertySource` methods as well as various features from Spring Bootâ€™s testing support such as `@MockBean` and `@SpyBean`.

ë°”ë¡œ í…ŒìŠ¤íŠ¸ ê²©ë¦¬ë¥¼ ìœ„í•´ì„œ ì‚¬ìš©í–ˆë˜ [MockBean, SpyBean](https://docs.spring.io/spring-boot/docs/current/reference/html/features.html#features.testing.spring-boot-applications.mocking-beans) ì´ ê°ì²´ë§ˆë‹¤ ë‹¤ë¥´ê²Œ ì„ ì–¸ë˜ì–´ ìˆì—ˆë˜ ì ì´ ë¬¸ì œì˜€ëŠ”ë°ìš”.

### @MockBean , @SpyBean

> When you are using `@SpyBean` to spy on a bean that is proxied by Spring, you may need to remove Springâ€™s proxy in some situations, for example when setting expectations using `given` or `when`. Use `AopTestUtils.getTargetObject(yourProxiedSpy)`to do so.

í•´ë‹¹ ì–´ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•˜ë©´ ëŒ€ë¦¬ ê°ì²´ê°€ ìƒì„±ë˜ì–´ ì‹¤ì œ ê°ì²´ê°€ ì•„ë‹ˆë¼, ëŒ€ë¦¬ ê°ì²´ê°€ ìƒì„±ë˜ê³  ìˆì—ˆì–´ìš”. ë”°ë¼ì„œ ë‹¹ì—°í•˜ê²Œ Context ì— ìƒì„±ë˜ëŠ” ê¸°ì¡´ ê°ì²´ê°€ ì•„ë‹Œ ëŒ€ë¦¬ ê°ì²´ê°€ ì¶”ê°€ ë˜ê¸° ë•Œë¬¸ì— ê³ ìœ  ì»¨í…ìŠ¤íŠ¸ êµ¬ì„±ì´ ì˜¤ì—¼ë˜ì—ˆë‹¤ê³  íŒë‹¨í•´ì„œ ìƒˆë¡œìš´ Context ë¥¼ ë„ìš°ê²Œ ë˜ëŠ” ê²ƒì´ì—ˆì–´ìš”!

### ì¬ì‚¬ìš© ê°€ëŠ¥í•œ í…ŒìŠ¤íŠ¸ êµ¬ì¡° ğŸ¤”

ì²˜ìŒë¶€í„° í•„ìš”í•œ ëŒ€ë¦¬ ê°ì²´ê°€ ë¬´ì—‡ì¸ì§€ íŒŒì•…í•œ ë’¤  Mock, Spy í•œë²ˆì—  ì„ ì–¸í•˜ì—¬ Context ì— ì˜¬ë ¤ë‘ê³ , Test Class ë“¤ì´ ìƒì† ë°›ì•„ ì‚¬ìš©í•˜ëŠ” í˜•íƒœë¡œ êµ¬í˜„í•œë‹¤ë©´ ì»¨í…ìŠ¤íŠ¸ ì´ˆê¸°í™”ë¥¼ í•œë²ˆë§Œ í•˜ëŠ” ê²ƒì´ ê°€ëŠ¥í•´ì§ˆ ê²ƒ ê°™ì•˜ì–´ìš”.

```java
@WebMvcTest
@Import({...})
public class WebMvcTestSupporter {

    protected MockMvc mockMvc;

    @Autowired
    protected Class realClassA;

    @MockBean
    protected Class classA;

   @MockBean
    protected Class classB;

   @SpyBean
    protected Class classC;
}

...

public class ControllerTestA extends WebMvcTestSupporter {
  @Test
	void testA() {}
}
```

êµ¬ì¡°ë¥¼ ë³€ê²½í–ˆë”ë‹ˆ ì •ë§ Context ì´ˆê¸°í™”ê°€ í•œë²ˆë§Œ ì´ë¤„ì¡ŒìŠµë‹ˆë‹¤. ì—¬ê¸°ì„œ ê·¸ëŸ¼ ê²©ë¦¬í•˜ê³  ì‹¶ì€ ê°ì²´ ì „ë¶€ ìµœìƒìœ„ ê°ì²´ì— í…ŒìŠ¤íŠ¸ ë”ë¸”ì„ ì‚¬ìš©í•˜ë©´ ìƒê°í•˜ì‹¤ ìˆ˜ë„ ìˆëŠ”ë°ìš”. ì‹¤ì œ ê°ì²´ê°€ í•„ìš”í•œ ìƒíƒœì¸ë° í…ŒìŠ¤íŠ¸ ë”ë¸”ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì•„ë‹Œì§€ ìœ ì˜í•˜ì—¬ ê°ì²´ë¥¼ ì„¤ê³„í•´ì•¼ ìœ ì˜ë¯¸í•œ í…ŒìŠ¤íŠ¸ê°€ ê°€ëŠ¥í•˜ë‹¤ëŠ” ì ì„ ì£¼ì˜ í•˜ì…¨ìœ¼ë©´ ì¢‹ê² ìŠµë‹ˆë‹¤.

## ê²°ë¡ 

- í…ŒìŠ¤íŠ¸ í”¼ë¼ë¯¸ë“œë¥¼ ì°¸ê³ í•´ì„œ ê³„ì¸µë³„ í…ŒìŠ¤íŠ¸ ë¹„ìœ¨ì„ ì¡°ì ˆí•˜ì
- ë¶ˆí•„ìš”í•œ ì„¤ì •ì„ ì œê±°í•˜ì (ControllerTest â†’ WebMvcTest ë¡œ ë‚´ë¦°ë‹¤ë“ ê°€) âœğŸ»
- ë°ì´í„° ê²©ë¦¬ ë°©ì‹ìœ¼ë¡œ DirtiesContext ê±·ì–´ë‚´ì
- ì¬ì‚¬ìš© ê°€ëŠ¥í•œ í…ŒìŠ¤íŠ¸ êµ¬ì¡°ë¥¼ ê³ ë¯¼í•´ë³´ì

í…ŒìŠ¤íŠ¸ ì½”ë“œ ì„±ëŠ¥ ê°œì„ ì„ í•˜ê³ ì í–ˆë˜ ë¦¬íŒ©í† ë§ì„ í†µí•´ ë”ìš± ê°ì²´ì§€í–¥ì ì¸ ì½”ë“œ ì‘ì„±ì´ ê°€ëŠ¥í•´ì§€ê³ , ì „ì²´ í…ŒìŠ¤íŠ¸ê°€ ëŒì•„ê°€ëŠ” ì†ë„ê°€ í–¥ìƒë˜ì–´ íŒ€ì˜ ê°œë°œ ìƒì‚°ì„±ì´ í•œì¸µ ì¢‹ì•„ì¡ŒìŠµë‹ˆë‹¤. ì œê°€ ì ‘ê·¼í•œ ê°œì„  ë°©í–¥ì´ ì •ë‹µì´ ì•„ë‹ ìˆ˜ë„ ìˆì§€ë§Œ, í•´ë‹¹ ë‚´ìš©ì„ ê²½í—˜í•˜ë©° ì¬ë¯¸ë¥¼ ëŠë¼ê³ , íŒ€ì— ìƒì‚°ì„±ì„ í–¥ìƒ ì‹œí‚¤ëŠ”ë° ê¸°ì—¬ í–ˆë‹¤ëŠ” ëŠë‚Œì— í–‰ë³µí–ˆìŠµë‹ˆë‹¤. ì˜¤ëŠ˜ë„ ì¦ê±°ìš´ í•™ìŠµ í•˜ì‹œê¸¸ ë°”ëë‹ˆë‹¤.  ğŸ‘


### ì°¸ê³ ìë£Œ

## 

- [Spring.io Context Caching](https://docs.spring.io/spring-framework/docs/current/reference/html/testing.html#testcontext-ctx-management-caching)
- [Spring.io Mocking and Spying Beans](https://docs.spring.io/spring-boot/docs/current/reference/html/features.html#features.testing.spring-boot-applications.mocking-beans)
- [Spring.io DirtiesContext](https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/test/annotation/DirtiesContext.html)
