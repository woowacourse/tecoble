{"componentChunkName":"component---src-templates-post-tsx","path":"/post/2022-11-07-mysql-isolation/","result":{"data":{"logo":{"childImageSharp":{"fixed":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAwUlEQVQY003Qvw7BUBTH8YYgLCKExWw1IczEwAtIJCa1GJuyCalI/EmERUgHi5cxeI8uTTt1aHp9r9wmhk/OOfee/HJzNd/3Dc/zutS24zgZIUQpiqIt9YY+vUb9+eur6Kh5GN9LGkEn2DBd1y1zmGfxjjf9AFm1XEQCBe6aVBMVLJHiLBcHTiHwQS0MQ/mSOlYsjPDCAjOMccUFR3Z0NdvYISkDW9jAQi8IAhnYgAyZ4wELEzUfcFZfYmCPJ9ZIfwG9owW1fLgCkwAAAABJRU5ErkJggg==","width":400,"height":88,"src":"/static/0b18bd94a62a12fdc81ea720c28722f6/3891b/tecoble.png","srcSet":"/static/0b18bd94a62a12fdc81ea720c28722f6/3891b/tecoble.png 1x"}}},"markdownRemark":{"html":"<h2><strong>Transaction Isolation Level</strong></h2>\n<p>애플리케이션을 개발 중 데이터베이스를 도입하면 격리 수준에 대한 이해가 자연스럽게 요구됩니다. 격리 수준은 데이터베이스의 ACID 성질 중 Isolation 에 해당하며, 여러 트랜잭션이 동시에 변경을 수행할 때 성능과 안정성, 일관성 및 재현성 간의 규형을 미세하게 조정하는 설정입니다. SQL:1992 표준에서 제공하는 4가지 격리 수준의 종류는 아래와 같습니다.</p>\n<ul>\n<li><code class=\"language-text\">READ UNCOMMITTED</code></li>\n<li><code class=\"language-text\">READ COMMITTED</code></li>\n<li><code class=\"language-text\">REPEATABLE READ</code></li>\n<li><code class=\"language-text\">SERIALIZABLE</code></li>\n</ul>\n<p>MySQL 의 <code class=\"language-text\">InnoDB</code> 는 MVCC 와 2-Phase Locking 의 장점을 적절히 조합하여 트랜잭션 모델을 구현하였는데요. 이를 이해하기 위해선 <code class=\"language-text\">InnoDB</code> 의 Locking, Consistent Non-Locking Read, Locking Read 등과 같은 개념이 선행되어야 합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">TABLE</span> test <span class=\"token punctuation\">(</span>\n  id <span class=\"token keyword\">BIGINT</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">AUTO_INCREMENT</span><span class=\"token punctuation\">,</span>\n  name <span class=\"token keyword\">VARCHAR</span><span class=\"token punctuation\">(</span><span class=\"token number\">255</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span>\n  age <span class=\"token keyword\">BIGINT</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span>\n  <span class=\"token keyword\">PRIMARY</span> <span class=\"token keyword\">KEY</span> <span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">insert</span> <span class=\"token keyword\">into</span> test <span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">,</span> name<span class=\"token punctuation\">,</span> age<span class=\"token punctuation\">)</span> <span class=\"token keyword\">values</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'quaritch'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">25</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">insert</span> <span class=\"token keyword\">into</span> test <span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">,</span> name<span class=\"token punctuation\">,</span> age<span class=\"token punctuation\">)</span> <span class=\"token keyword\">values</span> <span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'orca'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">26</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">insert</span> <span class=\"token keyword\">into</span> test <span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">,</span> name<span class=\"token punctuation\">,</span> age<span class=\"token punctuation\">)</span> <span class=\"token keyword\">values</span> <span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'chan'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">26</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">insert</span> <span class=\"token keyword\">into</span> test <span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">,</span> name<span class=\"token punctuation\">,</span> age<span class=\"token punctuation\">)</span> <span class=\"token keyword\">values</span> <span class=\"token punctuation\">(</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'ori'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">27</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">insert</span> <span class=\"token keyword\">into</span> test <span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">,</span> name<span class=\"token punctuation\">,</span> age<span class=\"token punctuation\">)</span> <span class=\"token keyword\">values</span> <span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'awesomeo'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">26</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>이 글에선 여러 예시들이 사용될 예정입니다. 모든 예시는 위 테이블을 바탕으로 진행되는 점을 참고하며 읽으시면 좀 더 원활한 이해가 가능할 것 같습니다.</p>\n<h2><strong>InnoDB Locking</strong></h2>\n<p>MySQL 의 <code class=\"language-text\">InnoDB</code> 에선 다양한 Locking 기법을 사용합니다. 그 중 <code class=\"language-text\">InnoDB</code> 의 트랜잭션 격리 수준을 구현하기 위해 사용되는 대표적인 3가지 Lock 에 대해 우선 살펴보고자 합니다.</p>\n<h3><strong>Record Lock</strong></h3>\n<p><code class=\"language-text\">Record Lock</code> 은 인덱스 레코드에 설정되는 Lock 입니다. 테이블에 인덱스가 정의되지 않았어도 <code class=\"language-text\">InnoDB</code> 에선 숨겨진 Clustered Index 를 생성하기 때문에 이를 활용하여 <code class=\"language-text\">Record Lock</code> 을 적용할 수 있습니다.</p>\n<p>예를 들어, <code class=\"language-text\">SELECT name FROM test WHERE id = 1 FOR UPDATE;</code> 라는 쿼리를 실행하면 <code class=\"language-text\">id</code> 가 1 에 해당하는 레코드에 <code class=\"language-text\">Record Lock</code> 이 설정되기 때문에 다른 트랜잭션이 <code class=\"language-text\">id</code> 가 1 인 레코드를 변경하는 작업을 수행할 수 없습니다.</p>\n<p>아래는 해당 상황을 연출하고 <code class=\"language-text\">SHOW ENGINE INNODB STATUS</code> 를 통해 <code class=\"language-text\">Record Lock</code> 이 설정된 것을 확인한 로그입니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\">RECORD LOCKS space id <span class=\"token number\">10</span> page <span class=\"token keyword\">no</span> <span class=\"token number\">4</span> n bits <span class=\"token number\">72</span> <span class=\"token keyword\">index</span> <span class=\"token keyword\">PRIMARY</span> <span class=\"token keyword\">of</span> <span class=\"token keyword\">table</span> <span class=\"token punctuation\">`</span>transaction_test<span class=\"token punctuation\">`</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">`</span>test<span class=\"token punctuation\">`</span>\ntrx id <span class=\"token number\">3162</span> lock_mode X locks rec but <span class=\"token operator\">not</span> gap waiting\nRecord <span class=\"token keyword\">lock</span><span class=\"token punctuation\">,</span> heap <span class=\"token keyword\">no</span> <span class=\"token number\">2</span> PHYSICAL RECORD: n_fields <span class=\"token number\">5</span><span class=\"token punctuation\">;</span> compact format<span class=\"token punctuation\">;</span> info bits <span class=\"token number\">0</span>\n <span class=\"token number\">0</span>: len <span class=\"token number\">8</span><span class=\"token punctuation\">;</span> hex <span class=\"token number\">8000000000000001</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">asc</span>         <span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span>\n <span class=\"token number\">1</span>: len <span class=\"token number\">6</span><span class=\"token punctuation\">;</span> hex <span class=\"token number\">000000000</span>c4b<span class=\"token punctuation\">;</span> <span class=\"token keyword\">asc</span>      K<span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span>\n <span class=\"token number\">2</span>: len <span class=\"token number\">7</span><span class=\"token punctuation\">;</span> hex <span class=\"token number\">820000008</span>e0110<span class=\"token punctuation\">;</span> <span class=\"token keyword\">asc</span>        <span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span>\n <span class=\"token number\">3</span>: len <span class=\"token number\">8</span><span class=\"token punctuation\">;</span> hex <span class=\"token number\">7175617269746368</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">asc</span> quaritch<span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span>\n <span class=\"token number\">4</span>: len <span class=\"token number\">8</span><span class=\"token punctuation\">;</span> hex <span class=\"token number\">8000000000000019</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">asc</span>         <span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h3><strong>Gap Lock</strong></h3>\n<p><code class=\"language-text\">Gap Lock</code> 은 인덱스 레코드 간의 Gap 혹은 첫 번째 또는 마지막 인덱스 레코드 전/후의 Gap 에 설정되는 Lock 입니다. Gap 자체에 Lock 이 설정되었기 때문에 삽입하려는 곳의 값 존재 여부와 관계 없이 다른 트랜잭션에서 데이터를 삽입할 수 없습니다.</p>\n<p>예를 들어, <code class=\"language-text\">SELECT name FROM test WHERE id >= 1 FOR UPDATE;</code> 라는 쿼리를 실행하고 다른 트랜잭션이 <code class=\"language-text\">id</code> 가 8 인 데이터를 삽입하려고 할 경우 해당 <code class=\"language-text\">id</code> 값은 <code class=\"language-text\">Gap Lock</code> 이 설정된 상태이기 때문에 삽입 작업을 수행할 수 없습니다.</p>\n<p>아래는 해당 상황을 연출하고 <code class=\"language-text\">Gap Lock</code> 이 설정된 것을 확인한 결과입니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1586px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/835d1e9d20122dc2da7d30c264faeccf/867ee/Screen_Shot_2022-11-08_at_4.07.08_PM.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 29.2%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA/ElEQVQY00VQ2W6EMAzka0oSjoQjEM6FXWmr9v//Z+qxoPtgxdieiyylCW3boa5rpGnGMCbtu75HH6O8EW3X682YEtb9QAgB3ntE2XPO/q4sCkFZljAmx5BmJcjzL/imVaJGAJyx+iFhXndYa+GcQ2hbFPLe3+TJ9uOJRsDWGlWflk3J6TDNCygYQoOicJjmFc/3j/SFgjsRpKuqqrSYLNtIKC6oQoJRYpPc+4D6OiaYsz6OInp+CC/n/79FKlsfJ4I6vAjTTegVxCgkcM4iDkL4ONVtSVfi6LO/Ir++f1XBGINNjpftgMlzjUkQwQRQhIIviXyDmYy7uzj7A41wvOvD7g+rAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Screen Shot 2022-11-08 at 4.07.08 PM.png\"\n        title=\"Screen Shot 2022-11-08 at 4.07.08 PM.png\"\n        src=\"/static/835d1e9d20122dc2da7d30c264faeccf/867ee/Screen_Shot_2022-11-08_at_4.07.08_PM.png\"\n        srcset=\"/static/835d1e9d20122dc2da7d30c264faeccf/0eb09/Screen_Shot_2022-11-08_at_4.07.08_PM.png 500w,\n/static/835d1e9d20122dc2da7d30c264faeccf/1263b/Screen_Shot_2022-11-08_at_4.07.08_PM.png 1000w,\n/static/835d1e9d20122dc2da7d30c264faeccf/867ee/Screen_Shot_2022-11-08_at_4.07.08_PM.png 1586w\"\n        sizes=\"(max-width: 1586px) 100vw, 1586px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\">RECORD LOCKS space id <span class=\"token number\">11</span> page <span class=\"token keyword\">no</span> <span class=\"token number\">4</span> n bits <span class=\"token number\">72</span> <span class=\"token keyword\">index</span> <span class=\"token keyword\">PRIMARY</span> <span class=\"token keyword\">of</span> <span class=\"token keyword\">table</span> <span class=\"token punctuation\">`</span>transaction_test<span class=\"token punctuation\">`</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">`</span>test<span class=\"token punctuation\">`</span>\ntrx id <span class=\"token number\">3194</span> lock_mode X locks gap before rec <span class=\"token keyword\">insert</span> intention waiting\nRecord <span class=\"token keyword\">lock</span><span class=\"token punctuation\">,</span> heap <span class=\"token keyword\">no</span> <span class=\"token number\">5</span> PHYSICAL RECORD: n_fields <span class=\"token number\">5</span><span class=\"token punctuation\">;</span> compact format<span class=\"token punctuation\">;</span> info bits <span class=\"token number\">0</span>\n <span class=\"token number\">0</span>: len <span class=\"token number\">8</span><span class=\"token punctuation\">;</span> hex <span class=\"token number\">800000000000000</span>a<span class=\"token punctuation\">;</span> <span class=\"token keyword\">asc</span>         <span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span>\n <span class=\"token number\">1</span>: len <span class=\"token number\">6</span><span class=\"token punctuation\">;</span> hex <span class=\"token number\">000000000</span>c74<span class=\"token punctuation\">;</span> <span class=\"token keyword\">asc</span>      t<span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span>\n <span class=\"token number\">2</span>: len <span class=\"token number\">7</span><span class=\"token punctuation\">;</span> hex <span class=\"token number\">82000000</span>ab0110<span class=\"token punctuation\">;</span> <span class=\"token keyword\">asc</span>        <span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span>\n <span class=\"token number\">3</span>: len <span class=\"token number\">4</span><span class=\"token punctuation\">;</span> hex <span class=\"token number\">6</span>f726361<span class=\"token punctuation\">;</span> <span class=\"token keyword\">asc</span> orca<span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span>\n <span class=\"token number\">4</span>: len <span class=\"token number\">8</span><span class=\"token punctuation\">;</span> hex <span class=\"token number\">800000000000001</span>a<span class=\"token punctuation\">;</span> <span class=\"token keyword\">asc</span>         <span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h3><strong>Next-Key Lock</strong></h3>\n<p><code class=\"language-text\">Next-Key Lock</code> 은 <code class=\"language-text\">Record Lock</code> 과 해당 인덱스 레코드 앞의 Gap 에 대한 <code class=\"language-text\">Gap Lock</code> 이 조합된 Lock 입니다. 예시에 해당하는 <code class=\"language-text\">Next-Key Lock</code> 은 아래 명시된 것과 같이 적용됩니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">(negative infinity, 1]\n(1, 2]\n(2, 3]\n(3, 6]\n(6, 10]\n(10, positive infinity)</code></pre></div>\n<p>마지막 범위에 대한 <code class=\"language-text\">Next-Key Lock</code> 은 실제 인덱스의 가장 큰 값과 가장 높은 값을 갖는 허위 인덱스, <code class=\"language-text\">supremum pseudo-record</code> 를 통해 Lock 을 설정합니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1552px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/10f54dc94aebbb6eafbb2225d22d9337/cc6c5/Screen_Shot_2022-11-08_at_3.46.45_PM.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 24.200000000000003%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA3ElEQVQY002Pa3KDMAyEuU1qgw22bEMImTRN8+hM73+djdYJTH7sICT521VTSkGIEX3fI6WMaT5oPWAYBnAmKSGEWOvleNp2Rb8iUmvvHbxztW6medGGx9duhyAJ+8MRxhi0bQvJBVF7vcIlj1hO59rn3KspAW3XwSmM4qy5Pv6Ry1iBeZzwc32g0yUqRNGHr0fjNONy+1PzHtaaapTURPQqiv+ENkw06El0JYCJ6UQgk1trYc0LwN01iVtnH6oJmYgOTJg06ffltgF56npiGfc4/94V6N8GssE/9QR2M50mo+VgIwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Screen Shot 2022-11-08 at 3.46.45 PM.png\"\n        title=\"Screen Shot 2022-11-08 at 3.46.45 PM.png\"\n        src=\"/static/10f54dc94aebbb6eafbb2225d22d9337/cc6c5/Screen_Shot_2022-11-08_at_3.46.45_PM.png\"\n        srcset=\"/static/10f54dc94aebbb6eafbb2225d22d9337/0eb09/Screen_Shot_2022-11-08_at_3.46.45_PM.png 500w,\n/static/10f54dc94aebbb6eafbb2225d22d9337/1263b/Screen_Shot_2022-11-08_at_3.46.45_PM.png 1000w,\n/static/10f54dc94aebbb6eafbb2225d22d9337/cc6c5/Screen_Shot_2022-11-08_at_3.46.45_PM.png 1552w\"\n        sizes=\"(max-width: 1552px) 100vw, 1552px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>실제로 <code class=\"language-text\">SELECT … FROM performance_schema.data_locks;</code> 를 통해 확인해보면 <code class=\"language-text\">supremum pseudo-record</code> 가 <code class=\"language-text\">LOCK_DATA</code> 로 잡혀있는 것을 확인할 수 있습니다.</p>\n<h2><strong>Consistent Non-Locking Reads</strong></h2>\n<p>MySQL 의 <code class=\"language-text\">InnoDB</code> 는 동시성 성능을 최대화하기 위해 Multiversion Concurrency Control, MVCC 라는 개념을 도입했습니다. 이는 격리 수준에 따라 상이하지만, 특정 시점의 <code class=\"language-text\">Snapshot</code> 정보를 바탕으로 Locking 이 필요하지 않은 Consistent Read 를 제공한다는 공통점이 있습니다. 이를 MySQL 에선 <code class=\"language-text\">Consistent Non-Locking Read</code> 라고 합니다.</p>\n<ul>\n<li><code class=\"language-text\">REPEATALBE READ</code> 격리 수준에선 최초 <code class=\"language-text\">SELECT</code> 문이 수행된 시점을 기준으로 <code class=\"language-text\">Snapshot</code> 이 생성되어 다른 트랜잭션에 의해 해당 데이터가 변경되어도 <code class=\"language-text\">Undo Log</code> 에 저장된 내용을 기반으로 기존 데이터를 재구성합니다.</li>\n<li><code class=\"language-text\">READ COMMITTED</code> 격리 수준에선 각 <code class=\"language-text\">SELECT</code> 문 마다 <code class=\"language-text\">Snapshot</code> 이 초기화되기 때문에 다른 트랜잭션의 커밋에 의해 해당 데이터가 변경되면 같은 읽기 작업이라도 다른 결과를 반환할 수 있습니다.</li>\n</ul>\n<h2><strong>Locking Reads</strong></h2>\n<p>기본적인 <code class=\"language-text\">SELECT</code> 문을 통해 조회한 데이터는 기본적으로 <code class=\"language-text\">Non-Locking Read</code> 입니다. 때문에 다른 트랜잭션에 의해 변경될 가능성이 높습니다. <code class=\"language-text\">InnoDB</code> 는 이를 해결하기 위해 두 가지 <code class=\"language-text\">Locking Read</code> 를 제공합니다.</p>\n<ul>\n<li><code class=\"language-text\">SELECT … FOR SHARE</code> 는 읽은 Row 에 <code class=\"language-text\">S-Lock</code> 을 설정합니다. 다른 트랜잭션이 Row 를 읽을 순 있지만, <code class=\"language-text\">S-Lock</code> 을 설정한 트랜잭션이 커밋되기 전까지 Row 를 수정할 수 없습니다. 아직 커밋되지 않은 다른 트랜잭션에 의해 해당 Row 가 변경될 경우, 트랜잭션이 종료될 때까지 기다린 뒤 가장 최신화된 값을 사용하여 쿼리를 수행합니다.</li>\n<li><code class=\"language-text\">SELECT … FOR UPDATE</code> 는 검색에서 발견한 인덱스 레코드에 대해 <code class=\"language-text\">UPDATE</code> 문을 실행한 것과 동일하게 Row 및 관련 인덱스에 Lock 을 설정합니다. 다른 트랜잭션은 해당 Row 를 <code class=\"language-text\">UPDATE</code> 또는 <code class=\"language-text\">SELECT ... FOR SHARE</code> 를 수행하는 것이 제한됩니다.</li>\n</ul>\n<p><code class=\"language-text\">FOR SHARE</code> 혹은 <code class=\"language-text\">FOR UPDATE</code> 로 설정된 모든 Lock 은 트랜잭션이 커밋 또는 롤백될 때 반환됩니다.</p>\n<p>여기까지 <code class=\"language-text\">InnoDB</code> 의 Locking, Consistent Non-Locking Read, Locking Read 등에 대해 알아보았습니다. 이제 <code class=\"language-text\">InnoDB</code> 가 4가지 트랜잭션 격리 수준을 이를 통해 어떻게 구현했는지 살펴보겠습니다.</p>\n<h2><strong>READ UNCOMMITTED</strong></h2>\n<p>먼저 <code class=\"language-text\">READ UNCOMMITTED</code> 입니다. 트랜잭션의 변경 내용이 커밋이나 롤백 여부와 관계 없이 다른 트랜잭션에 보이는 가장 낮은 수준의 격리 레벨입니다. <code class=\"language-text\">READ UNCOMMITTED</code> 격리 수준에서 일반적인 <code class=\"language-text\">SELECT</code> 문은 <code class=\"language-text\">Non-Locking Read</code> 로 수행되지만 MVCC 를 사용하지 않아 <code class=\"language-text\">Consistent Read</code> 를 보장하지않습니다.</p>\n<h3><strong>Dirty Read</strong></h3>\n<p><code class=\"language-text\">READ UNCOMMITTED</code> 격리 수준에서 발생할 수 있는 읽기 부정합 현상입니다. 다른 트랜잭션에 의해 영향 받은 Row 를 읽을 수 있기 때문에 발생하는 현상입니다. 커밋 또는 롤백에 관계 없이 보여지기 때문에 부정확한 데이터를 사용할 수 있는 위험한 상황이 발생할 수 있습니다.</p>\n<p>이는 데이터베이스의 ACID 성질을 준수하지 못하기에 이를 해결하기 위해 <code class=\"language-text\">InnoDB</code> 에선 MVCC 를 통한 <code class=\"language-text\">Consistent Read</code> 를 제공합니다.</p>\n<h2><strong>READ COMMITTED</strong></h2>\n<p><code class=\"language-text\">READ COMMITTED</code> 격리 수준부터 MVCC 가 사용되어 <code class=\"language-text\">Consistent Read</code> 를 지원하지만 동일한 트랜잭션 내에서 각 <code class=\"language-text\">SELECT</code> 문은 자체적으로 새로운 <code class=\"language-text\">Snapshot</code> 을 생성하기 때문에 완전한 <code class=\"language-text\">Consistent Read</code> 를 보장하진 않습니다.</p>\n<p><code class=\"language-text\">Locking Read</code> <code class=\"language-text\">UPDATE</code> <code class=\"language-text\">DELETE</code> 문의 경우 <code class=\"language-text\">Record Lock</code> 만을 설정하고 <code class=\"language-text\">Gap Lock</code> 은 설정하지 않기에 다른 트랜잭션에서 자유롭게 Gap 에 접근할 수 있습니다. <code class=\"language-text\">Gap Lock</code> 을 설정하지 않기 때문에 범위 검색과 같은 쿼리에서 <code class=\"language-text\">Phantom Read</code> 현상 역시 발생할 수 있습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">SET</span> <span class=\"token keyword\">TRANSACTION</span> <span class=\"token keyword\">ISOLATION</span> <span class=\"token keyword\">LEVEL</span> <span class=\"token keyword\">READ</span> <span class=\"token keyword\">COMMITTED</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">START</span> <span class=\"token keyword\">TRANSACTION</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">UPDATE</span> test <span class=\"token keyword\">SET</span> name <span class=\"token operator\">=</span> <span class=\"token string\">'meatsby'</span> <span class=\"token keyword\">WHERE</span> name <span class=\"token operator\">=</span> <span class=\"token string\">'quaritch'</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1586px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/a8d3cdc9e255b3831d6e6eedc0a52dd5/867ee/Screen_Shot_2022-11-09_at_12.57.59_PM.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 9.2%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAe0lEQVQI1x2NSxKDIBQEPY1BTVVIBIXHT9Hc/0gtuphFd83UdDUXtuMkpEwWT60HMW9459hTIm8VkYAxhnVZqKVQzz+p7ATf+m1X6omEiLWWzoeE1l9efc9sVyRmhkExTW8WJ8zG8ptN44lxHAntzElEKfW4j9aPv3PzBRAfQWzpdRxhAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Screen Shot 2022-11-09 at 12.57.59 PM.png\"\n        title=\"Screen Shot 2022-11-09 at 12.57.59 PM.png\"\n        src=\"/static/a8d3cdc9e255b3831d6e6eedc0a52dd5/867ee/Screen_Shot_2022-11-09_at_12.57.59_PM.png\"\n        srcset=\"/static/a8d3cdc9e255b3831d6e6eedc0a52dd5/0eb09/Screen_Shot_2022-11-09_at_12.57.59_PM.png 500w,\n/static/a8d3cdc9e255b3831d6e6eedc0a52dd5/1263b/Screen_Shot_2022-11-09_at_12.57.59_PM.png 1000w,\n/static/a8d3cdc9e255b3831d6e6eedc0a52dd5/867ee/Screen_Shot_2022-11-09_at_12.57.59_PM.png 1586w\"\n        sizes=\"(max-width: 1586px) 100vw, 1586px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>추가적으로 위 그럼처럼 <code class=\"language-text\">UPDATE</code> 쿼리를 위한 풀 테이블 스캔 시 <code class=\"language-text\">READ COMMITTED</code> 는 스캔 중 마주치는 모든 인덱스 레코드에 <code class=\"language-text\">X-Lock</code> 을 설정하고 <code class=\"language-text\">WHERE</code> 절이 수행될 때 조건에 부합하지 않는 인덱스 레코드의 <code class=\"language-text\">X-Lock</code> 을 반환하는 특징을 가지고 있습니다.</p>\n<p>변경할 인덱스 레코드를 제외한 다른 인덱스 레코드의 Lock 을 반환하기 때문에 다른 트랜잭션과의 충돌로 인한 데드락 발생 확률을 현저히 줄였다고 MySQL 은 소개합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">SET</span> <span class=\"token keyword\">TRANSACTION</span> <span class=\"token keyword\">ISOLATION</span> <span class=\"token keyword\">LEVEL</span> <span class=\"token keyword\">REPEATABLE</span> <span class=\"token keyword\">READ</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">START</span> <span class=\"token keyword\">TRANSACTION</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">UPDATE</span> test <span class=\"token keyword\">SET</span> name <span class=\"token operator\">=</span> <span class=\"token string\">'meatsby'</span> <span class=\"token keyword\">WHERE</span> name <span class=\"token operator\">=</span> <span class=\"token string\">'quaritch'</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1586px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/26bd47bd970acf624fb5f49fb22206ed/867ee/Screen_Shot_2022-11-09_at_12.57.15_PM.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 23.400000000000002%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA2klEQVQY011Q2Y6EMAzr3yxHKb2hwIg5mEP7///jTQKjGe1DFNW1HScqpQRrLfq+R5lm+BBhjEEIAc55wvc/xiJxl9MK5/3+jhE5D/JmrnMOaigTmqamalCWnVxVPzDWCVbXFdq2pV7DRzJcr9BaE6eCo+ExZdIECcKlbs9fmdaS+LI9MZRZxDyRjd7FWMojNuJzah72TmpMj066gRqnBbrrRDQeKzOZ1/wY6sMgoMwnETPOBowL5+jqfHugI0P+WK8b8lAkjaV7/E8Y6V6X+0sSMd/TnXn9b94f6B6choinwocAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Screen Shot 2022-11-09 at 12.57.15 PM.png\"\n        title=\"Screen Shot 2022-11-09 at 12.57.15 PM.png\"\n        src=\"/static/26bd47bd970acf624fb5f49fb22206ed/867ee/Screen_Shot_2022-11-09_at_12.57.15_PM.png\"\n        srcset=\"/static/26bd47bd970acf624fb5f49fb22206ed/0eb09/Screen_Shot_2022-11-09_at_12.57.15_PM.png 500w,\n/static/26bd47bd970acf624fb5f49fb22206ed/1263b/Screen_Shot_2022-11-09_at_12.57.15_PM.png 1000w,\n/static/26bd47bd970acf624fb5f49fb22206ed/867ee/Screen_Shot_2022-11-09_at_12.57.15_PM.png 1586w\"\n        sizes=\"(max-width: 1586px) 100vw, 1586px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>반면 <code class=\"language-text\">REPEATABLE READ</code> 에선 스캔 중 마주치는 모든 인덱스 레코드에 <code class=\"language-text\">X-Lock</code> 을 설정하여 커밋 또는 롤백까지 Lock 을 반환하지 않습니다.</p>\n<h3><strong>Non-Repeatable Read</strong></h3>\n<p><code class=\"language-text\">READ COMMITTED</code> 격리 수준까지 발생할 수 있는 읽기 부정합 현상입니다. 앞서 설명한 것 처럼 <code class=\"language-text\">READ COMMITTED</code> 격리 수준에서 <code class=\"language-text\">SELECT</code> 문은 항상 <code class=\"language-text\">Snapshot</code> 을 초기화하기 때문에 한 트랜잭션에서 동일한 <code class=\"language-text\">SELECT</code> 문을 수행해도 일관된 데이터를 반환하지 않는 문제가 발생할 수 있습니다.</p>\n<h2><strong>REPEATABLE READ</strong></h2>\n<p><code class=\"language-text\">InnoDB</code> 에서 기본값으로 제공하는 격리 레벨로, <code class=\"language-text\">READ COMMITTED</code> 격리 수준과는 달리 처음 생성된 <code class=\"language-text\">Snapshot</code> 을 통해 <code class=\"language-text\">Consistent Read</code> 를 보장합니다. 즉, 동일한 트랜잭션 내의 일반적인 <code class=\"language-text\">SELECT</code> 문의 일관성을 보장합니다.</p>\n<p><code class=\"language-text\">Locking Read</code> <code class=\"language-text\">UPDATE</code> <code class=\"language-text\">DELETE</code> 문의 경우 검색 조건에 따라 사용하는 <code class=\"language-text\">Lock</code> 이 달라집니다.</p>\n<ul>\n<li>고유한 검색 조건이 있는 고유 인덱스에 대한 쿼리는 <code class=\"language-text\">Record Lock</code> 이 적용됩니다.</li>\n<li>범위 검색 조건과 같은 다른 검색 조건의 경우 스캔한 인덱스 범위에 <code class=\"language-text\">Gap Lock</code> 또는 <code class=\"language-text\">Next-Key Lock</code> 을 설정하여 다른 트랜잭션이 해당 범위에 접근하는 것을 제한합니다.</li>\n</ul>\n<p>아래 예시를 통해 위 두 상황을 좀 더 자세히 살펴보겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token comment\"># Session A</span>\n<span class=\"token keyword\">SET</span> <span class=\"token keyword\">TRANSACTION</span> <span class=\"token keyword\">ISOLATION</span> <span class=\"token keyword\">LEVEL</span> <span class=\"token keyword\">REPEATABLE</span> <span class=\"token keyword\">READ</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">START</span> <span class=\"token keyword\">TRANSACTION</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">SELECT</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">FROM</span> test <span class=\"token keyword\">WHERE</span> id <span class=\"token operator\">=</span> <span class=\"token number\">6</span> <span class=\"token keyword\">FOR</span> <span class=\"token keyword\">UPDATE</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1586px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/3d7e993f8b993a9d167a1848b0a9460f/867ee/Screen_Shot_2022-11-09_at_2.46.55_PM.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 9%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAeklEQVQI1xWLaxpDMBQFrYZ4fFolyOuK0O5/R9Pr55yZU5Ujk68vIQlH8JRykXTzznFKQs4LHyKLtezbRjmEcv+QXAhe+5jI5Sbq364rlQuJcXzR1DXr7njYmIZhGJQ982L5zAt939O1LUEyLoo2hk639zSp62jVPc0fHy9BjwtJPPwAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Screen Shot 2022-11-09 at 2.46.55 PM.png\"\n        title=\"Screen Shot 2022-11-09 at 2.46.55 PM.png\"\n        src=\"/static/3d7e993f8b993a9d167a1848b0a9460f/867ee/Screen_Shot_2022-11-09_at_2.46.55_PM.png\"\n        srcset=\"/static/3d7e993f8b993a9d167a1848b0a9460f/0eb09/Screen_Shot_2022-11-09_at_2.46.55_PM.png 500w,\n/static/3d7e993f8b993a9d167a1848b0a9460f/1263b/Screen_Shot_2022-11-09_at_2.46.55_PM.png 1000w,\n/static/3d7e993f8b993a9d167a1848b0a9460f/867ee/Screen_Shot_2022-11-09_at_2.46.55_PM.png 1586w\"\n        sizes=\"(max-width: 1586px) 100vw, 1586px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>현재 예시에선 <code class=\"language-text\">id</code> 가 인덱스로 작용하고 있기 때문에 고유한 <code class=\"language-text\">id</code> 조건을 통해 <code class=\"language-text\">FOR UPDATE</code> 를 수행할 경우 해당하는 인덱스 레코드에만 <code class=\"language-text\">Record Lock</code> 이 설정됩니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token comment\"># Session B</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> test <span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">,</span> name<span class=\"token punctuation\">,</span> age<span class=\"token punctuation\">)</span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'test'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">26</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 614px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/0d232d19ac084ba02b5e8d6588430a5c/c42f5/Screen_Shot_2022-11-09_at_2.56.23_PM.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 53%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABYlAAAWJQFJUiTwAAABmUlEQVQoz3WS61LjMAyF8zDLNLdCkiaOHTuO67DpwtDOFGaA2cv7P8ZZyWCGtvBDY9mWPh9JTvSgIHqD12ONP/8a/Hp4hPMei53wfDtiORzw9PwbdpqglIKnO2MM+mHAq99iv9/h+PIXfp4x0nky0EXbCjjbYFpqjM5D0pmRCs50MPMWP3f3UING13WQUkIIgbYT8KqH8QPm5Q7ajHSnkLCT5xnSrEC6KslWuKlqtL2EnXcUOEFbBzcvKMsSWZahKIpgaZ7TPsfV1Q9IbTAYi8QEYI6SAsqyCP5NVQUFklUReL2+Jlt/gBgc1nefczrRU+skAUcbDmJwBHZCEtBA6ZGS1icxERiNVfPDPZc8UvPPgVXdhAAzbaHH6ST5HBjb0CsdKnrv4SVQ0GuK+sIqzxWd7t+AHC969XXJVV2HkhnIJX/u3wXwQ+EQ4hM7uUsgTTkqZLVZmn7fwwBMIalkhiaakoriFFg3mzBlhrLPD/CgvhsK5zSblmzzpvDz32LfujmU6unDutsdlvt98GNyXKOfpqvwBzW17z+uqV7VWPbG7gAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Screen Shot 2022-11-09 at 2.56.23 PM.png\"\n        title=\"Screen Shot 2022-11-09 at 2.56.23 PM.png\"\n        src=\"/static/0d232d19ac084ba02b5e8d6588430a5c/c42f5/Screen_Shot_2022-11-09_at_2.56.23_PM.png\"\n        srcset=\"/static/0d232d19ac084ba02b5e8d6588430a5c/0eb09/Screen_Shot_2022-11-09_at_2.56.23_PM.png 500w,\n/static/0d232d19ac084ba02b5e8d6588430a5c/c42f5/Screen_Shot_2022-11-09_at_2.56.23_PM.png 614w\"\n        sizes=\"(max-width: 614px) 100vw, 614px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>때문에 다른 트랜잭션이 Gap 에 데이터를 삽입할 때 아무 제한 없이 정상적으로 데이터가 삽입됩니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token comment\"># Session A</span>\n<span class=\"token keyword\">SET</span> <span class=\"token keyword\">TRANSACTION</span> <span class=\"token keyword\">ISOLATION</span> <span class=\"token keyword\">LEVEL</span> <span class=\"token keyword\">REPEATABLE</span> <span class=\"token keyword\">READ</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">START</span> <span class=\"token keyword\">TRANSACTION</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">SELECT</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">FROM</span> test <span class=\"token keyword\">WHERE</span> age <span class=\"token operator\">=</span> <span class=\"token number\">25</span> <span class=\"token keyword\">FOR</span> <span class=\"token keyword\">UPDATE</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1584px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/859ab579499b580a8ad941bf4e6ce877/bf788/Screen_Shot_2022-11-09_at_2.51.22_PM.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 23.400000000000002%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA3ElEQVQY011QW27DMAzzbZaH7fidOEmRtc3WYfe/DyfJLTbsQxBMkxQllXOGcw7TNKGuG0JMsNYixgjvA+Htj7FE3P1ywIfQ3imhlFnezPXeQ811xTD0VAPq3shd9wbrvGB932EcR+o9QiLD4watNXE6eBqeciFNlCBc6v74lmkjia/nA3PdRMwT2ehVjOWy4CQ+p+Zhr6TWTjDUjbFQy7pDGyOi5bkyk3nNX0P9NIio20XEjLMZ443Tunq/f5KzkY/jdqLMVdI4usf/hInudf34kkTMD3RnXv8v7wfnK5yFxfQziwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Screen Shot 2022-11-09 at 2.51.22 PM.png\"\n        title=\"Screen Shot 2022-11-09 at 2.51.22 PM.png\"\n        src=\"/static/859ab579499b580a8ad941bf4e6ce877/bf788/Screen_Shot_2022-11-09_at_2.51.22_PM.png\"\n        srcset=\"/static/859ab579499b580a8ad941bf4e6ce877/0eb09/Screen_Shot_2022-11-09_at_2.51.22_PM.png 500w,\n/static/859ab579499b580a8ad941bf4e6ce877/1263b/Screen_Shot_2022-11-09_at_2.51.22_PM.png 1000w,\n/static/859ab579499b580a8ad941bf4e6ce877/bf788/Screen_Shot_2022-11-09_at_2.51.22_PM.png 1584w\"\n        sizes=\"(max-width: 1584px) 100vw, 1584px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>반면 <code class=\"language-text\">age</code> 와 같이 현재 테이블 상태에선 고유하지만 인덱스가 아닌 조건을 통해 <code class=\"language-text\">FOR UPDATE</code> 를 수행할 경우 풀 테이블 스캔을 통해 해당 인덱스 레코드를 탐색하기 때문에 그 과정에서 마주친 모든 인덱스 레코드에 <code class=\"language-text\">X-Lock</code> 이 적용됩니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token comment\"># Session B</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> test <span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">,</span> name<span class=\"token punctuation\">,</span> age<span class=\"token punctuation\">)</span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'test'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">26</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1584px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/130c876ff424dc40c230d161d88f7b1c/bf788/Screen_Shot_2022-11-09_at_2.52.42_PM.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 29.2%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAABYlAAAWJQFJUiTwAAABBElEQVQY00VQWXaDMAzkNMUm2Aa8AGHJ0pe8tve/z1SjlOZDz7bk2VRN04whRngfMM1njPL23iOlhFwKUi6IMaEfos7W/Yqu66U6JMH1fQ8fgmJ4VmWc4JyDMTWyAGLKqOsPhH6QexGxpD1WKhPmdYe1Fs3ppATWGlhj0DSN9qv9eld1NpftgnnZlJy9IE6c83CifhKCeVlxf3zpnUXHuYwqOmiKAdV2EAr7OC9aVKV627aqTDDnScCMzDdnQWJTkHEpyqTVern9ERrZ4ZswKKF7uSGxEGaJzP8UIZgkL8Hm/6w+nz+IsnjGXPebOjB1rYtvBfR2KIJnifz81h5nNHLEP+oXNwC8fEMkweUAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Screen Shot 2022-11-09 at 2.52.42 PM.png\"\n        title=\"Screen Shot 2022-11-09 at 2.52.42 PM.png\"\n        src=\"/static/130c876ff424dc40c230d161d88f7b1c/bf788/Screen_Shot_2022-11-09_at_2.52.42_PM.png\"\n        srcset=\"/static/130c876ff424dc40c230d161d88f7b1c/0eb09/Screen_Shot_2022-11-09_at_2.52.42_PM.png 500w,\n/static/130c876ff424dc40c230d161d88f7b1c/1263b/Screen_Shot_2022-11-09_at_2.52.42_PM.png 1000w,\n/static/130c876ff424dc40c230d161d88f7b1c/bf788/Screen_Shot_2022-11-09_at_2.52.42_PM.png 1584w\"\n        sizes=\"(max-width: 1584px) 100vw, 1584px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>이 상태에서 다른 트랜잭션이 Gap 에 <code class=\"language-text\">id</code> 가 5 인 데이터를 삽입하려고 할 경우 <code class=\"language-text\">id</code> 가 6 인 인덱스 레코드의 <code class=\"language-text\">Gap Lock</code> 으로 인해 데이터 삽입이 제한됩니다. 이를 통해 <code class=\"language-text\">InnoDB</code> 에선 <code class=\"language-text\">REPEATABLE READ</code> 수준에서도 <code class=\"language-text\">Phantom Read</code> 현상을 방지할 수 있습니다.</p>\n<h3><strong>Phantom Read</strong></h3>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\">A : <span class=\"token keyword\">START</span> <span class=\"token keyword\">TRANSACTION</span><span class=\"token punctuation\">;</span>\nA : <span class=\"token keyword\">SELECT</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">FROM</span> test<span class=\"token punctuation\">;</span> <span class=\"token comment\"># 최초 Snapshot 생성</span>\n\nB : <span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> test <span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">,</span> name<span class=\"token punctuation\">,</span> age<span class=\"token punctuation\">)</span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'test'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">26</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\"># Lock 이 걸려있지 않기 때문에 Gap 에 데이터 삽입 가능</span>\n\nA : <span class=\"token keyword\">SELECT</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">FROM</span> test<span class=\"token punctuation\">;</span> <span class=\"token comment\"># 최초 Snapshot 을 그대로 사용</span>\nA : <span class=\"token keyword\">UPDATE</span> test <span class=\"token keyword\">SET</span> name <span class=\"token operator\">=</span> <span class=\"token string\">'twenty-six'</span> <span class=\"token keyword\">WHERE</span> age <span class=\"token operator\">=</span> <span class=\"token number\">26</span><span class=\"token punctuation\">;</span> <span class=\"token comment\"># Locking Read 를 통해 새롭게 읽은 후 UPDATE</span>\nA : <span class=\"token keyword\">SELECT</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">FROM</span> test<span class=\"token punctuation\">;</span> <span class=\"token comment\"># Snapshot 이 초기화되어 Phantom Read 발생</span></code></pre></div>\n<p>여전히 이런 구조에도 불구하고 <code class=\"language-text\">REPEATABLE READ</code> 에서 <code class=\"language-text\">Phantom Read</code> 가 발생할 수 있는 상황이 있습니다.</p>\n<p>위 상황처럼 다른 트랜잭션이 추가한 레코드에 <code class=\"language-text\">UPDATE</code> 쿼리를 수행하게 될 경우, 첫 <code class=\"language-text\">SELECT</code> 쿼리로 생성된 <code class=\"language-text\">Snapshot</code> 에는 존재하지 않지만 실제 디스크에는 데이터가 존재하기 때문에 해당 레코드가 영향을 받아 이후 <code class=\"language-text\">SELECT</code> 쿼리를 수행할 때 <code class=\"language-text\">Snapshot</code> 이 초기화되는 시점에 해당 현상을 발견할 수 있습니다.</p>\n<p>즉, <code class=\"language-text\">Consistent Non-Locking Read</code> 와 <code class=\"language-text\">Locking Read</code> 의 조합 때문에 발생할 수 있는 현상입니다.</p>\n<p>앞서 설명한 것 처럼 일반적인 <code class=\"language-text\">SELECT</code> 문은 <code class=\"language-text\">Non-Locking Read</code> 를 기반으로 하기 때문에 <code class=\"language-text\">UPDATE</code> 를 위한 <code class=\"language-text\">SELECT</code> 는 <code class=\"language-text\">SELECT … FOR UPDATE</code> 와 같이 <code class=\"language-text\">Locking Read</code> 를 사용하는 것이 더 적합합니다.</p>\n<p>따라서, 위 예시에서 연출하는 상황 자체가 부적절하다고 생각하지만, 여전히 발생할 수 있는 특정 상황이 존재한다는 사실을 알고있는 것이 좋을 것 같습니다.</p>\n<h2><strong>SERIALIZABLE</strong></h2>\n<p>마지막 <code class=\"language-text\">SERIALIZABLE</code> 은 가장 높은 수준의 격리 레벨입니다. 이름처럼 직렬화된 방식처럼 작동해야합니다. <code class=\"language-text\">InnoDB</code> 에선 이를 구현하기 위해 일반적인 <code class=\"language-text\">SELECT</code> 문을 모두 <code class=\"language-text\">SELECT … FOR SHARE</code> 문으로 변환하여 <code class=\"language-text\">S-Lock</code> 을 통한 <code class=\"language-text\">Locking Read</code> 를 수행하게끔 합니다.</p>\n<p>글 초반부 설명되어있듯이 <code class=\"language-text\">S-Lock</code> 은 다른 트랜잭션도 독립적으로 설정이 가능하여 <code class=\"language-text\">S-Lock</code> 이 설정된 레코드를 읽을 수 있지만 최초로 <code class=\"language-text\">S-Lock</code> 을 설정한 트랜잭션이 종료되기 전까진 변경을 가할 수 없습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">SET</span> <span class=\"token keyword\">TRANSACTION</span> <span class=\"token keyword\">ISOLATION</span> <span class=\"token keyword\">LEVEL</span> <span class=\"token keyword\">SERIALIZABLE</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">START</span> <span class=\"token keyword\">TRANSACTION</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">SELECT</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">FROM</span> test<span class=\"token punctuation\">;</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1582px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/c481804ab6644faae76245d685532e91/d3b5d/Screen_Shot_2022-11-09_at_1.23.06_PM.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 23.400000000000002%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA6klEQVQY011Q227FIAzr16w3oDdKgbZQ6Kodaf//PV6CdKRtDxaG2IlJlUNATDeOEHF6j5wyduK7c7jCiZhveL9Da43NGHymhHQ/OOKFw1qkM+CMCRvxZVlQuf3EOE6o6w/MegXfm6aBkBJSKeI1uq4r6PuehiWsxqKpawghsW4W87xgXnRB9by+Yd1ejMY65OdVjGoYCpi/IYSg+hf8EdC2bamP0wQpFRQN57Mk5M4dCfi09D02c5ET/m9o/QG9mpKYNfz2Ts+oEk00mysJOX7MTxHwRKWGP+KezBftj5u2tJZhGMu6fmt+AJZcn0r6SX/rAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Screen Shot 2022-11-09 at 1.23.06 PM.png\"\n        title=\"Screen Shot 2022-11-09 at 1.23.06 PM.png\"\n        src=\"/static/c481804ab6644faae76245d685532e91/d3b5d/Screen_Shot_2022-11-09_at_1.23.06_PM.png\"\n        srcset=\"/static/c481804ab6644faae76245d685532e91/0eb09/Screen_Shot_2022-11-09_at_1.23.06_PM.png 500w,\n/static/c481804ab6644faae76245d685532e91/1263b/Screen_Shot_2022-11-09_at_1.23.06_PM.png 1000w,\n/static/c481804ab6644faae76245d685532e91/d3b5d/Screen_Shot_2022-11-09_at_1.23.06_PM.png 1582w\"\n        sizes=\"(max-width: 1582px) 100vw, 1582px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>위 그림처럼 단순히 <code class=\"language-text\">SELECT</code> 문을 수행해도 모든 레코드에 <code class=\"language-text\">S-Lock</code> 이 설정된 것을 확인할 수 있습니다.</p>\n<h2><strong>마무리</strong></h2>\n<p>여기까지 MySQL 의 <code class=\"language-text\">InnoDB</code> 가 4가지 격리 수준을 구현한 방법에 대해 알아보았습니다. 격리 수준은 동시성과 격리성의 Trade-Off 인 만큼 자세히 알고 사용하면 더 좋은 효과를 나타낼 수 있을 것 같습니다.</p>\n<p>MySQL 은 다른 DBMS 벤더들과는 달리 <code class=\"language-text\">InnoDB</code> 를 통해 <code class=\"language-text\">REPEATABLE READ</code> 에서도 충분한 격리성을 보여주고 있습니다. 하지만 여러가지 Locking 기법을 활용하여 격리 수준을 구현했기 때문에 Locking 으로 인해 발생할 수 있는 여러 문제점 역시 충분히 이해하는 것이 중요하다고 생각합니다.</p>\n<h2><strong>References</strong></h2>\n<ul>\n<li><a href=\"https://dev.mysql.com/doc/refman/8.0/en/innodb-locking.html\">MySQL Docs - InnoDB Locking</a></li>\n<li><a href=\"https://dev.mysql.com/doc/refman/8.0/en/innodb-consistent-read.html\">MySQL Docs - Consistent Nonlocking Reads</a></li>\n<li><a href=\"https://dev.mysql.com/doc/refman/8.0/en/innodb-locking-reads.html\">MySQL Docs - Locking Reads</a></li>\n<li><a href=\"https://dev.mysql.com/doc/refman/8.0/en/innodb-transaction-isolation-levels.html\">MySQL Docs - Transaction Isolation Levels</a></li>\n<li><a href=\"https://dev.mysql.com/doc/refman/8.0/en/innodb-next-key-locking.html\">MySQL Docs - Phantom Rows</a></li>\n</ul>","htmlAst":{"type":"root","children":[{"type":"element","tagName":"h2","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Transaction Isolation Level"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"애플리케이션을 개발 중 데이터베이스를 도입하면 격리 수준에 대한 이해가 자연스럽게 요구됩니다. 격리 수준은 데이터베이스의 ACID 성질 중 Isolation 에 해당하며, 여러 트랜잭션이 동시에 변경을 수행할 때 성능과 안정성, 일관성 및 재현성 간의 규형을 미세하게 조정하는 설정입니다. SQL:1992 표준에서 제공하는 4가지 격리 수준의 종류는 아래와 같습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"READ UNCOMMITTED"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"READ COMMITTED"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"REPEATABLE READ"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"SERIALIZABLE"}]}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"MySQL 의 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"InnoDB"}]},{"type":"text","value":" 는 MVCC 와 2-Phase Locking 의 장점을 적절히 조합하여 트랜잭션 모델을 구현하였는데요. 이를 이해하기 위해선 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"InnoDB"}]},{"type":"text","value":" 의 Locking, Consistent Non-Locking Read, Locking Read 등과 같은 개념이 선행되어야 합니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"sql"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-sql"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-sql"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"CREATE"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"TABLE"}]},{"type":"text","value":" test "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"text","value":"\n  id "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"BIGINT"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"20"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"NOT"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","boolean"]},"children":[{"type":"text","value":"NULL"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"AUTO_INCREMENT"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n  name "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"VARCHAR"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"255"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"NOT"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","boolean"]},"children":[{"type":"text","value":"NULL"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n  age "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"BIGINT"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"20"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"NOT"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","boolean"]},"children":[{"type":"text","value":"NULL"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"PRIMARY"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"KEY"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"text","value":"id"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"insert"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"into"}]},{"type":"text","value":" test "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"text","value":"id"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" name"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" age"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"values"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"1"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"'quaritch'"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"25"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"insert"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"into"}]},{"type":"text","value":" test "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"text","value":"id"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" name"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" age"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"values"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"2"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"'orca'"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"26"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"insert"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"into"}]},{"type":"text","value":" test "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"text","value":"id"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" name"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" age"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"values"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"3"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"'chan'"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"26"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"insert"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"into"}]},{"type":"text","value":" test "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"text","value":"id"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" name"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" age"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"values"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"6"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"'ori'"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"27"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"insert"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"into"}]},{"type":"text","value":" test "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"text","value":"id"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" name"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" age"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"values"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"10"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"'awesomeo'"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"26"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"이 글에선 여러 예시들이 사용될 예정입니다. 모든 예시는 위 테이블을 바탕으로 진행되는 점을 참고하며 읽으시면 좀 더 원활한 이해가 가능할 것 같습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"InnoDB Locking"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"MySQL 의 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"InnoDB"}]},{"type":"text","value":" 에선 다양한 Locking 기법을 사용합니다. 그 중 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"InnoDB"}]},{"type":"text","value":" 의 트랜잭션 격리 수준을 구현하기 위해 사용되는 대표적인 3가지 Lock 에 대해 우선 살펴보고자 합니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Record Lock"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"Record Lock"}]},{"type":"text","value":" 은 인덱스 레코드에 설정되는 Lock 입니다. 테이블에 인덱스가 정의되지 않았어도 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"InnoDB"}]},{"type":"text","value":" 에선 숨겨진 Clustered Index 를 생성하기 때문에 이를 활용하여 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"Record Lock"}]},{"type":"text","value":" 을 적용할 수 있습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"예를 들어, "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"SELECT name FROM test WHERE id = 1 FOR UPDATE;"}]},{"type":"text","value":" 라는 쿼리를 실행하면 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"id"}]},{"type":"text","value":" 가 1 에 해당하는 레코드에 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"Record Lock"}]},{"type":"text","value":" 이 설정되기 때문에 다른 트랜잭션이 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"id"}]},{"type":"text","value":" 가 1 인 레코드를 변경하는 작업을 수행할 수 없습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"아래는 해당 상황을 연출하고 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"SHOW ENGINE INNODB STATUS"}]},{"type":"text","value":" 를 통해 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"Record Lock"}]},{"type":"text","value":" 이 설정된 것을 확인한 로그입니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"sql"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-sql"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-sql"]},"children":[{"type":"text","value":"RECORD LOCKS space id "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"10"}]},{"type":"text","value":" page "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"no"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"4"}]},{"type":"text","value":" n bits "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"72"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"index"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"PRIMARY"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"of"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"table"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"`"}]},{"type":"text","value":"transaction_test"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"`"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"`"}]},{"type":"text","value":"test"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"`"}]},{"type":"text","value":"\ntrx id "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"3162"}]},{"type":"text","value":" lock_mode X locks rec but "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"not"}]},{"type":"text","value":" gap waiting\nRecord "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"lock"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" heap "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"no"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"2"}]},{"type":"text","value":" PHYSICAL RECORD: n_fields "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"5"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":" compact format"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":" info bits "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"0"}]},{"type":"text","value":"\n "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"0"}]},{"type":"text","value":": len "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"8"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":" hex "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"8000000000000001"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"asc"}]},{"type":"text","value":"         "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"1"}]},{"type":"text","value":": len "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"6"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":" hex "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"000000000"}]},{"type":"text","value":"c4b"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"asc"}]},{"type":"text","value":"      K"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"2"}]},{"type":"text","value":": len "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"7"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":" hex "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"820000008"}]},{"type":"text","value":"e0110"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"asc"}]},{"type":"text","value":"        "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"3"}]},{"type":"text","value":": len "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"8"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":" hex "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"7175617269746368"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"asc"}]},{"type":"text","value":" quaritch"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"4"}]},{"type":"text","value":": len "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"8"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":" hex "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"8000000000000019"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"asc"}]},{"type":"text","value":"         "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Gap Lock"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"Gap Lock"}]},{"type":"text","value":" 은 인덱스 레코드 간의 Gap 혹은 첫 번째 또는 마지막 인덱스 레코드 전/후의 Gap 에 설정되는 Lock 입니다. Gap 자체에 Lock 이 설정되었기 때문에 삽입하려는 곳의 값 존재 여부와 관계 없이 다른 트랜잭션에서 데이터를 삽입할 수 없습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"예를 들어, "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"SELECT name FROM test WHERE id >= 1 FOR UPDATE;"}]},{"type":"text","value":" 라는 쿼리를 실행하고 다른 트랜잭션이 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"id"}]},{"type":"text","value":" 가 8 인 데이터를 삽입하려고 할 경우 해당 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"id"}]},{"type":"text","value":" 값은 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"Gap Lock"}]},{"type":"text","value":" 이 설정된 상태이기 때문에 삽입 작업을 수행할 수 없습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"아래는 해당 상황을 연출하고 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"Gap Lock"}]},{"type":"text","value":" 이 설정된 것을 확인한 결과입니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1586px; "},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/835d1e9d20122dc2da7d30c264faeccf/867ee/Screen_Shot_2022-11-08_at_4.07.08_PM.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 29.2%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA/ElEQVQY00VQ2W6EMAzka0oSjoQjEM6FXWmr9v//Z+qxoPtgxdieiyylCW3boa5rpGnGMCbtu75HH6O8EW3X682YEtb9QAgB3ntE2XPO/q4sCkFZljAmx5BmJcjzL/imVaJGAJyx+iFhXndYa+GcQ2hbFPLe3+TJ9uOJRsDWGlWflk3J6TDNCygYQoOicJjmFc/3j/SFgjsRpKuqqrSYLNtIKC6oQoJRYpPc+4D6OiaYsz6OInp+CC/n/79FKlsfJ4I6vAjTTegVxCgkcM4iDkL4ONVtSVfi6LO/Ir++f1XBGINNjpftgMlzjUkQwQRQhIIviXyDmYy7uzj7A41wvOvD7g+rAAAAAElFTkSuQmCC'); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"Screen Shot 2022-11-08 at 4.07.08 PM.png","title":"Screen Shot 2022-11-08 at 4.07.08 PM.png","src":"/static/835d1e9d20122dc2da7d30c264faeccf/867ee/Screen_Shot_2022-11-08_at_4.07.08_PM.png","srcSet":["/static/835d1e9d20122dc2da7d30c264faeccf/0eb09/Screen_Shot_2022-11-08_at_4.07.08_PM.png 500w","/static/835d1e9d20122dc2da7d30c264faeccf/1263b/Screen_Shot_2022-11-08_at_4.07.08_PM.png 1000w","/static/835d1e9d20122dc2da7d30c264faeccf/867ee/Screen_Shot_2022-11-08_at_4.07.08_PM.png 1586w"],"sizes":["(max-width:","1586px)","100vw,","1586px"],"style":"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;","loading":"lazy"},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"sql"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-sql"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-sql"]},"children":[{"type":"text","value":"RECORD LOCKS space id "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"11"}]},{"type":"text","value":" page "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"no"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"4"}]},{"type":"text","value":" n bits "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"72"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"index"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"PRIMARY"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"of"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"table"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"`"}]},{"type":"text","value":"transaction_test"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"`"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"`"}]},{"type":"text","value":"test"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"`"}]},{"type":"text","value":"\ntrx id "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"3194"}]},{"type":"text","value":" lock_mode X locks gap before rec "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"insert"}]},{"type":"text","value":" intention waiting\nRecord "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"lock"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" heap "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"no"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"5"}]},{"type":"text","value":" PHYSICAL RECORD: n_fields "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"5"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":" compact format"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":" info bits "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"0"}]},{"type":"text","value":"\n "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"0"}]},{"type":"text","value":": len "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"8"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":" hex "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"800000000000000"}]},{"type":"text","value":"a"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"asc"}]},{"type":"text","value":"         "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"1"}]},{"type":"text","value":": len "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"6"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":" hex "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"000000000"}]},{"type":"text","value":"c74"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"asc"}]},{"type":"text","value":"      t"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"2"}]},{"type":"text","value":": len "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"7"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":" hex "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"82000000"}]},{"type":"text","value":"ab0110"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"asc"}]},{"type":"text","value":"        "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"3"}]},{"type":"text","value":": len "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"4"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":" hex "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"6"}]},{"type":"text","value":"f726361"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"asc"}]},{"type":"text","value":" orca"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"4"}]},{"type":"text","value":": len "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"8"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":" hex "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"800000000000001"}]},{"type":"text","value":"a"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"asc"}]},{"type":"text","value":"         "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Next-Key Lock"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"Next-Key Lock"}]},{"type":"text","value":" 은 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"Record Lock"}]},{"type":"text","value":" 과 해당 인덱스 레코드 앞의 Gap 에 대한 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"Gap Lock"}]},{"type":"text","value":" 이 조합된 Lock 입니다. 예시에 해당하는 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"Next-Key Lock"}]},{"type":"text","value":" 은 아래 명시된 것과 같이 적용됩니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"text"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-text"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"(negative infinity, 1]\n(1, 2]\n(2, 3]\n(3, 6]\n(6, 10]\n(10, positive infinity)"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"마지막 범위에 대한 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"Next-Key Lock"}]},{"type":"text","value":" 은 실제 인덱스의 가장 큰 값과 가장 높은 값을 갖는 허위 인덱스, "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"supremum pseudo-record"}]},{"type":"text","value":" 를 통해 Lock 을 설정합니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1552px; "},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/10f54dc94aebbb6eafbb2225d22d9337/cc6c5/Screen_Shot_2022-11-08_at_3.46.45_PM.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 24.200000000000003%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA3ElEQVQY002Pa3KDMAyEuU1qgw22bEMImTRN8+hM73+djdYJTH7sICT521VTSkGIEX3fI6WMaT5oPWAYBnAmKSGEWOvleNp2Rb8iUmvvHbxztW6medGGx9duhyAJ+8MRxhi0bQvJBVF7vcIlj1hO59rn3KspAW3XwSmM4qy5Pv6Ry1iBeZzwc32g0yUqRNGHr0fjNONy+1PzHtaaapTURPQqiv+ENkw06El0JYCJ6UQgk1trYc0LwN01iVtnH6oJmYgOTJg06ffltgF56npiGfc4/94V6N8GssE/9QR2M50mo+VgIwAAAABJRU5ErkJggg=='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"Screen Shot 2022-11-08 at 3.46.45 PM.png","title":"Screen Shot 2022-11-08 at 3.46.45 PM.png","src":"/static/10f54dc94aebbb6eafbb2225d22d9337/cc6c5/Screen_Shot_2022-11-08_at_3.46.45_PM.png","srcSet":["/static/10f54dc94aebbb6eafbb2225d22d9337/0eb09/Screen_Shot_2022-11-08_at_3.46.45_PM.png 500w","/static/10f54dc94aebbb6eafbb2225d22d9337/1263b/Screen_Shot_2022-11-08_at_3.46.45_PM.png 1000w","/static/10f54dc94aebbb6eafbb2225d22d9337/cc6c5/Screen_Shot_2022-11-08_at_3.46.45_PM.png 1552w"],"sizes":["(max-width:","1552px)","100vw,","1552px"],"style":"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;","loading":"lazy"},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"실제로 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"SELECT … FROM performance_schema.data_locks;"}]},{"type":"text","value":" 를 통해 확인해보면 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"supremum pseudo-record"}]},{"type":"text","value":" 가 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"LOCK_DATA"}]},{"type":"text","value":" 로 잡혀있는 것을 확인할 수 있습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Consistent Non-Locking Reads"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"MySQL 의 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"InnoDB"}]},{"type":"text","value":" 는 동시성 성능을 최대화하기 위해 Multiversion Concurrency Control, MVCC 라는 개념을 도입했습니다. 이는 격리 수준에 따라 상이하지만, 특정 시점의 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"Snapshot"}]},{"type":"text","value":" 정보를 바탕으로 Locking 이 필요하지 않은 Consistent Read 를 제공한다는 공통점이 있습니다. 이를 MySQL 에선 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"Consistent Non-Locking Read"}]},{"type":"text","value":" 라고 합니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"REPEATALBE READ"}]},{"type":"text","value":" 격리 수준에선 최초 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"SELECT"}]},{"type":"text","value":" 문이 수행된 시점을 기준으로 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"Snapshot"}]},{"type":"text","value":" 이 생성되어 다른 트랜잭션에 의해 해당 데이터가 변경되어도 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"Undo Log"}]},{"type":"text","value":" 에 저장된 내용을 기반으로 기존 데이터를 재구성합니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"READ COMMITTED"}]},{"type":"text","value":" 격리 수준에선 각 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"SELECT"}]},{"type":"text","value":" 문 마다 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"Snapshot"}]},{"type":"text","value":" 이 초기화되기 때문에 다른 트랜잭션의 커밋에 의해 해당 데이터가 변경되면 같은 읽기 작업이라도 다른 결과를 반환할 수 있습니다."}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Locking Reads"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"기본적인 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"SELECT"}]},{"type":"text","value":" 문을 통해 조회한 데이터는 기본적으로 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"Non-Locking Read"}]},{"type":"text","value":" 입니다. 때문에 다른 트랜잭션에 의해 변경될 가능성이 높습니다. "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"InnoDB"}]},{"type":"text","value":" 는 이를 해결하기 위해 두 가지 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"Locking Read"}]},{"type":"text","value":" 를 제공합니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"SELECT … FOR SHARE"}]},{"type":"text","value":" 는 읽은 Row 에 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"S-Lock"}]},{"type":"text","value":" 을 설정합니다. 다른 트랜잭션이 Row 를 읽을 순 있지만, "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"S-Lock"}]},{"type":"text","value":" 을 설정한 트랜잭션이 커밋되기 전까지 Row 를 수정할 수 없습니다. 아직 커밋되지 않은 다른 트랜잭션에 의해 해당 Row 가 변경될 경우, 트랜잭션이 종료될 때까지 기다린 뒤 가장 최신화된 값을 사용하여 쿼리를 수행합니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"SELECT … FOR UPDATE"}]},{"type":"text","value":" 는 검색에서 발견한 인덱스 레코드에 대해 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"UPDATE"}]},{"type":"text","value":" 문을 실행한 것과 동일하게 Row 및 관련 인덱스에 Lock 을 설정합니다. 다른 트랜잭션은 해당 Row 를 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"UPDATE"}]},{"type":"text","value":" 또는 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"SELECT ... FOR SHARE"}]},{"type":"text","value":" 를 수행하는 것이 제한됩니다."}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"FOR SHARE"}]},{"type":"text","value":" 혹은 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"FOR UPDATE"}]},{"type":"text","value":" 로 설정된 모든 Lock 은 트랜잭션이 커밋 또는 롤백될 때 반환됩니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"여기까지 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"InnoDB"}]},{"type":"text","value":" 의 Locking, Consistent Non-Locking Read, Locking Read 등에 대해 알아보았습니다. 이제 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"InnoDB"}]},{"type":"text","value":" 가 4가지 트랜잭션 격리 수준을 이를 통해 어떻게 구현했는지 살펴보겠습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"READ UNCOMMITTED"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"먼저 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"READ UNCOMMITTED"}]},{"type":"text","value":" 입니다. 트랜잭션의 변경 내용이 커밋이나 롤백 여부와 관계 없이 다른 트랜잭션에 보이는 가장 낮은 수준의 격리 레벨입니다. "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"READ UNCOMMITTED"}]},{"type":"text","value":" 격리 수준에서 일반적인 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"SELECT"}]},{"type":"text","value":" 문은 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"Non-Locking Read"}]},{"type":"text","value":" 로 수행되지만 MVCC 를 사용하지 않아 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"Consistent Read"}]},{"type":"text","value":" 를 보장하지않습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Dirty Read"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"READ UNCOMMITTED"}]},{"type":"text","value":" 격리 수준에서 발생할 수 있는 읽기 부정합 현상입니다. 다른 트랜잭션에 의해 영향 받은 Row 를 읽을 수 있기 때문에 발생하는 현상입니다. 커밋 또는 롤백에 관계 없이 보여지기 때문에 부정확한 데이터를 사용할 수 있는 위험한 상황이 발생할 수 있습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"이는 데이터베이스의 ACID 성질을 준수하지 못하기에 이를 해결하기 위해 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"InnoDB"}]},{"type":"text","value":" 에선 MVCC 를 통한 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"Consistent Read"}]},{"type":"text","value":" 를 제공합니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"READ COMMITTED"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"READ COMMITTED"}]},{"type":"text","value":" 격리 수준부터 MVCC 가 사용되어 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"Consistent Read"}]},{"type":"text","value":" 를 지원하지만 동일한 트랜잭션 내에서 각 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"SELECT"}]},{"type":"text","value":" 문은 자체적으로 새로운 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"Snapshot"}]},{"type":"text","value":" 을 생성하기 때문에 완전한 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"Consistent Read"}]},{"type":"text","value":" 를 보장하진 않습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"Locking Read"}]},{"type":"text","value":" "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"UPDATE"}]},{"type":"text","value":" "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"DELETE"}]},{"type":"text","value":" 문의 경우 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"Record Lock"}]},{"type":"text","value":" 만을 설정하고 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"Gap Lock"}]},{"type":"text","value":" 은 설정하지 않기에 다른 트랜잭션에서 자유롭게 Gap 에 접근할 수 있습니다. "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"Gap Lock"}]},{"type":"text","value":" 을 설정하지 않기 때문에 범위 검색과 같은 쿼리에서 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"Phantom Read"}]},{"type":"text","value":" 현상 역시 발생할 수 있습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"sql"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-sql"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-sql"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"SET"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"TRANSACTION"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"ISOLATION"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"LEVEL"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"READ"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"COMMITTED"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"START"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"TRANSACTION"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"UPDATE"}]},{"type":"text","value":" test "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"SET"}]},{"type":"text","value":" name "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"'meatsby'"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"WHERE"}]},{"type":"text","value":" name "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"'quaritch'"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1586px; "},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/a8d3cdc9e255b3831d6e6eedc0a52dd5/867ee/Screen_Shot_2022-11-09_at_12.57.59_PM.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 9.2%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAe0lEQVQI1x2NSxKDIBQEPY1BTVVIBIXHT9Hc/0gtuphFd83UdDUXtuMkpEwWT60HMW9459hTIm8VkYAxhnVZqKVQzz+p7ATf+m1X6omEiLWWzoeE1l9efc9sVyRmhkExTW8WJ8zG8ptN44lxHAntzElEKfW4j9aPv3PzBRAfQWzpdRxhAAAAAElFTkSuQmCC'); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"Screen Shot 2022-11-09 at 12.57.59 PM.png","title":"Screen Shot 2022-11-09 at 12.57.59 PM.png","src":"/static/a8d3cdc9e255b3831d6e6eedc0a52dd5/867ee/Screen_Shot_2022-11-09_at_12.57.59_PM.png","srcSet":["/static/a8d3cdc9e255b3831d6e6eedc0a52dd5/0eb09/Screen_Shot_2022-11-09_at_12.57.59_PM.png 500w","/static/a8d3cdc9e255b3831d6e6eedc0a52dd5/1263b/Screen_Shot_2022-11-09_at_12.57.59_PM.png 1000w","/static/a8d3cdc9e255b3831d6e6eedc0a52dd5/867ee/Screen_Shot_2022-11-09_at_12.57.59_PM.png 1586w"],"sizes":["(max-width:","1586px)","100vw,","1586px"],"style":"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;","loading":"lazy"},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"추가적으로 위 그럼처럼 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"UPDATE"}]},{"type":"text","value":" 쿼리를 위한 풀 테이블 스캔 시 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"READ COMMITTED"}]},{"type":"text","value":" 는 스캔 중 마주치는 모든 인덱스 레코드에 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"X-Lock"}]},{"type":"text","value":" 을 설정하고 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"WHERE"}]},{"type":"text","value":" 절이 수행될 때 조건에 부합하지 않는 인덱스 레코드의 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"X-Lock"}]},{"type":"text","value":" 을 반환하는 특징을 가지고 있습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"변경할 인덱스 레코드를 제외한 다른 인덱스 레코드의 Lock 을 반환하기 때문에 다른 트랜잭션과의 충돌로 인한 데드락 발생 확률을 현저히 줄였다고 MySQL 은 소개합니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"sql"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-sql"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-sql"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"SET"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"TRANSACTION"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"ISOLATION"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"LEVEL"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"REPEATABLE"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"READ"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"START"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"TRANSACTION"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"UPDATE"}]},{"type":"text","value":" test "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"SET"}]},{"type":"text","value":" name "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"'meatsby'"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"WHERE"}]},{"type":"text","value":" name "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"'quaritch'"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1586px; "},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/26bd47bd970acf624fb5f49fb22206ed/867ee/Screen_Shot_2022-11-09_at_12.57.15_PM.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 23.400000000000002%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA2klEQVQY011Q2Y6EMAzr3yxHKb2hwIg5mEP7///jTQKjGe1DFNW1HScqpQRrLfq+R5lm+BBhjEEIAc55wvc/xiJxl9MK5/3+jhE5D/JmrnMOaigTmqamalCWnVxVPzDWCVbXFdq2pV7DRzJcr9BaE6eCo+ExZdIECcKlbs9fmdaS+LI9MZRZxDyRjd7FWMojNuJzah72TmpMj066gRqnBbrrRDQeKzOZ1/wY6sMgoMwnETPOBowL5+jqfHugI0P+WK8b8lAkjaV7/E8Y6V6X+0sSMd/TnXn9b94f6B6choinwocAAAAASUVORK5CYII='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"Screen Shot 2022-11-09 at 12.57.15 PM.png","title":"Screen Shot 2022-11-09 at 12.57.15 PM.png","src":"/static/26bd47bd970acf624fb5f49fb22206ed/867ee/Screen_Shot_2022-11-09_at_12.57.15_PM.png","srcSet":["/static/26bd47bd970acf624fb5f49fb22206ed/0eb09/Screen_Shot_2022-11-09_at_12.57.15_PM.png 500w","/static/26bd47bd970acf624fb5f49fb22206ed/1263b/Screen_Shot_2022-11-09_at_12.57.15_PM.png 1000w","/static/26bd47bd970acf624fb5f49fb22206ed/867ee/Screen_Shot_2022-11-09_at_12.57.15_PM.png 1586w"],"sizes":["(max-width:","1586px)","100vw,","1586px"],"style":"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;","loading":"lazy"},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"반면 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"REPEATABLE READ"}]},{"type":"text","value":" 에선 스캔 중 마주치는 모든 인덱스 레코드에 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"X-Lock"}]},{"type":"text","value":" 을 설정하여 커밋 또는 롤백까지 Lock 을 반환하지 않습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Non-Repeatable Read"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"READ COMMITTED"}]},{"type":"text","value":" 격리 수준까지 발생할 수 있는 읽기 부정합 현상입니다. 앞서 설명한 것 처럼 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"READ COMMITTED"}]},{"type":"text","value":" 격리 수준에서 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"SELECT"}]},{"type":"text","value":" 문은 항상 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"Snapshot"}]},{"type":"text","value":" 을 초기화하기 때문에 한 트랜잭션에서 동일한 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"SELECT"}]},{"type":"text","value":" 문을 수행해도 일관된 데이터를 반환하지 않는 문제가 발생할 수 있습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"REPEATABLE READ"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"InnoDB"}]},{"type":"text","value":" 에서 기본값으로 제공하는 격리 레벨로, "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"READ COMMITTED"}]},{"type":"text","value":" 격리 수준과는 달리 처음 생성된 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"Snapshot"}]},{"type":"text","value":" 을 통해 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"Consistent Read"}]},{"type":"text","value":" 를 보장합니다. 즉, 동일한 트랜잭션 내의 일반적인 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"SELECT"}]},{"type":"text","value":" 문의 일관성을 보장합니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"Locking Read"}]},{"type":"text","value":" "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"UPDATE"}]},{"type":"text","value":" "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"DELETE"}]},{"type":"text","value":" 문의 경우 검색 조건에 따라 사용하는 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"Lock"}]},{"type":"text","value":" 이 달라집니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"고유한 검색 조건이 있는 고유 인덱스에 대한 쿼리는 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"Record Lock"}]},{"type":"text","value":" 이 적용됩니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"범위 검색 조건과 같은 다른 검색 조건의 경우 스캔한 인덱스 범위에 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"Gap Lock"}]},{"type":"text","value":" 또는 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"Next-Key Lock"}]},{"type":"text","value":" 을 설정하여 다른 트랜잭션이 해당 범위에 접근하는 것을 제한합니다."}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"아래 예시를 통해 위 두 상황을 좀 더 자세히 살펴보겠습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"sql"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-sql"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-sql"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# Session A"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"SET"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"TRANSACTION"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"ISOLATION"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"LEVEL"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"REPEATABLE"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"READ"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"START"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"TRANSACTION"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"SELECT"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"*"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"FROM"}]},{"type":"text","value":" test "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"WHERE"}]},{"type":"text","value":" id "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"6"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"FOR"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"UPDATE"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1586px; "},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/3d7e993f8b993a9d167a1848b0a9460f/867ee/Screen_Shot_2022-11-09_at_2.46.55_PM.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 9%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAeklEQVQI1xWLaxpDMBQFrYZ4fFolyOuK0O5/R9Pr55yZU5Ujk68vIQlH8JRykXTzznFKQs4LHyKLtezbRjmEcv+QXAhe+5jI5Sbq364rlQuJcXzR1DXr7njYmIZhGJQ982L5zAt939O1LUEyLoo2hk639zSp62jVPc0fHy9BjwtJPPwAAAAASUVORK5CYII='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"Screen Shot 2022-11-09 at 2.46.55 PM.png","title":"Screen Shot 2022-11-09 at 2.46.55 PM.png","src":"/static/3d7e993f8b993a9d167a1848b0a9460f/867ee/Screen_Shot_2022-11-09_at_2.46.55_PM.png","srcSet":["/static/3d7e993f8b993a9d167a1848b0a9460f/0eb09/Screen_Shot_2022-11-09_at_2.46.55_PM.png 500w","/static/3d7e993f8b993a9d167a1848b0a9460f/1263b/Screen_Shot_2022-11-09_at_2.46.55_PM.png 1000w","/static/3d7e993f8b993a9d167a1848b0a9460f/867ee/Screen_Shot_2022-11-09_at_2.46.55_PM.png 1586w"],"sizes":["(max-width:","1586px)","100vw,","1586px"],"style":"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;","loading":"lazy"},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"현재 예시에선 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"id"}]},{"type":"text","value":" 가 인덱스로 작용하고 있기 때문에 고유한 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"id"}]},{"type":"text","value":" 조건을 통해 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"FOR UPDATE"}]},{"type":"text","value":" 를 수행할 경우 해당하는 인덱스 레코드에만 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"Record Lock"}]},{"type":"text","value":" 이 설정됩니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"sql"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-sql"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-sql"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# Session B"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"INSERT"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"INTO"}]},{"type":"text","value":" test "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"text","value":"id"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" name"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" age"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"VALUES"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"5"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"'test'"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"26"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 614px; "},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/0d232d19ac084ba02b5e8d6588430a5c/c42f5/Screen_Shot_2022-11-09_at_2.56.23_PM.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 53%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABYlAAAWJQFJUiTwAAABmUlEQVQoz3WS61LjMAyF8zDLNLdCkiaOHTuO67DpwtDOFGaA2cv7P8ZZyWCGtvBDY9mWPh9JTvSgIHqD12ONP/8a/Hp4hPMei53wfDtiORzw9PwbdpqglIKnO2MM+mHAq99iv9/h+PIXfp4x0nky0EXbCjjbYFpqjM5D0pmRCs50MPMWP3f3UING13WQUkIIgbYT8KqH8QPm5Q7ajHSnkLCT5xnSrEC6KslWuKlqtL2EnXcUOEFbBzcvKMsSWZahKIpgaZ7TPsfV1Q9IbTAYi8QEYI6SAsqyCP5NVQUFklUReL2+Jlt/gBgc1nefczrRU+skAUcbDmJwBHZCEtBA6ZGS1icxERiNVfPDPZc8UvPPgVXdhAAzbaHH6ST5HBjb0CsdKnrv4SVQ0GuK+sIqzxWd7t+AHC969XXJVV2HkhnIJX/u3wXwQ+EQ4hM7uUsgTTkqZLVZmn7fwwBMIalkhiaakoriFFg3mzBlhrLPD/CgvhsK5zSblmzzpvDz32LfujmU6unDutsdlvt98GNyXKOfpqvwBzW17z+uqV7VWPbG7gAAAABJRU5ErkJggg=='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"Screen Shot 2022-11-09 at 2.56.23 PM.png","title":"Screen Shot 2022-11-09 at 2.56.23 PM.png","src":"/static/0d232d19ac084ba02b5e8d6588430a5c/c42f5/Screen_Shot_2022-11-09_at_2.56.23_PM.png","srcSet":["/static/0d232d19ac084ba02b5e8d6588430a5c/0eb09/Screen_Shot_2022-11-09_at_2.56.23_PM.png 500w","/static/0d232d19ac084ba02b5e8d6588430a5c/c42f5/Screen_Shot_2022-11-09_at_2.56.23_PM.png 614w"],"sizes":["(max-width:","614px)","100vw,","614px"],"style":"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;","loading":"lazy"},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"때문에 다른 트랜잭션이 Gap 에 데이터를 삽입할 때 아무 제한 없이 정상적으로 데이터가 삽입됩니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"sql"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-sql"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-sql"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# Session A"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"SET"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"TRANSACTION"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"ISOLATION"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"LEVEL"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"REPEATABLE"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"READ"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"START"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"TRANSACTION"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"SELECT"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"*"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"FROM"}]},{"type":"text","value":" test "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"WHERE"}]},{"type":"text","value":" age "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"25"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"FOR"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"UPDATE"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1584px; "},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/859ab579499b580a8ad941bf4e6ce877/bf788/Screen_Shot_2022-11-09_at_2.51.22_PM.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 23.400000000000002%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA3ElEQVQY011QW27DMAzzbZaH7fidOEmRtc3WYfe/DyfJLTbsQxBMkxQllXOGcw7TNKGuG0JMsNYixgjvA+Htj7FE3P1ywIfQ3imhlFnezPXeQ811xTD0VAPq3shd9wbrvGB932EcR+o9QiLD4watNXE6eBqeciFNlCBc6v74lmkjia/nA3PdRMwT2ehVjOWy4CQ+p+Zhr6TWTjDUjbFQy7pDGyOi5bkyk3nNX0P9NIio20XEjLMZ443Tunq/f5KzkY/jdqLMVdI4usf/hInudf34kkTMD3RnXv8v7wfnK5yFxfQziwAAAABJRU5ErkJggg=='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"Screen Shot 2022-11-09 at 2.51.22 PM.png","title":"Screen Shot 2022-11-09 at 2.51.22 PM.png","src":"/static/859ab579499b580a8ad941bf4e6ce877/bf788/Screen_Shot_2022-11-09_at_2.51.22_PM.png","srcSet":["/static/859ab579499b580a8ad941bf4e6ce877/0eb09/Screen_Shot_2022-11-09_at_2.51.22_PM.png 500w","/static/859ab579499b580a8ad941bf4e6ce877/1263b/Screen_Shot_2022-11-09_at_2.51.22_PM.png 1000w","/static/859ab579499b580a8ad941bf4e6ce877/bf788/Screen_Shot_2022-11-09_at_2.51.22_PM.png 1584w"],"sizes":["(max-width:","1584px)","100vw,","1584px"],"style":"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;","loading":"lazy"},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"반면 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"age"}]},{"type":"text","value":" 와 같이 현재 테이블 상태에선 고유하지만 인덱스가 아닌 조건을 통해 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"FOR UPDATE"}]},{"type":"text","value":" 를 수행할 경우 풀 테이블 스캔을 통해 해당 인덱스 레코드를 탐색하기 때문에 그 과정에서 마주친 모든 인덱스 레코드에 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"X-Lock"}]},{"type":"text","value":" 이 적용됩니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"sql"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-sql"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-sql"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# Session B"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"INSERT"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"INTO"}]},{"type":"text","value":" test "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"text","value":"id"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" name"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" age"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"VALUES"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"5"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"'test'"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"26"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1584px; "},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/130c876ff424dc40c230d161d88f7b1c/bf788/Screen_Shot_2022-11-09_at_2.52.42_PM.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 29.2%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAABYlAAAWJQFJUiTwAAABBElEQVQY00VQWXaDMAzkNMUm2Aa8AGHJ0pe8tve/z1SjlOZDz7bk2VRN04whRngfMM1njPL23iOlhFwKUi6IMaEfos7W/Yqu66U6JMH1fQ8fgmJ4VmWc4JyDMTWyAGLKqOsPhH6QexGxpD1WKhPmdYe1Fs3ppATWGlhj0DSN9qv9eld1NpftgnnZlJy9IE6c83CifhKCeVlxf3zpnUXHuYwqOmiKAdV2EAr7OC9aVKV627aqTDDnScCMzDdnQWJTkHEpyqTVern9ERrZ4ZswKKF7uSGxEGaJzP8UIZgkL8Hm/6w+nz+IsnjGXPebOjB1rYtvBfR2KIJnifz81h5nNHLEP+oXNwC8fEMkweUAAAAASUVORK5CYII='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"Screen Shot 2022-11-09 at 2.52.42 PM.png","title":"Screen Shot 2022-11-09 at 2.52.42 PM.png","src":"/static/130c876ff424dc40c230d161d88f7b1c/bf788/Screen_Shot_2022-11-09_at_2.52.42_PM.png","srcSet":["/static/130c876ff424dc40c230d161d88f7b1c/0eb09/Screen_Shot_2022-11-09_at_2.52.42_PM.png 500w","/static/130c876ff424dc40c230d161d88f7b1c/1263b/Screen_Shot_2022-11-09_at_2.52.42_PM.png 1000w","/static/130c876ff424dc40c230d161d88f7b1c/bf788/Screen_Shot_2022-11-09_at_2.52.42_PM.png 1584w"],"sizes":["(max-width:","1584px)","100vw,","1584px"],"style":"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;","loading":"lazy"},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"이 상태에서 다른 트랜잭션이 Gap 에 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"id"}]},{"type":"text","value":" 가 5 인 데이터를 삽입하려고 할 경우 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"id"}]},{"type":"text","value":" 가 6 인 인덱스 레코드의 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"Gap Lock"}]},{"type":"text","value":" 으로 인해 데이터 삽입이 제한됩니다. 이를 통해 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"InnoDB"}]},{"type":"text","value":" 에선 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"REPEATABLE READ"}]},{"type":"text","value":" 수준에서도 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"Phantom Read"}]},{"type":"text","value":" 현상을 방지할 수 있습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Phantom Read"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"sql"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-sql"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-sql"]},"children":[{"type":"text","value":"A : "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"START"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"TRANSACTION"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\nA : "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"SELECT"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"*"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"FROM"}]},{"type":"text","value":" test"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# 최초 Snapshot 생성"}]},{"type":"text","value":"\n\nB : "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"INSERT"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"INTO"}]},{"type":"text","value":" test "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"text","value":"id"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" name"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" age"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"VALUES"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"5"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"'test'"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"26"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# Lock 이 걸려있지 않기 때문에 Gap 에 데이터 삽입 가능"}]},{"type":"text","value":"\n\nA : "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"SELECT"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"*"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"FROM"}]},{"type":"text","value":" test"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# 최초 Snapshot 을 그대로 사용"}]},{"type":"text","value":"\nA : "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"UPDATE"}]},{"type":"text","value":" test "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"SET"}]},{"type":"text","value":" name "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"'twenty-six'"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"WHERE"}]},{"type":"text","value":" age "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"26"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# Locking Read 를 통해 새롭게 읽은 후 UPDATE"}]},{"type":"text","value":"\nA : "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"SELECT"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"*"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"FROM"}]},{"type":"text","value":" test"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# Snapshot 이 초기화되어 Phantom Read 발생"}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"여전히 이런 구조에도 불구하고 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"REPEATABLE READ"}]},{"type":"text","value":" 에서 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"Phantom Read"}]},{"type":"text","value":" 가 발생할 수 있는 상황이 있습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"위 상황처럼 다른 트랜잭션이 추가한 레코드에 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"UPDATE"}]},{"type":"text","value":" 쿼리를 수행하게 될 경우, 첫 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"SELECT"}]},{"type":"text","value":" 쿼리로 생성된 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"Snapshot"}]},{"type":"text","value":" 에는 존재하지 않지만 실제 디스크에는 데이터가 존재하기 때문에 해당 레코드가 영향을 받아 이후 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"SELECT"}]},{"type":"text","value":" 쿼리를 수행할 때 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"Snapshot"}]},{"type":"text","value":" 이 초기화되는 시점에 해당 현상을 발견할 수 있습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"즉, "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"Consistent Non-Locking Read"}]},{"type":"text","value":" 와 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"Locking Read"}]},{"type":"text","value":" 의 조합 때문에 발생할 수 있는 현상입니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"앞서 설명한 것 처럼 일반적인 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"SELECT"}]},{"type":"text","value":" 문은 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"Non-Locking Read"}]},{"type":"text","value":" 를 기반으로 하기 때문에 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"UPDATE"}]},{"type":"text","value":" 를 위한 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"SELECT"}]},{"type":"text","value":" 는 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"SELECT … FOR UPDATE"}]},{"type":"text","value":" 와 같이 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"Locking Read"}]},{"type":"text","value":" 를 사용하는 것이 더 적합합니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"따라서, 위 예시에서 연출하는 상황 자체가 부적절하다고 생각하지만, 여전히 발생할 수 있는 특정 상황이 존재한다는 사실을 알고있는 것이 좋을 것 같습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"SERIALIZABLE"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"마지막 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"SERIALIZABLE"}]},{"type":"text","value":" 은 가장 높은 수준의 격리 레벨입니다. 이름처럼 직렬화된 방식처럼 작동해야합니다. "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"InnoDB"}]},{"type":"text","value":" 에선 이를 구현하기 위해 일반적인 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"SELECT"}]},{"type":"text","value":" 문을 모두 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"SELECT … FOR SHARE"}]},{"type":"text","value":" 문으로 변환하여 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"S-Lock"}]},{"type":"text","value":" 을 통한 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"Locking Read"}]},{"type":"text","value":" 를 수행하게끔 합니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"글 초반부 설명되어있듯이 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"S-Lock"}]},{"type":"text","value":" 은 다른 트랜잭션도 독립적으로 설정이 가능하여 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"S-Lock"}]},{"type":"text","value":" 이 설정된 레코드를 읽을 수 있지만 최초로 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"S-Lock"}]},{"type":"text","value":" 을 설정한 트랜잭션이 종료되기 전까진 변경을 가할 수 없습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"sql"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-sql"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-sql"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"SET"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"TRANSACTION"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"ISOLATION"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"LEVEL"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"SERIALIZABLE"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"START"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"TRANSACTION"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"SELECT"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"*"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"FROM"}]},{"type":"text","value":" test"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1582px; "},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/c481804ab6644faae76245d685532e91/d3b5d/Screen_Shot_2022-11-09_at_1.23.06_PM.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 23.400000000000002%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA6klEQVQY011Q227FIAzr16w3oDdKgbZQ6Kodaf//PV6CdKRtDxaG2IlJlUNATDeOEHF6j5wyduK7c7jCiZhveL9Da43NGHymhHQ/OOKFw1qkM+CMCRvxZVlQuf3EOE6o6w/MegXfm6aBkBJSKeI1uq4r6PuehiWsxqKpawghsW4W87xgXnRB9by+Yd1ejMY65OdVjGoYCpi/IYSg+hf8EdC2bamP0wQpFRQN57Mk5M4dCfi09D02c5ET/m9o/QG9mpKYNfz2Ts+oEk00mysJOX7MTxHwRKWGP+KezBftj5u2tJZhGMu6fmt+AJZcn0r6SX/rAAAAAElFTkSuQmCC'); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"Screen Shot 2022-11-09 at 1.23.06 PM.png","title":"Screen Shot 2022-11-09 at 1.23.06 PM.png","src":"/static/c481804ab6644faae76245d685532e91/d3b5d/Screen_Shot_2022-11-09_at_1.23.06_PM.png","srcSet":["/static/c481804ab6644faae76245d685532e91/0eb09/Screen_Shot_2022-11-09_at_1.23.06_PM.png 500w","/static/c481804ab6644faae76245d685532e91/1263b/Screen_Shot_2022-11-09_at_1.23.06_PM.png 1000w","/static/c481804ab6644faae76245d685532e91/d3b5d/Screen_Shot_2022-11-09_at_1.23.06_PM.png 1582w"],"sizes":["(max-width:","1582px)","100vw,","1582px"],"style":"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;","loading":"lazy"},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"위 그림처럼 단순히 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"SELECT"}]},{"type":"text","value":" 문을 수행해도 모든 레코드에 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"S-Lock"}]},{"type":"text","value":" 이 설정된 것을 확인할 수 있습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"마무리"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"여기까지 MySQL 의 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"InnoDB"}]},{"type":"text","value":" 가 4가지 격리 수준을 구현한 방법에 대해 알아보았습니다. 격리 수준은 동시성과 격리성의 Trade-Off 인 만큼 자세히 알고 사용하면 더 좋은 효과를 나타낼 수 있을 것 같습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"MySQL 은 다른 DBMS 벤더들과는 달리 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"InnoDB"}]},{"type":"text","value":" 를 통해 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"REPEATABLE READ"}]},{"type":"text","value":" 에서도 충분한 격리성을 보여주고 있습니다. 하지만 여러가지 Locking 기법을 활용하여 격리 수준을 구현했기 때문에 Locking 으로 인해 발생할 수 있는 여러 문제점 역시 충분히 이해하는 것이 중요하다고 생각합니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"References"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://dev.mysql.com/doc/refman/8.0/en/innodb-locking.html"},"children":[{"type":"text","value":"MySQL Docs - InnoDB Locking"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://dev.mysql.com/doc/refman/8.0/en/innodb-consistent-read.html"},"children":[{"type":"text","value":"MySQL Docs - Consistent Nonlocking Reads"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://dev.mysql.com/doc/refman/8.0/en/innodb-locking-reads.html"},"children":[{"type":"text","value":"MySQL Docs - Locking Reads"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://dev.mysql.com/doc/refman/8.0/en/innodb-transaction-isolation-levels.html"},"children":[{"type":"text","value":"MySQL Docs - Transaction Isolation Levels"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://dev.mysql.com/doc/refman/8.0/en/innodb-next-key-locking.html"},"children":[{"type":"text","value":"MySQL Docs - Phantom Rows"}]}]},{"type":"text","value":"\n"}]}],"data":{"quirksMode":false}},"excerpt":"Transaction Isolation Level 애플리케이션을 개발 중 데이터베이스를 도입하면 격리 수준에 대한 이해가 자연스럽게 요구됩니다. 격리 수준은 데이터베이스의 ACID 성질 중 Isolation…","timeToRead":11,"frontmatter":{"title":"트랜잭션 격리 수준","userDate":"7 November 2022","date":"2022-11-07T13:10:00.000Z","tags":["Transaction","Isolation-Level"],"excerpt":null,"image":{"childImageSharp":{"fluid":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB5UlEQVQoz5WSTW9SURCG76/wN7jxH/gHjIkLdWWiiYvGdKNrFxp3ujR+RS0Nih8tmrRoqzaljVQLFmKhVJQWqFQLQvko9MLlQnvPfTwcbtEmLuokJ/Nm5p33zGRG4wBm2zZCvq6tlWoE0znmUzl80RSVRkvF9/IaBzTbKdixLD6sbii83WrjDSfZFaLP0f5HzBI9H/n+C93sKPw5W2Ahk1d41xJoXXXRL5DYKdoT6XpbWNJbMm+pWCC5jisQk7EuX+CNJCnrxv6RLadt9ZODu2T7704dn60LXsZylI0er26YPAkl+JavoD0NfeVnVVeJ6USWT077/Q+EifljFnNtks7mIp2ifGkv5P2YpWU61RVFc3+ME0pvoB26dIdrvqAKHrniZuDRFIvrRdmOIF5oEQ970SdO0Fx9QacQpvL6pBSOoS8PURk7RiN+X9W2O23y+g7amQcTXB2fZ8A9pfzFZzOcHXqjSDf9UR7PReRMUiA5Qm1mkOq7c1itMsbKCOXx4zRit51J5JL0LNrDwJLa2qBnmlRxC08wwag8BdfcEqfuTTL6fhYyHmoL1zGSz2l+cbHlv0Bp9KjEwzSit9AjNzDSYxiZV/8+m/PDbzl82cXpuz42t5tqHcLezxHtuuq0dwl/FvobiV/eMJXRQZ8AAAAASUVORK5CYII=","aspectRatio":1.9334719334719335,"src":"/static/64c8b860c2aa4433524a1d980618bc06/3ba25/mysql_isolation.png","srcSet":"/static/64c8b860c2aa4433524a1d980618bc06/3a443/mysql_isolation.png 930w,\n/static/64c8b860c2aa4433524a1d980618bc06/4d929/mysql_isolation.png 1860w,\n/static/64c8b860c2aa4433524a1d980618bc06/3ba25/mysql_isolation.png 2000w","sizes":"(max-width: 2000px) 100vw, 2000px"}}},"author":[{"id":"4기_쿼리치","bio":"우아한테크코스 4기 쿼리치(정석윤)입니다 :)","avatar":{"children":[{"__typename":"ImageSharp","fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/2wBDAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/wgARCAAUABQDASIAAhEBAxEB/8QAGAABAQADAAAAAAAAAAAAAAAAAAQFBgn/xAAXAQEBAQEAAAAAAAAAAAAAAAAABAID/9oADAMBAAIQAxAAAAHgJXVm7uunCHYAH//EABoQAAMAAwEAAAAAAAAAAAAAAAEDBAIFECD/2gAIAQEAAQUCAJLJ3J5BRjJbsNnlSrx//8QAHREBAQACAQUAAAAAAAAAAAAAAQIDERIEECEiUf/aAAgBAwEBPwGVc9Rcs4jp25yGnnn5kmLjs0B7VXx8Cmnv/8QAHREAAgICAwEAAAAAAAAAAAAAAQMCEQQSFCAhIv/aAAgBAgEBPwFCcSeJlNdklb168dEY7FpsA3ZFR+vTdxEZHWXg6f/EACYQAAIBAwIEBwAAAAAAAAAAAAECEQMEIQASEyIxURAgIzIzQVL/2gAIAQEABj8CAAknAA+ydHfTYBW2FoOzdnl3e2eU464PbwtLp04i21xRrlP1wnDxnGY0aCQtGrdveugJ+U71piOnppUeInLnt5f/xAAdEAEBAAEEAwAAAAAAAAAAAAABETEAECFRIEFx/9oACAEBAAE/IUTIAKogAZVYHt0xd3FnFNd10uW3P1kQn68HPGsHrLJIwEoYIaeP/9oADAMBAAIAAwAAABD0AAD/xAAXEQEBAQEAAAAAAAAAAAAAAAARASAh/9oACAEDAQE/EHkWf0RqXWvbAT//xAAWEQEBAQAAAAAAAAAAAAAAAAABERD/2gAIAQIBAT8QjGsClUhsUYERTf/EABkQAQEAAwEAAAAAAAAAAAAAAAERACExIP/aAAgBAQABPxB0H6DA8UYAVABXLDxF7ghNHHQuscR8a6iwodG1rjBo4Ca9YTjeYOaHx//Z","aspectRatio":1,"src":"/static/bcd27cc7f4bf48fc5d0ac68e8c974a5e/f86e8/quaritch.jpg","srcSet":"/static/bcd27cc7f4bf48fc5d0ac68e8c974a5e/b3d27/quaritch.jpg 40w,\n/static/bcd27cc7f4bf48fc5d0ac68e8c974a5e/5a735/quaritch.jpg 80w,\n/static/bcd27cc7f4bf48fc5d0ac68e8c974a5e/6e81a/quaritch.jpg 120w,\n/static/bcd27cc7f4bf48fc5d0ac68e8c974a5e/f86e8/quaritch.jpg 460w","sizes":"(max-width: 460px) 100vw, 460px"}}]}}],"source":null}},"relatedPosts":{"totalCount":1,"edges":[{"node":{"id":"d055a615-9e52-584c-960c-0c9ee1a2ca31","timeToRead":11,"excerpt":"Transaction Isolation Level 애플리케이션을 개발 중 데이터베이스를 도입하면 격리 수준에 대한 이해가 자연스럽게 요구됩니다. 격리 수준은 데이터베이스의 ACID 성질 중 Isolation…","frontmatter":{"title":"트랜잭션 격리 수준","date":"2022-11-07T13:10:00.000Z"},"fields":{"slug":"/post/2022-11-07-mysql-isolation/"}}}]}},"pageContext":{"slug":"/post/2022-11-07-mysql-isolation/","prev":{"excerpt":"무중단 배포를 도입하게 된 계기 프로젝트를 론칭한 이후, 사용자의 피드백을 반영하다보니 운영 환경으로의 배포가 점차 잦아졌습니다. \n문제는 배포를 할 때마다 기존 서버를 내리고 새롭게 띄우는 과정에서 평균 2…","timeToRead":6,"frontmatter":{"title":"무중단 배포","tags":["무중단배포"],"date":"2022-11-01T12:00:00.000Z","draft":false,"excerpt":null,"image":{"childImageSharp":{"fluid":{"aspectRatio":1.332378223495702,"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAACGUlEQVQ4y5VT22oUQRCd3/Qb/AH/wRdffRN8FyUQJC9JIEIQzItggllMzO7OZfuS6Z6+zezlWN2zk8y6CehDUU1X1elTVaczay3GZgxZPBsDRV45T97RvXmI/10ztuwpwOgbArgPHS7MBrlf9XG6M/Y/ACOLMaAIywRYhNVjfCfXPNQM532Go4LY7qLWkNuCgeHQ/j8y3M6q6QHYYgGtFGy32QGLvmmakfX52S71UbJp4L1HTWCN1hDfT2FqSfG4oKbPdRbOGvg1wC6OIM8/9AydcwhUPIA648ANx9ROUfgCM32H4vQdtKjgfEiAIQSssUJpf+O+42itgGE5skiXcY6iLBP1+GpwAcwwnOQnOLg9wFn5BeWGJBSZUU5VVahrhbC2+EY5P9hXOnv4doksvvj+7Wu8evkCs/kcUgpwxmkREqpTUG1vvLjEoirAGIMQnFqlrtYBN9U1btgEYUWA1GkmpMT58RGODz9iOp0lllrRZq2EDBFUU/sL5IdvoFgBF9rEMs63o9ldCWDWAKSwHlDTwH/d3uHq5wScizRPb/1uy8UZCltCaZWWFmva4Ej4wKfLJT5fL1HTOfitbELwaNuQwIalCBry3M2R2xylK0nkMgG6LWDw1PIGmFSGzKJdR4b2UTax1bFsEjAVxdbSQySPpM1RfCDSkcUH9n7KnhZ3hNs83A9eb+8j44FQ9tT3ee5rjcGe+3p/AJBNd4yxLfDJAAAAAElFTkSuQmCC","sizes":"(max-width: 2560px) 100vw, 2560px","src":"/static/2f584bd5b14ca2a9732f1798c9d9e0e2/a76e0/after-infra-structure.png","srcSet":"/static/2f584bd5b14ca2a9732f1798c9d9e0e2/3a443/after-infra-structure.png 930w,\n/static/2f584bd5b14ca2a9732f1798c9d9e0e2/4d929/after-infra-structure.png 1860w,\n/static/2f584bd5b14ca2a9732f1798c9d9e0e2/a76e0/after-infra-structure.png 2560w"}}},"author":[{"id":"4기_잉","bio":"우아한테크코스 4기 잉(유영우)입니다 :)","avatar":{"children":[{"fluid":{"aspectRatio":1,"base64":"data:image/jpeg;base64,/9j/2wBDAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/2wBDAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/wgARCAAUABQDASIAAhEBAxEB/8QAGAABAQEBAQAAAAAAAAAAAAAAAAgHBQn/xAAYAQACAwAAAAAAAAAAAAAAAAACBQMEBv/aAAwDAQACEAMQAAAB7ekRXQ+cbX0wkJ+N9DiqDQQ0v//EABkQAAMBAQEAAAAAAAAAAAAAAAMEBQIGAf/aAAgBAQABBQK1XQk45Dp4t4AHs+j6mmvTjQm1MRl6g9C545TAhiwqoSs8Pf8A/8QAIxEAAgIBAwMFAAAAAAAAAAAAAQIDBBEAEiEFFFEVIzFB8P/aAAgBAwEBPwGt02xWq2+7kSG3SmjD0so822RkTe5jkKoqFlBHLbjtZVyM5Pg66gT6rcP2b1jJ8++3zpScDn9xr//EACQRAAIBAwIGAwAAAAAAAAAAAAECEQMEIQASBRMiQVJxkdHw/9oACAECAQE/AavELa4q0BbHnUq6sBcCVpgqpcIFZQzFgGM4G0SN2YgeX741b9ItgMCbYQMCNq49aIEnHf61/8QAKBAAAgIBBAECBgMAAAAAAAAAAQIDBBEABRIhEyMxBhQiMjNBQmFx/9oACAEBAAY/Am3DcrC1qkA9SVgzYaV4441AUFizuQAAP9wM6NjabsdpYJPHOmHjnryfpZoJQsicsEo2ODgZRj3od41uCvRO7VMxRy+D8cZRknM8f85XrAB8JjBI7OCuvh/fq6V4K2+UzHWgjWNLgh2pvlAbIjqwZVOo43d53JB5PyzpTk6vFpG9G1DAgB+nx2GAfKnIJH3Kf03vnrQEOR45rUQ7PtBZQKeOeCs3lbnwVQcDoaKJNhV9uv61/8QAHRABAQACAgMBAAAAAAAAAAAAAREAITFhQVFxgf/aAAgBAQABPyEIvAY5EHosVQIEGS+isZ5A1ASEj8H4esI7XaX5FY3rkLguQKloWbtpuiSofT8OsP0rsQpZjheSYAYquXupIBReow18kgDoa725/9oADAMBAAIAAwAAABDMP0L/xAAgEQEAAQMDBQAAAAAAAAAAAAABABEhMUFRYXGBkbHw/9oACAEDAQE/EHm4g7UwpnTJFYEBb1HPTjj3uRCFaiKu5N3vMzYNX7l8s//EAB8RAQABBAIDAQAAAAAAAAAAAAERACExQVFxgZGh0f/aAAgBAgEBPxBPDjQNEjgZ0gKMrIztTZosx35ivl9kNhBYtoi7y0iYPQ5/b7r/xAAcEAEBAAMAAwEAAAAAAAAAAAABEQAhMUFRcdH/2gAIAQEAAT8QfVfGQfdEtsRspckgCtudJU1gYOELrYUwtlV18xt+FA9j/wAzrDw9qxERdNgoTeCCzakR4RSd9/rujfEUzD7ixLK96Ef9WgrOdQWY6ik8oToVr8PGf//Z","sizes":"(max-width: 800px) 100vw, 800px","src":"/static/321f2fb3f306933bfd7ee26a44327f82/2f1b1/ing.jpg","srcSet":"/static/321f2fb3f306933bfd7ee26a44327f82/fd013/ing.jpg 200w,\n/static/321f2fb3f306933bfd7ee26a44327f82/25252/ing.jpg 400w,\n/static/321f2fb3f306933bfd7ee26a44327f82/2f1b1/ing.jpg 800w,\n/static/321f2fb3f306933bfd7ee26a44327f82/0ff54/ing.jpg 1200w,\n/static/321f2fb3f306933bfd7ee26a44327f82/06655/ing.jpg 1600w,\n/static/321f2fb3f306933bfd7ee26a44327f82/7403c/ing.jpg 2316w"}}]}}]},"fields":{"layout":"post","slug":"/post/2022-11-01-blue-green-deployment/"}},"next":{"excerpt":"what is the difference between interface and type alias? typescript…","timeToRead":3,"frontmatter":{"title":"interface vs type alias","tags":["typescript","interface","type"],"date":"2022-11-07T13:10:00.000Z","draft":false,"excerpt":null,"image":null,"author":[{"id":"4기_앨버","bio":"우아한테크코스 4기 앨버(송상민)입니다 :)","avatar":{"children":[{"fluid":{"aspectRatio":1,"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAIAAAAC64paAAAACXBIWXMAAAsTAAALEwEAmpwYAAAEvklEQVQ4yzXRW0xTdwDH8X8LtD2n55z2tD1tD5zer7S09EpppbSllV6gUJBOQK1cLGV0yADBy1YBRYlRcahz6jROCVFjvIxtKko2jS4a3eJmFjdN3MO2Bx+WGbMZzXzo1GS/p9/L5+kLinhKOoMNAGCyUZaqgo5QNBqLRisCBRhDZMZkFjL0HmpOMlVBhLLAHBGbXyKq6UX1UZg0ADoTfSO5FCNzkp35Ut45Q7RsZlnjhbiKzlZwZBYiNmj2pILWmsJiC8KXcGR6cmkWUQcRqf01BDiKHJj7Kj5+afHGj8/z+alvnzIO/MUbu1UgDXBLjLBnzXjT6omGJOBrmIUMkSsmCA6zZX7hkqa3mMd/9POv+Vcv/33xPP/0yeGT14FrkuFYx3SvQ/wtRCR9ZeH2H4+fJNZ+QAYapMn9aONRjrNNHOp6gxEYunjz3sO/8y9evMzn80eOnwfAWoAFGVVjzMxmYd+GKzunf5g5VJ6bTh48Fcwehrxjwt5xPLMeAFoBHQCuvQlv+MhVmw0nBjTl7wCkGvDqGcYMuW9u5cSO304mnt2KjM6NUHtmNbnd3PppbuossXYK/L9CAOhvD0RjldKpFoAnmIrl8e/ufzG55dXdpl++D8/PJWsvLpoWb2h2H+e0X0W77gJYrIaESlTphAQSTFaGFutYfMnrEohhGVsd9g592JPqX/NuZFX30ta4y9mR1g1usE3MENEh2LMJENaYwBQS+1KELUo46gh7HULpeHo3V22DOBwWV4GFBpilKyBJgC6yFzJwCOYRVT2I0g8LZAAv9WIyI0fjRkglV2HhBXJoWRwVlrCFUoQq5Smt/PBAs395V6UPCLQoLhaUOcmlfWx1iGMMAkxu5mor0WK1yFpbYvAuq85InCm61IqWxRCxElM6sMqOE7ntZ3bskVt9RQhHGOzFozsQRYj0twFctwQ3VHP1HtQQQmMfuxuP8ZpmE4F1erWngCeAm9PEivevLt578vBZYvKAa2DM3DHLju3jx7NEYxaQvhXsEu3UvrmLV69Nzz8Qrf9dkrr2yOLr4OCgWIH2T+hGx29Ndj+Y7q6c3Bo+ctY3NANXTQiz07zBDwEVSbM1bk8yPdy/aWF0K9F6tMc/9KdMNSgoYaiM5ecub9u+859rzc8eR47N90kOnpbtPSrs3I+0fs3PfAYkodUOX5Tt7kUqc0HKAghVKhqbT6ftxiiqNbZ+c/PMxg0/zUfPz4UObQu3nPvcvnDd+umsoO0E3HYDiJ31piURaXSQcCYE1ctxrUuk1skCLZCxBqNUilBKa6hQmHV6h01vqSAdIXF1A+UO4EYvLHMAvinEkpazVG4gLqOJDXBpDbcshilsmEQH8UmWpKIIFyGUEaZMkMzBUXu4UgsQqFhiLczFgbwiMrltV27r1MjQcG9PxmSpldbvZxerMYLEVE5E7oT5QkhmKuDLAS7VV7ZYk3tXWiJSUskQFAOpuerC5dunzy18curu6Ut3YpFhW2gX09YOOzsRjb9QpNNQ8jpfc3P32pr6VU3WuKN25LCnzmMI0F/n4FvCdLGeV+rVNG6WenotI/ddG+/Bq++MevuUBAmoirjdeiHX1b9xS7w9i6urOtWmTl87pKuBMOw/ZLlKL1MTz1UAAAAASUVORK5CYII=","sizes":"(max-width: 460px) 100vw, 460px","src":"/static/d02da977d5a68a2002191769b580652c/84afe/albur.png","srcSet":"/static/d02da977d5a68a2002191769b580652c/8ac63/albur.png 200w,\n/static/d02da977d5a68a2002191769b580652c/3891b/albur.png 400w,\n/static/d02da977d5a68a2002191769b580652c/84afe/albur.png 460w"}}]}}]},"fields":{"layout":"post","slug":"/post/2022-11-07-typeAlias-interface/"}},"primaryTag":"Transaction"}},"staticQueryHashes":["2130001345","4041952199"]}