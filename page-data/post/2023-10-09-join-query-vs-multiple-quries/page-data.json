{"componentChunkName":"component---src-templates-post-tsx","path":"/post/2023-10-09-join-query-vs-multiple-quries/","result":{"data":{"logo":{"childImageSharp":{"gatsbyImageData":{"layout":"fixed","backgroundColor":"#080808","images":{"fallback":{"src":"/static/0b18bd94a62a12fdc81ea720c28722f6/a9770/tecoble.png","srcSet":"/static/0b18bd94a62a12fdc81ea720c28722f6/a9770/tecoble.png 400w","sizes":"400px"},"sources":[{"srcSet":"/static/0b18bd94a62a12fdc81ea720c28722f6/65935/tecoble.webp 400w","type":"image/webp","sizes":"400px"}]},"width":500,"height":110}}},"markdownRemark":{"html":"<p>최근에 프로젝트에서 리팩토링과 동시에 쿼리 개선을 하고 있는데요. 조인 한 방 쿼리로 <strong>한 번에 끝내는 게 여러 번 네트워크 타는 것보다 좋을 것</strong> 같아서 한 방 쿼리로 수정하고 있다가 다음과 같이 모든 쿼리가 조인이 덕지 덕지 붙어있는 코드를 보고 뭔가 이상함을 감지했습니다.</p>\n<p>​</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">select</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">from</span> pet_food p1_0\n<span class=\"token keyword\">join</span> brand b1_0 <span class=\"token keyword\">on</span> b1_0<span class=\"token punctuation\">.</span>id<span class=\"token operator\">=</span>p1_0<span class=\"token punctuation\">.</span>brand_id\n<span class=\"token keyword\">join</span> pet_food_primary_ingredient p2_0 <span class=\"token keyword\">on</span> p1_0<span class=\"token punctuation\">.</span>id<span class=\"token operator\">=</span>p2_0<span class=\"token punctuation\">.</span>pet_food_id\n<span class=\"token keyword\">join</span> primary_ingredient p3_0 <span class=\"token keyword\">on</span> p3_0<span class=\"token punctuation\">.</span>id<span class=\"token operator\">=</span>p2_0<span class=\"token punctuation\">.</span>primary_ingredient_id\n<span class=\"token keyword\">where</span> p1_0<span class=\"token punctuation\">.</span>id<span class=\"token operator\">=</span><span class=\"token number\">1</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">select</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">from</span> review r1_0\n<span class=\"token keyword\">join</span> pet p1_0 <span class=\"token keyword\">on</span> p1_0<span class=\"token punctuation\">.</span>id<span class=\"token operator\">=</span>r1_0<span class=\"token punctuation\">.</span>pet_id\n<span class=\"token keyword\">join</span> breed b1_0 <span class=\"token keyword\">on</span> b1_0<span class=\"token punctuation\">.</span>id<span class=\"token operator\">=</span>p1_0<span class=\"token punctuation\">.</span>breed_id\n<span class=\"token keyword\">join</span> pet_size p2_0 <span class=\"token keyword\">on</span> p2_0<span class=\"token punctuation\">.</span>id<span class=\"token operator\">=</span>b1_0<span class=\"token punctuation\">.</span>pet_size_id\n<span class=\"token keyword\">left</span> <span class=\"token keyword\">join</span> helpful_reaction h1_0 <span class=\"token keyword\">on</span> r1_0<span class=\"token punctuation\">.</span>id<span class=\"token operator\">=</span>h1_0<span class=\"token punctuation\">.</span>review_id\n<span class=\"token keyword\">join</span> adverse_reaction a1_0 <span class=\"token keyword\">on</span> r1_0<span class=\"token punctuation\">.</span>id<span class=\"token operator\">=</span>a1_0<span class=\"token punctuation\">.</span>review_id\n<span class=\"token keyword\">where</span> r1_0<span class=\"token punctuation\">.</span>id<span class=\"token operator\">=</span>?</code></pre></div>\n<p>​</p>\n<p><code class=\"language-text\">뭔가 아닌 거 같은데..?</code> 물론 한 방 쿼리가 좋을 때도 있지만 항상 한 방 쿼리가 좋진 않을 것인데 <strong>언제 한 방 쿼리를 사용하고 언제 여러 개 쿼리를 사용</strong>할 수 있을지 궁금증이 생겼습니다.\n​</p>\n<hr>\n<p>​</p>\n<h2>조인(Join)으로 한 방 쿼리 vs 쿼리 여러 개</h2>\n<p>​</p>\n<blockquote>\n<p>No Silver Bullet - 만병통치약은 없다.</p>\n</blockquote>\n<p>​</p>\n<p><strong>어떤 성능 시나리오에서든 어느 솔루션이 더 빠른지 확인하기 위해 직접 솔루션을 테스트하고 측정해야 합니다.</strong> 즉, 최선의 경우는 없는데요. 하지만, 일반적으로 어떤 상황에서 쓰면 좋을지는 통계가 있을 것입니다. 테이블 관계를 기준으로 한번 살펴봅시다.\n​</p>\n<h3>일대일 관계</h3>\n<p>​\n일반적으로 일대일 관계 같은 <strong>많은 외부 레코드를 가리키지 않는 경우</strong> 다음과 같은 성능을 나타냅니다.</p>\n<p>​\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1290px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/636920497aec5a6398404e4910dc0c52/629d2/2023-10-09-join-vs-multiple-performance_graph.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 44.4%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAABFUlEQVR42o2R227EMAhE8//fWfWhD+0mvoKB6dhJq652VyrSyITEZ4BsYMRUTMXSs3heZd0MJVfk2lBbx2bmkN7hqnDeuhPfhZ8mvs5HeskJb+8fSISaO7b9KJDWgLzDjxu8JITIMpj3fuBkn7mf8GnmBOgIdBl858uAwIxcOoQFY/tsl/B0igZLNAwVYGqMtZ94sYbtRmApisSOcgwcPpDC1pmVRkPR2XU7vtATtX8u+f4FpOMBuzosiTusc6SA8QO/fs5gXmlSaVDgqFN8LiZI1pF5PnQIXCANSA3opcHJfU43pX901Wyc0z8H+rnQCVa1lQ9xtGI04lobOytj5b3ab33mdt29A74K4V5vR1oSUfwnvgF5M8X8Pq0OWwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"2023 10 09 join vs multiple performance graph\"\n        title=\"\"\n        src=\"/static/636920497aec5a6398404e4910dc0c52/629d2/2023-10-09-join-vs-multiple-performance_graph.png\"\n        srcset=\"/static/636920497aec5a6398404e4910dc0c52/0eb09/2023-10-09-join-vs-multiple-performance_graph.png 500w,\n/static/636920497aec5a6398404e4910dc0c52/1263b/2023-10-09-join-vs-multiple-performance_graph.png 1000w,\n/static/636920497aec5a6398404e4910dc0c52/629d2/2023-10-09-join-vs-multiple-performance_graph.png 1290w\"\n        sizes=\"(max-width: 1290px) 100vw, 1290px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>​\n조인이 가장 빠른데 그 이유는 여러 개 쿼리가 발생하면 데이터베이스에 대한 각 쿼리에 <strong>고정 비용</strong>이 발생하기 때문입니다. 일대일 관계 같은 경우 중복도 발생하지 않아서 부담 없이 조인을 사용할 수 있을 것 같습니다.</p>\n<p>​\n그렇다고 해서, 일대다 관계에서는 절대 조인을 쓰지 말란 것이 아닙니다. 위에서 말한 것에 핵심 포인트는 일대일 관계뿐 아니라 일대다 관계에서도 많은 외부 레코드를 가리키지 않는 경우입니다. 한 방 조인으로 결괏값 주기 vs 여러 번 통신 + 애플리케이션에서 조합의 <strong>트레이드오프</strong>를 잘 고려해 봐야 됩니다.\n​</p>\n<h3>일대다 관계</h3>\n<p>​\n하지만, 참조된 레코드 중 다수가 동일할 수 있는 <strong>일대다 관계</strong> 같은 경우 조인 시에 중복이 엄청나게 발생할 수 있으니 잘 생각해 봐야 됩니다.\n​</p>\n<p>예를 들어봅시다.\n​</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 670px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/05f9ff9efd6579a443ab577404f3c5d3/6bbca/2023-10-09-join-vs-multiple-entities.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 23.2%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA0klEQVR42jWQx66EUAxD+f9/A4QQGzZvJMqjiN6bPHMisbBubhI7cZzzPDWOo9q21bqu2rZNx3Houi5RA/d92x8QU5+m2WK4YN93Lcsip65rhWEoz/N+TZPmeTbRYRgNxH+fj5EgUIec5/9qmkZpmgoNcl3XyfF9X67rKkkSI/R9r7IslWWZ4jhWEAQ/cm7CiEGuqkpRFFkNHmIsg0sHMkLP85gFLPJno6IobAuaAblhGEycPOBM8OCbZZpIMv219N6NydyLFyBEjVu+J3g3J2boF24jfcR905RtAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"2023 10 09 join vs multiple entities\"\n        title=\"\"\n        src=\"/static/05f9ff9efd6579a443ab577404f3c5d3/6bbca/2023-10-09-join-vs-multiple-entities.png\"\n        srcset=\"/static/05f9ff9efd6579a443ab577404f3c5d3/0eb09/2023-10-09-join-vs-multiple-entities.png 500w,\n/static/05f9ff9efd6579a443ab577404f3c5d3/6bbca/2023-10-09-join-vs-multiple-entities.png 670w\"\n        sizes=\"(max-width: 670px) 100vw, 670px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n​</p>\n<p>위와 같은 관계에서 1개의 게시물이 있고 게시물에는 2개의 댓글과 2개의 태그가 있다고 가정해 봅시다.</p>\n<p>​</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> post<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">,</span> <span class=\"token keyword\">comment</span><span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">,</span> tag<span class=\"token punctuation\">.</span>id\n<span class=\"token keyword\">FROM</span> post\n<span class=\"token keyword\">LEFT</span> <span class=\"token keyword\">JOIN</span> <span class=\"token keyword\">comment</span> <span class=\"token keyword\">on</span> post<span class=\"token punctuation\">.</span>id <span class=\"token operator\">=</span> <span class=\"token keyword\">comment</span><span class=\"token punctuation\">.</span>post_id\n<span class=\"token keyword\">LEFT</span> <span class=\"token keyword\">JOIN</span> tag <span class=\"token keyword\">on</span> tag<span class=\"token punctuation\">.</span>post_id <span class=\"token operator\">=</span> post<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">;</span>\n​\n<span class=\"token comment\">-- post_id comment_id tag_id</span>\n<span class=\"token comment\">-- 1        1           1</span>\n<span class=\"token comment\">-- 1        1           2</span>\n<span class=\"token comment\">-- 1        2           1</span>\n<span class=\"token comment\">-- 1        2           2</span></code></pre></div>\n<p>​</p>\n<p>위와 같은 쿼리를 실행하면 2 * 2로 4개의 결과가 나왔습니다. 여기서 댓글과 태그가 4개로 늘어난다면 어떻게 될까요?</p>\n<p>​</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> post<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">,</span> <span class=\"token keyword\">comment</span><span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">,</span> tag<span class=\"token punctuation\">.</span>id\n<span class=\"token keyword\">FROM</span> post\n<span class=\"token keyword\">LEFT</span> <span class=\"token keyword\">JOIN</span> <span class=\"token keyword\">comment</span> <span class=\"token keyword\">on</span> post<span class=\"token punctuation\">.</span>id <span class=\"token operator\">=</span> <span class=\"token keyword\">comment</span><span class=\"token punctuation\">.</span>post_id\n<span class=\"token keyword\">LEFT</span> <span class=\"token keyword\">JOIN</span> tag <span class=\"token keyword\">on</span> tag<span class=\"token punctuation\">.</span>post_id <span class=\"token operator\">=</span> post<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">;</span>\n​\n<span class=\"token comment\">-- post_id comment_id tag_id</span>\n<span class=\"token comment\">-- 1        1           1</span>\n<span class=\"token comment\">-- 1        1           2</span>\n<span class=\"token comment\">-- 1        1           3</span>\n<span class=\"token comment\">-- 1        1           4</span>\n<span class=\"token comment\">-- 1        2           1</span>\n<span class=\"token comment\">-- 1        2           2</span>\n<span class=\"token comment\">-- 1        2           3</span>\n<span class=\"token comment\">-- 1        2           4</span>\n<span class=\"token comment\">-- 1        3           1</span>\n<span class=\"token comment\">-- 1        3           2</span>\n<span class=\"token comment\">-- 1        3           3</span>\n<span class=\"token comment\">-- 1        3           4</span>\n<span class=\"token comment\">-- 1        4           1</span>\n<span class=\"token comment\">-- 1        4           2</span>\n<span class=\"token comment\">-- 1        4           3</span>\n<span class=\"token comment\">-- 1        4           4</span></code></pre></div>\n<p>​</p>\n<p>각 행의 곱인 4 * 4 = 16개의 행이 나오게 됩니다. 그럼 만약에 각 데이터의 수가 1000개씩만 되어도 나오는 행의 수는 몇 개일까요..? 여기서 더 <strong>많은 테이블과 레코드들을 추가하면 수많은 중복된 데이터가 생겨날 것입니다.</strong>\n​\n실제 테스트를 해봅시다. 실험 환경은 다음과 같습니다.</p>\n<ul>\n<li>Mac M1 Pro 16G 512GB</li>\n<li>실험 데이터 수는 게시글 1개, 댓글 1000개, 태그 1000개</li>\n</ul>\n<p>​</p>\n<p>먼저 조인을 이용하여 100만(1000 * 1000)개의 테이블을 생성해 결괏값 100만 개를 내어줄 때는 <strong>12초</strong>가 걸렸습니다.\n​</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1178px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/486af2325274fb1cefcf08eddda9bfcf/dc992/2023-10-09-join-vs-multiple-log1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 13.799999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAhElEQVR42lWPWQ7DIAxEOQqhbAbCJvWzau5/qSmDlEr5eDJj7BlQJQmiCEIIkJRgg0eShBgjjuN4oLXe3JozxOaId7D4iIO6ri/GGDjPE713tNZQa8WcEznnXdMKKqXsUGKMebLMWV8LxQQOc4lmNKFmAO+oaXK/RtZvvPdwzv37PLNHfnXVWAk+DfHqAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"2023 10 09 join vs multiple log1\"\n        title=\"\"\n        src=\"/static/486af2325274fb1cefcf08eddda9bfcf/dc992/2023-10-09-join-vs-multiple-log1.png\"\n        srcset=\"/static/486af2325274fb1cefcf08eddda9bfcf/0eb09/2023-10-09-join-vs-multiple-log1.png 500w,\n/static/486af2325274fb1cefcf08eddda9bfcf/1263b/2023-10-09-join-vs-multiple-log1.png 1000w,\n/static/486af2325274fb1cefcf08eddda9bfcf/dc992/2023-10-09-join-vs-multiple-log1.png 1178w\"\n        sizes=\"(max-width: 1178px) 100vw, 1178px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>​\n하지만, 두 개의 쿼리(1000 + 1000)로 분리하여 결괏값 100만 개를 내어 줄 때는 고작 <strong>0.2초</strong>밖에 안 걸린 걸 볼 수 있습니다.</p>\n<p>​\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1106px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/9b5589e00f115d68ff951eddf98972d2/22593/2023-10-09-join-vs-multiple-log2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 12.200000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAb0lEQVR42jWOWwrFIAxEuxMVjRrrExWE7n9dc6+WfoQzyXycXM/syDnDOQdmhmMHzx4hBGitQUSHe6SUUEpBCPF2xkCRwU0aUysskrjmGFhroZSC1hrGf08pofdXtFlrPbcY45F6788DW7bzR2stfoOAO16wQs4yAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"2023 10 09 join vs multiple log2\"\n        title=\"\"\n        src=\"/static/9b5589e00f115d68ff951eddf98972d2/22593/2023-10-09-join-vs-multiple-log2.png\"\n        srcset=\"/static/9b5589e00f115d68ff951eddf98972d2/0eb09/2023-10-09-join-vs-multiple-log2.png 500w,\n/static/9b5589e00f115d68ff951eddf98972d2/1263b/2023-10-09-join-vs-multiple-log2.png 1000w,\n/static/9b5589e00f115d68ff951eddf98972d2/22593/2023-10-09-join-vs-multiple-log2.png 1106w\"\n        sizes=\"(max-width: 1106px) 100vw, 1106px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n​\n​\n여러 개의 테이블을 조인하는 경우도 아래의 벤치마크를 한번 봅시다. 두 경우 모두 동일한 결과(6 x 50 x 7 x 12 x 90 = 2268000)를 얻지만 여러 개의 쿼리가 훨씬 더 빠릅니다.\n​</p>\n<ol>\n<li>\n<p><strong>5개의 조인을 사용한 단일 쿼리</strong></p>\n<p>쿼리: <strong>8.074508초</strong></p>\n<p>결과 크기: 2268000</p>\n</li>\n<li>\n<p><strong>연속 쿼리 5개</strong></p>\n<p>결합된 쿼리 시간: <strong>0.00262초</strong></p>\n<p>결과 크기: 165(6 + 50 + 7 + 12 + 90)</p>\n</li>\n</ol>\n<p>​</p>\n<p>또한, 중복 데이터로 인해 더 많은 <strong>메모리</strong>를 사용합니다. 적은 테이블의 수를 조인하는 경우 메모리 사용량이 적겠지만, 테이블이 점점 늘어날수록 차지하는 메모리가 기하급수적으로 늘기 때문에 잘 고려하면 좋을 것 같습니다.</p>\n<p>​</p>\n<h3>조인이 적합한 지 여부 판단</h3>\n<p>​\n조인을 사용해야 하는지는 조인이 <strong>적합한지</strong>에 따라 판단해 볼 수도 있습니다. 위의 예시로 사용한 테이블에서 댓글과 태그는 게시글과는 관련이 있지만 서로는 관련이 없습니다. 이 경우 두 개의 별도 쿼리를 사용하는 것이 더 좋습니다. 태그와 댓글을 결합하려고 하면 둘 사이에는 직접적인 관계가 없는데도 각 테이블행의 곱만큼 가능한 모든 조합이 생성됩니다. 또한, 두 쿼리를 병렬로 수행하여 이득을 얻을 수도 있습니다.</p>\n<p>​\n하지만, 여기서 만약에 다음과 같은 상황을 생각해 봅시다.</p>\n<p>​\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 697px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/665449e94bd3520f9c11844f6017733e/11663/2023-10-09-join-vs-multiple-entities-modified.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 27.200000000000003%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAyElEQVR42lWQWYqFQAxFa/8bcweiIIgoiji1cznexwn40cI1IcNJUs57r/u+dZ6n9n03exyHxaZpMr/rOhP+tm16nuef3vc14bu6rlVVldI0VVmWWtdVfd9bQVEUSpJEQRAoDEPLjeNo4OFvlPe78jy3wcuy2EKuaRrFcawsy2w6YhuKiAEEDIxc27Ym4lEU2TKA5nk2qOMHFPudS5KTsWyL5eMkoADoIccgRA3WUQCMt/w2RJzMecMwWP5rxAfMYHqAI/zruvQDh79/H32fya4AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"2023 10 09 join vs multiple entities modified\"\n        title=\"\"\n        src=\"/static/665449e94bd3520f9c11844f6017733e/11663/2023-10-09-join-vs-multiple-entities-modified.png\"\n        srcset=\"/static/665449e94bd3520f9c11844f6017733e/0eb09/2023-10-09-join-vs-multiple-entities-modified.png 500w,\n/static/665449e94bd3520f9c11844f6017733e/11663/2023-10-09-join-vs-multiple-entities-modified.png 697w\"\n        sizes=\"(max-width: 697px) 100vw, 697px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>​\n게시물에 댓글을 달고 댓글 작성자의 이름까지 원한다면? 조인을 고려해 볼 수 있습니다. 훨씬 더 자연스러운 쿼리일 뿐 아니라 데이터베이스 시스템에서 이와 같은 쿼리를 <a href=\"https://dev.mysql.com/doc/refman/8.0/en/optimization.html\">최적화</a>하려고 노력하고 있다고 합니다.</p>\n<p>​</p>\n<h2>서브쿼리(SubQuery)</h2>\n<p>​</p>\n<p>조인 대신에 <strong>서브 쿼리</strong>를 이용하는 방법도 있습니다. 서브 쿼리와 조인의 성능을 비교해 봅시다. 우선 MySQL <strong>5.5</strong> 버전에서 서브 쿼리는 못쓸 정도라고 평할 정도로 제대로 수행되지 않았습니다.</p>\n<p>​\n테스트 데이터</p>\n<ul>\n<li>메인 테이블 100만 건</li>\n<li>서브 테이블1 (Index O) 1000건</li>\n<li>서브 테이블2 (Index X) 1000건</li>\n</ul>\n<p>​\n수행 시간</p>\n<ul>\n<li>MySQL 5.5 + 서브 쿼리 + No Index에서 100만 건 &#x26; 1천 건 조회에 <strong>3분</strong>이 소요</li>\n<li>MySQL 5.5 + 서브 쿼리 + Index에서 100만 건 &#x26; 1천 건 조회에 <strong>1.8초</strong> 소요</li>\n<li>MySQL 5.5 + 조인 + No Index에서 100만 건 &#x26; 1천 건 조회에 <strong>11초</strong> 소요</li>\n<li>MySQL 5.5 + 조인 + Index에서 100만 건 &#x26; 1천 건 조회에 <strong>0.139초</strong> 소요</li>\n</ul>\n<p>​\nMySQL 특정 버전(5.5이하)에서는 서브 쿼리 대신 조인이 압도적으로 빠른 것을 볼 수 있습니다.</p>\n<p>MySQL에서는 무슨 일이 있었기에 5.5 버전에서는 서브 쿼리 성능이 좋지 않을까요?</p>\n<ol>\n<li>최적화 부재: 초기 버전의 MySQL에서는 서브 쿼리에 대한 충분한 최적화가 이루어지지 않았습니다. 그 결과 서브 쿼리는 복잡한 연산을 필요로 하는 경우에 매우 비효율적으로 동작하게 되었습니다.</li>\n<li>재귀적 처리: MySQL 5.5에서 서브 쿼리는 종종 재귀적으로 처리되었고, 이는 성능 문제를 야기했습니다. 특히, 상위 쿼리에서 서브 쿼리의 결과를 여러 번 재참조해야 할 때 이 문제가 두드러졌습니다.</li>\n</ol>\n<p><strong>5.6</strong>에서는 <strong>서브 쿼리 성능 개선</strong>이 많이 이루어졌습니다.\n​</p>\n<p>수행 시간</p>\n<ul>\n<li>MySQL 5.6 + 서브 쿼리 + No Index에서 100만 건 &#x26; 1천 건 조회에 <strong>19초</strong> 소요</li>\n<li>MySQL 5.6 + 서브 쿼리 + Index에서 100만 건 &#x26; 1천 건 조회에 <strong>0.18초</strong> 소요</li>\n</ul>\n<p>​</p>\n<p>3분에서 19초, 11초에서 0.18초 개선될 정도로 5.6에서는 최적화가 이루어졌지만 아직 <strong>모든 서브 쿼리가 다 최적화가 된 것은 아니라고 합니다.</strong></p>\n<p>​\n즉, 웬만하면 <strong>최대한 조인을 이용</strong>하고 조인을 이용하기 어렵다면 5.6 이상은 서브 쿼리를 사용합니다. 5.5 이하는 절대 사용하지 않고 차라리 쿼리를 나눠서 2번(메인 쿼리, 서브 쿼리) 실행하고 애플리케이션에서 조립하면 좋을 것 같습니다. 물론, 스칼라 서브 쿼리 캐싱 등의 최적화 기술로 때때로 서브 쿼리가 조인보다 더 효율적일 때도 있습니다.</p>\n<p>​</p>\n<h2>결론</h2>\n<p>​</p>\n<p>사실 위의 내용은 어느 정도 통계에 기반에서 이렇다 할 뿐이지 자신의 상황에서는 전혀 다르게 동작(고려해야 할 변수가 많기 때문에)할 수도 있습니다. 그러므로 <strong>참고만 하고</strong> EXPLAIN 같은 실행 계획이나 <strong>직접 테스트하여 측정해 사용</strong>하도록 합시다.</p>\n<p>​</p>\n<blockquote>\n<p>Don’t guess, measure!</p>\n</blockquote>\n<h2>​</h2>\n<p>참고:</p>\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/1067016/join-queries-vs-multiple-queries\">JOIN queries vs multiple queries</a></li>\n<li><a href=\"https://jojoldu.tistory.com/520\">MySQL where in (서브쿼리) vs 조인 조회 성능 비교 (5.5 vs 5.6)</a></li>\n</ul>","htmlAst":{"type":"root","children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"최근에 프로젝트에서 리팩토링과 동시에 쿼리 개선을 하고 있는데요. 조인 한 방 쿼리로 "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"한 번에 끝내는 게 여러 번 네트워크 타는 것보다 좋을 것"}]},{"type":"text","value":" 같아서 한 방 쿼리로 수정하고 있다가 다음과 같이 모든 쿼리가 조인이 덕지 덕지 붙어있는 코드를 보고 뭔가 이상함을 감지했습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"​"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"sql"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-sql"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-sql"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"select"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"*"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"from"}]},{"type":"text","value":" pet_food p1_0\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"join"}]},{"type":"text","value":" brand b1_0 "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"on"}]},{"type":"text","value":" b1_0"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"id"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"text","value":"p1_0"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"brand_id\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"join"}]},{"type":"text","value":" pet_food_primary_ingredient p2_0 "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"on"}]},{"type":"text","value":" p1_0"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"id"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"text","value":"p2_0"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"pet_food_id\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"join"}]},{"type":"text","value":" primary_ingredient p3_0 "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"on"}]},{"type":"text","value":" p3_0"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"id"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"text","value":"p2_0"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"primary_ingredient_id\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"where"}]},{"type":"text","value":" p1_0"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"id"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"1"}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"sql"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-sql"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-sql"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"select"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"*"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"from"}]},{"type":"text","value":" review r1_0\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"join"}]},{"type":"text","value":" pet p1_0 "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"on"}]},{"type":"text","value":" p1_0"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"id"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"text","value":"r1_0"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"pet_id\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"join"}]},{"type":"text","value":" breed b1_0 "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"on"}]},{"type":"text","value":" b1_0"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"id"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"text","value":"p1_0"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"breed_id\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"join"}]},{"type":"text","value":" pet_size p2_0 "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"on"}]},{"type":"text","value":" p2_0"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"id"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"text","value":"b1_0"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"pet_size_id\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"left"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"join"}]},{"type":"text","value":" helpful_reaction h1_0 "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"on"}]},{"type":"text","value":" r1_0"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"id"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"text","value":"h1_0"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"review_id\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"join"}]},{"type":"text","value":" adverse_reaction a1_0 "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"on"}]},{"type":"text","value":" r1_0"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"id"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"text","value":"a1_0"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"review_id\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"where"}]},{"type":"text","value":" r1_0"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"id"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"text","value":"?"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"​"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"뭔가 아닌 거 같은데..?"}]},{"type":"text","value":" 물론 한 방 쿼리가 좋을 때도 있지만 항상 한 방 쿼리가 좋진 않을 것인데 "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"언제 한 방 쿼리를 사용하고 언제 여러 개 쿼리를 사용"}]},{"type":"text","value":"할 수 있을지 궁금증이 생겼습니다.\n​"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"hr","properties":{},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"​"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"조인(Join)으로 한 방 쿼리 vs 쿼리 여러 개"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"​"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"blockquote","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"No Silver Bullet - 만병통치약은 없다."}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"​"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"어떤 성능 시나리오에서든 어느 솔루션이 더 빠른지 확인하기 위해 직접 솔루션을 테스트하고 측정해야 합니다."}]},{"type":"text","value":" 즉, 최선의 경우는 없는데요. 하지만, 일반적으로 어떤 상황에서 쓰면 좋을지는 통계가 있을 것입니다. 테이블 관계를 기준으로 한번 살펴봅시다.\n​"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"일대일 관계"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"​\n일반적으로 일대일 관계 같은 "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"많은 외부 레코드를 가리키지 않는 경우"}]},{"type":"text","value":" 다음과 같은 성능을 나타냅니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"​\n"},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1290px; "},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/636920497aec5a6398404e4910dc0c52/629d2/2023-10-09-join-vs-multiple-performance_graph.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 44.4%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAABFUlEQVR42o2R227EMAhE8//fWfWhD+0mvoKB6dhJq652VyrSyITEZ4BsYMRUTMXSs3heZd0MJVfk2lBbx2bmkN7hqnDeuhPfhZ8mvs5HeskJb+8fSISaO7b9KJDWgLzDjxu8JITIMpj3fuBkn7mf8GnmBOgIdBl858uAwIxcOoQFY/tsl/B0igZLNAwVYGqMtZ94sYbtRmApisSOcgwcPpDC1pmVRkPR2XU7vtATtX8u+f4FpOMBuzosiTusc6SA8QO/fs5gXmlSaVDgqFN8LiZI1pF5PnQIXCANSA3opcHJfU43pX901Wyc0z8H+rnQCVa1lQ9xtGI04lobOytj5b3ab33mdt29A74K4V5vR1oSUfwnvgF5M8X8Pq0OWwAAAABJRU5ErkJggg=='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"2023 10 09 join vs multiple performance graph","title":"","src":"/static/636920497aec5a6398404e4910dc0c52/629d2/2023-10-09-join-vs-multiple-performance_graph.png","srcSet":["/static/636920497aec5a6398404e4910dc0c52/0eb09/2023-10-09-join-vs-multiple-performance_graph.png 500w","/static/636920497aec5a6398404e4910dc0c52/1263b/2023-10-09-join-vs-multiple-performance_graph.png 1000w","/static/636920497aec5a6398404e4910dc0c52/629d2/2023-10-09-join-vs-multiple-performance_graph.png 1290w"],"sizes":"(max-width: 1290px) 100vw, 1290px","style":"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;","loading":"lazy","decoding":"async"},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"​\n조인이 가장 빠른데 그 이유는 여러 개 쿼리가 발생하면 데이터베이스에 대한 각 쿼리에 "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"고정 비용"}]},{"type":"text","value":"이 발생하기 때문입니다. 일대일 관계 같은 경우 중복도 발생하지 않아서 부담 없이 조인을 사용할 수 있을 것 같습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"​\n그렇다고 해서, 일대다 관계에서는 절대 조인을 쓰지 말란 것이 아닙니다. 위에서 말한 것에 핵심 포인트는 일대일 관계뿐 아니라 일대다 관계에서도 많은 외부 레코드를 가리키지 않는 경우입니다. 한 방 조인으로 결괏값 주기 vs 여러 번 통신 + 애플리케이션에서 조합의 "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"트레이드오프"}]},{"type":"text","value":"를 잘 고려해 봐야 됩니다.\n​"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"일대다 관계"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"​\n하지만, 참조된 레코드 중 다수가 동일할 수 있는 "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"일대다 관계"}]},{"type":"text","value":" 같은 경우 조인 시에 중복이 엄청나게 발생할 수 있으니 잘 생각해 봐야 됩니다.\n​"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"예를 들어봅시다.\n​"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 670px; "},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/05f9ff9efd6579a443ab577404f3c5d3/6bbca/2023-10-09-join-vs-multiple-entities.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 23.2%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA0klEQVR42jWQx66EUAxD+f9/A4QQGzZvJMqjiN6bPHMisbBubhI7cZzzPDWOo9q21bqu2rZNx3Houi5RA/d92x8QU5+m2WK4YN93Lcsip65rhWEoz/N+TZPmeTbRYRgNxH+fj5EgUIec5/9qmkZpmgoNcl3XyfF9X67rKkkSI/R9r7IslWWZ4jhWEAQ/cm7CiEGuqkpRFFkNHmIsg0sHMkLP85gFLPJno6IobAuaAblhGEycPOBM8OCbZZpIMv219N6NydyLFyBEjVu+J3g3J2boF24jfcR905RtAAAAAElFTkSuQmCC'); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"2023 10 09 join vs multiple entities","title":"","src":"/static/05f9ff9efd6579a443ab577404f3c5d3/6bbca/2023-10-09-join-vs-multiple-entities.png","srcSet":["/static/05f9ff9efd6579a443ab577404f3c5d3/0eb09/2023-10-09-join-vs-multiple-entities.png 500w","/static/05f9ff9efd6579a443ab577404f3c5d3/6bbca/2023-10-09-join-vs-multiple-entities.png 670w"],"sizes":"(max-width: 670px) 100vw, 670px","style":"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;","loading":"lazy","decoding":"async"},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]},{"type":"text","value":"\n​"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"위와 같은 관계에서 1개의 게시물이 있고 게시물에는 2개의 댓글과 2개의 태그가 있다고 가정해 봅시다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"​"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"sql"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-sql"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-sql"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"SELECT"}]},{"type":"text","value":" post"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"id"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"comment"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"id"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" tag"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"id\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"FROM"}]},{"type":"text","value":" post\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"LEFT"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"JOIN"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"comment"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"on"}]},{"type":"text","value":" post"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"id "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"comment"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"post_id\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"LEFT"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"JOIN"}]},{"type":"text","value":" tag "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"on"}]},{"type":"text","value":" tag"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"post_id "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"text","value":" post"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"id"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n​\n"},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"-- post_id comment_id tag_id"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"-- 1        1           1"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"-- 1        1           2"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"-- 1        2           1"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"-- 1        2           2"}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"​"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"위와 같은 쿼리를 실행하면 2 * 2로 4개의 결과가 나왔습니다. 여기서 댓글과 태그가 4개로 늘어난다면 어떻게 될까요?"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"​"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"sql"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-sql"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-sql"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"SELECT"}]},{"type":"text","value":" post"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"id"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"comment"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"id"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" tag"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"id\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"FROM"}]},{"type":"text","value":" post\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"LEFT"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"JOIN"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"comment"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"on"}]},{"type":"text","value":" post"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"id "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"comment"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"post_id\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"LEFT"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"JOIN"}]},{"type":"text","value":" tag "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"on"}]},{"type":"text","value":" tag"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"post_id "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"text","value":" post"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"id"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n​\n"},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"-- post_id comment_id tag_id"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"-- 1        1           1"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"-- 1        1           2"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"-- 1        1           3"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"-- 1        1           4"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"-- 1        2           1"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"-- 1        2           2"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"-- 1        2           3"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"-- 1        2           4"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"-- 1        3           1"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"-- 1        3           2"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"-- 1        3           3"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"-- 1        3           4"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"-- 1        4           1"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"-- 1        4           2"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"-- 1        4           3"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"-- 1        4           4"}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"​"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"각 행의 곱인 4 * 4 = 16개의 행이 나오게 됩니다. 그럼 만약에 각 데이터의 수가 1000개씩만 되어도 나오는 행의 수는 몇 개일까요..? 여기서 더 "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"많은 테이블과 레코드들을 추가하면 수많은 중복된 데이터가 생겨날 것입니다."}]},{"type":"text","value":"\n​\n실제 테스트를 해봅시다. 실험 환경은 다음과 같습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Mac M1 Pro 16G 512GB"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"실험 데이터 수는 게시글 1개, 댓글 1000개, 태그 1000개"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"​"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"먼저 조인을 이용하여 100만(1000 * 1000)개의 테이블을 생성해 결괏값 100만 개를 내어줄 때는 "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"12초"}]},{"type":"text","value":"가 걸렸습니다.\n​"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1178px; "},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/486af2325274fb1cefcf08eddda9bfcf/dc992/2023-10-09-join-vs-multiple-log1.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 13.799999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAhElEQVR42lWPWQ7DIAxEOQqhbAbCJvWzau5/qSmDlEr5eDJj7BlQJQmiCEIIkJRgg0eShBgjjuN4oLXe3JozxOaId7D4iIO6ri/GGDjPE713tNZQa8WcEznnXdMKKqXsUGKMebLMWV8LxQQOc4lmNKFmAO+oaXK/RtZvvPdwzv37PLNHfnXVWAk+DfHqAAAAAElFTkSuQmCC'); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"2023 10 09 join vs multiple log1","title":"","src":"/static/486af2325274fb1cefcf08eddda9bfcf/dc992/2023-10-09-join-vs-multiple-log1.png","srcSet":["/static/486af2325274fb1cefcf08eddda9bfcf/0eb09/2023-10-09-join-vs-multiple-log1.png 500w","/static/486af2325274fb1cefcf08eddda9bfcf/1263b/2023-10-09-join-vs-multiple-log1.png 1000w","/static/486af2325274fb1cefcf08eddda9bfcf/dc992/2023-10-09-join-vs-multiple-log1.png 1178w"],"sizes":"(max-width: 1178px) 100vw, 1178px","style":"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;","loading":"lazy","decoding":"async"},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"​\n하지만, 두 개의 쿼리(1000 + 1000)로 분리하여 결괏값 100만 개를 내어 줄 때는 고작 "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"0.2초"}]},{"type":"text","value":"밖에 안 걸린 걸 볼 수 있습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"​\n"},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1106px; "},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/9b5589e00f115d68ff951eddf98972d2/22593/2023-10-09-join-vs-multiple-log2.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 12.200000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAb0lEQVR42jWOWwrFIAxEuxMVjRrrExWE7n9dc6+WfoQzyXycXM/syDnDOQdmhmMHzx4hBGitQUSHe6SUUEpBCPF2xkCRwU0aUysskrjmGFhroZSC1hrGf08pofdXtFlrPbcY45F6788DW7bzR2stfoOAO16wQs4yAAAAAElFTkSuQmCC'); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"2023 10 09 join vs multiple log2","title":"","src":"/static/9b5589e00f115d68ff951eddf98972d2/22593/2023-10-09-join-vs-multiple-log2.png","srcSet":["/static/9b5589e00f115d68ff951eddf98972d2/0eb09/2023-10-09-join-vs-multiple-log2.png 500w","/static/9b5589e00f115d68ff951eddf98972d2/1263b/2023-10-09-join-vs-multiple-log2.png 1000w","/static/9b5589e00f115d68ff951eddf98972d2/22593/2023-10-09-join-vs-multiple-log2.png 1106w"],"sizes":"(max-width: 1106px) 100vw, 1106px","style":"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;","loading":"lazy","decoding":"async"},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]},{"type":"text","value":"\n​\n​\n여러 개의 테이블을 조인하는 경우도 아래의 벤치마크를 한번 봅시다. 두 경우 모두 동일한 결과(6 x 50 x 7 x 12 x 90 = 2268000)를 얻지만 여러 개의 쿼리가 훨씬 더 빠릅니다.\n​"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ol","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"5개의 조인을 사용한 단일 쿼리"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"쿼리: "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"8.074508초"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"결과 크기: 2268000"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"연속 쿼리 5개"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"결합된 쿼리 시간: "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"0.00262초"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"결과 크기: 165(6 + 50 + 7 + 12 + 90)"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"​"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"또한, 중복 데이터로 인해 더 많은 "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"메모리"}]},{"type":"text","value":"를 사용합니다. 적은 테이블의 수를 조인하는 경우 메모리 사용량이 적겠지만, 테이블이 점점 늘어날수록 차지하는 메모리가 기하급수적으로 늘기 때문에 잘 고려하면 좋을 것 같습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"​"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"조인이 적합한 지 여부 판단"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"​\n조인을 사용해야 하는지는 조인이 "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"적합한지"}]},{"type":"text","value":"에 따라 판단해 볼 수도 있습니다. 위의 예시로 사용한 테이블에서 댓글과 태그는 게시글과는 관련이 있지만 서로는 관련이 없습니다. 이 경우 두 개의 별도 쿼리를 사용하는 것이 더 좋습니다. 태그와 댓글을 결합하려고 하면 둘 사이에는 직접적인 관계가 없는데도 각 테이블행의 곱만큼 가능한 모든 조합이 생성됩니다. 또한, 두 쿼리를 병렬로 수행하여 이득을 얻을 수도 있습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"​\n하지만, 여기서 만약에 다음과 같은 상황을 생각해 봅시다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"​\n"},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 697px; "},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/665449e94bd3520f9c11844f6017733e/11663/2023-10-09-join-vs-multiple-entities-modified.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 27.200000000000003%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAyElEQVR42lWQWYqFQAxFa/8bcweiIIgoiji1cznexwn40cI1IcNJUs57r/u+dZ6n9n03exyHxaZpMr/rOhP+tm16nuef3vc14bu6rlVVldI0VVmWWtdVfd9bQVEUSpJEQRAoDEPLjeNo4OFvlPe78jy3wcuy2EKuaRrFcawsy2w6YhuKiAEEDIxc27Ym4lEU2TKA5nk2qOMHFPudS5KTsWyL5eMkoADoIccgRA3WUQCMt/w2RJzMecMwWP5rxAfMYHqAI/zruvQDh79/H32fya4AAAAASUVORK5CYII='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"2023 10 09 join vs multiple entities modified","title":"","src":"/static/665449e94bd3520f9c11844f6017733e/11663/2023-10-09-join-vs-multiple-entities-modified.png","srcSet":["/static/665449e94bd3520f9c11844f6017733e/0eb09/2023-10-09-join-vs-multiple-entities-modified.png 500w","/static/665449e94bd3520f9c11844f6017733e/11663/2023-10-09-join-vs-multiple-entities-modified.png 697w"],"sizes":"(max-width: 697px) 100vw, 697px","style":"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;","loading":"lazy","decoding":"async"},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"​\n게시물에 댓글을 달고 댓글 작성자의 이름까지 원한다면? 조인을 고려해 볼 수 있습니다. 훨씬 더 자연스러운 쿼리일 뿐 아니라 데이터베이스 시스템에서 이와 같은 쿼리를 "},{"type":"element","tagName":"a","properties":{"href":"https://dev.mysql.com/doc/refman/8.0/en/optimization.html"},"children":[{"type":"text","value":"최적화"}]},{"type":"text","value":"하려고 노력하고 있다고 합니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"​"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"서브쿼리(SubQuery)"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"​"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"조인 대신에 "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"서브 쿼리"}]},{"type":"text","value":"를 이용하는 방법도 있습니다. 서브 쿼리와 조인의 성능을 비교해 봅시다. 우선 MySQL "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"5.5"}]},{"type":"text","value":" 버전에서 서브 쿼리는 못쓸 정도라고 평할 정도로 제대로 수행되지 않았습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"​\n테스트 데이터"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"메인 테이블 100만 건"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"서브 테이블1 (Index O) 1000건"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"서브 테이블2 (Index X) 1000건"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"​\n수행 시간"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"MySQL 5.5 + 서브 쿼리 + No Index에서 100만 건 & 1천 건 조회에 "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"3분"}]},{"type":"text","value":"이 소요"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"MySQL 5.5 + 서브 쿼리 + Index에서 100만 건 & 1천 건 조회에 "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"1.8초"}]},{"type":"text","value":" 소요"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"MySQL 5.5 + 조인 + No Index에서 100만 건 & 1천 건 조회에 "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"11초"}]},{"type":"text","value":" 소요"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"MySQL 5.5 + 조인 + Index에서 100만 건 & 1천 건 조회에 "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"0.139초"}]},{"type":"text","value":" 소요"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"​\nMySQL 특정 버전(5.5이하)에서는 서브 쿼리 대신 조인이 압도적으로 빠른 것을 볼 수 있습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"MySQL에서는 무슨 일이 있었기에 5.5 버전에서는 서브 쿼리 성능이 좋지 않을까요?"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ol","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"최적화 부재: 초기 버전의 MySQL에서는 서브 쿼리에 대한 충분한 최적화가 이루어지지 않았습니다. 그 결과 서브 쿼리는 복잡한 연산을 필요로 하는 경우에 매우 비효율적으로 동작하게 되었습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"재귀적 처리: MySQL 5.5에서 서브 쿼리는 종종 재귀적으로 처리되었고, 이는 성능 문제를 야기했습니다. 특히, 상위 쿼리에서 서브 쿼리의 결과를 여러 번 재참조해야 할 때 이 문제가 두드러졌습니다."}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"5.6"}]},{"type":"text","value":"에서는 "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"서브 쿼리 성능 개선"}]},{"type":"text","value":"이 많이 이루어졌습니다.\n​"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"수행 시간"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"MySQL 5.6 + 서브 쿼리 + No Index에서 100만 건 & 1천 건 조회에 "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"19초"}]},{"type":"text","value":" 소요"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"MySQL 5.6 + 서브 쿼리 + Index에서 100만 건 & 1천 건 조회에 "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"0.18초"}]},{"type":"text","value":" 소요"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"​"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"3분에서 19초, 11초에서 0.18초 개선될 정도로 5.6에서는 최적화가 이루어졌지만 아직 "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"모든 서브 쿼리가 다 최적화가 된 것은 아니라고 합니다."}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"​\n즉, 웬만하면 "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"최대한 조인을 이용"}]},{"type":"text","value":"하고 조인을 이용하기 어렵다면 5.6 이상은 서브 쿼리를 사용합니다. 5.5 이하는 절대 사용하지 않고 차라리 쿼리를 나눠서 2번(메인 쿼리, 서브 쿼리) 실행하고 애플리케이션에서 조립하면 좋을 것 같습니다. 물론, 스칼라 서브 쿼리 캐싱 등의 최적화 기술로 때때로 서브 쿼리가 조인보다 더 효율적일 때도 있습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"​"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"결론"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"​"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"사실 위의 내용은 어느 정도 통계에 기반에서 이렇다 할 뿐이지 자신의 상황에서는 전혀 다르게 동작(고려해야 할 변수가 많기 때문에)할 수도 있습니다. 그러므로 "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"참고만 하고"}]},{"type":"text","value":" EXPLAIN 같은 실행 계획이나 "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"직접 테스트하여 측정해 사용"}]},{"type":"text","value":"하도록 합시다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"​"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"blockquote","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Don’t guess, measure!"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"​"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"참고:"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://stackoverflow.com/questions/1067016/join-queries-vs-multiple-queries"},"children":[{"type":"text","value":"JOIN queries vs multiple queries"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://jojoldu.tistory.com/520"},"children":[{"type":"text","value":"MySQL where in (서브쿼리) vs 조인 조회 성능 비교 (5.5 vs 5.6)"}]}]},{"type":"text","value":"\n"}]}],"data":{"quirksMode":false}},"excerpt":"…","timeToRead":5,"frontmatter":{"title":"어떤 경우에 한 방 조인 쿼리와 여러 개 쿼리 분리를 고려할 수 있을까?","userDate":"13 November 2023","date":"2023-11-13T12:00:00.000Z","tags":["query","sub-query","join"],"excerpt":null,"image":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAABLklEQVR42q2SS4uDQAzH/fBCr6XQs1/AY9GLeBFftEWlUrB4sHioggq29uGr/2UGdK2sZbtsIDDJJL/JJGHwRqqqwvP57O3heUqYqYvH4wGe57FarSAIAkRRhGEYCILgLXwS2LYtXNfFZrOBruvwPA+maeJ0Ov0N+JP8+std4OVyodr5SJVErtcr8jzvk4hdFEUfR3Lu9/sr8Ha7YbfbwXGcF2hd1/B9n94Rf1mWNGa9XuN8PlMwaYtt2/QhpqsuDEMsl0ssFgscDgcKsywLURSB4zjM53Nst1sKVFUViqIgjmNkWUZtTdOQpuk38Hg8YjabgWVZ7Pf7fm1IhSQpSRJawbBFw7Z0g+yHQpJkWYYkSW8nSXxN01Al57HNTL00XuhOP1psAhrDPhUG/yxfb5ac0LcrYZ0AAAAASUVORK5CYII="},"images":{"fallback":{"src":"/static/3621bcf695c69be193a38a9b89c7ef9a/c1343/join-query-vs-multiple-quries.png","srcSet":"/static/3621bcf695c69be193a38a9b89c7ef9a/8552d/join-query-vs-multiple-quries.png 750w,\n/static/3621bcf695c69be193a38a9b89c7ef9a/c1343/join-query-vs-multiple-quries.png 756w","sizes":"100vw"},"sources":[{"srcSet":"/static/3621bcf695c69be193a38a9b89c7ef9a/402d8/join-query-vs-multiple-quries.avif 750w,\n/static/3621bcf695c69be193a38a9b89c7ef9a/fd795/join-query-vs-multiple-quries.avif 756w","type":"image/avif","sizes":"100vw"},{"srcSet":"/static/3621bcf695c69be193a38a9b89c7ef9a/4d26c/join-query-vs-multiple-quries.webp 750w,\n/static/3621bcf695c69be193a38a9b89c7ef9a/8192a/join-query-vs-multiple-quries.webp 756w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.582010582010582}}},"author":[{"name":"5기_무민","bio":"끊임없이 생각하고 나아가는 개발자 무민(박무현)입니다","avatar":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","backgroundColor":"#4898c8","images":{"fallback":{"src":"/static/6369129db37503fc50518a11710d5840/f8bea/moomin.png","srcSet":"/static/6369129db37503fc50518a11710d5840/b51d4/moomin.png 40w,\n/static/6369129db37503fc50518a11710d5840/5fa61/moomin.png 80w,\n/static/6369129db37503fc50518a11710d5840/f8bea/moomin.png 120w","sizes":"100vw"},"sources":[{"srcSet":"/static/6369129db37503fc50518a11710d5840/40b58/moomin.webp 40w,\n/static/6369129db37503fc50518a11710d5840/f6639/moomin.webp 80w,\n/static/6369129db37503fc50518a11710d5840/b4c71/moomin.webp 120w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.7583333333333333}}}}],"source":null}},"relatedPosts":{"totalCount":1,"edges":[{"node":{"id":"066686c9-04a1-5a39-a905-802b74b6ed5c","timeToRead":5,"excerpt":"…","frontmatter":{"title":"어떤 경우에 한 방 조인 쿼리와 여러 개 쿼리 분리를 고려할 수 있을까?","date":"2023-11-13T12:00:00.000Z"},"fields":{"slug":"/post/2023-10-09-join-query-vs-multiple-quries/"}}}]}},"pageContext":{"slug":"/post/2023-10-09-join-query-vs-multiple-quries/","prev":{"excerpt":"…","timeToRead":14,"frontmatter":{"title":"공간 데이터 개념부터 적용까지","tags":["JPA","MYSQL","SPATIAL","INDEX"],"date":"2023-10-24T12:00:00.000Z","draft":false,"excerpt":null,"image":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAACrElEQVR42iWTW1NTVxTHz2fsTKVP9cGhoykKCSEJ57Iv55yccxKgiJqQpHHGCIwOol/By1iQ1kwd2z60TOmLCgjYAmXo268rx4f1sGft/V//y9pOJfBQNsSEMaFUmqSMj48zNvYVfs2l2Wii44jJyRuESqN0hDZWKsSTc+DG2Ok54oklgprFKc66VFyf8vQMURTzy+Ymv//2Ky+fPeXD8DVr3/fx5eFMtYo1hno9IbRRftfWDQuFLu1LT1gae0jz6h2cwJ1F+wG16TKBNvy4vc3FxX9SF5yfn7O6uoaSflxPMQJktKYyNYUOlCiqYyJL81qP1hcbRMLW0VqhRfKoaaWGw5/4dHzM/t4eH/be0+910TLIWourQpQywjCUc0gkFplIzpWM7NtbgqNxfLmgRIoX6NzD7VevOD274EAAT05O6HW7lMpVup0OWZblkpMkob28zOLiTRbmF8jmGrg2wPMNTs1zSaM6M5NFkWN48+YtB/v77O7scPjxgHuDAaXpSh6ODaNcdppmzAtQs9mkIUOMjXMwI0E5lXIFI8GMEsxk8tbWFqenZ/y58wd/fzpmRTysST+SoQ8ePGR9YyNnd//+Kuvrj1he7oglVlRaasrHsSN0keuZgKSRMnw95PTkH96/eyfSzxgIw1q1Qiq9OIvxJSCtPnuuwzB/647YCY4vCp2lKwO+uzxg/kaHpl5ka/NlzvDw6Ih/JeWVlRXcWZ8gVkx2CpRaBbw5V1aoThgkYlMk22Epl2cJZJCTlZe49fUad758zMLVu7z44TkfD494+/OQv3Z36bTbwkgRRwmxlfAaJYrt6xR7BWZullCJ9ExCVTJQypO1kcmBXycr3sZ6KbfbLfr9Pp1OL/dnlKoRwNFvUrI6sY6lEmFsmJovUmh9w0TrGm7qCY7hf/gsVI7vP1SFAAAAAElFTkSuQmCC"},"images":{"fallback":{"src":"/static/d07d53114d80bb20c6aaa50caef05ab3/80f70/spatial-data.png","srcSet":"/static/d07d53114d80bb20c6aaa50caef05ab3/b95c0/spatial-data.png 750w,\n/static/d07d53114d80bb20c6aaa50caef05ab3/a4d55/spatial-data.png 1080w,\n/static/d07d53114d80bb20c6aaa50caef05ab3/6bb79/spatial-data.png 1366w,\n/static/d07d53114d80bb20c6aaa50caef05ab3/80f70/spatial-data.png 1920w","sizes":"100vw"},"sources":[{"srcSet":"/static/d07d53114d80bb20c6aaa50caef05ab3/47593/spatial-data.webp 750w,\n/static/d07d53114d80bb20c6aaa50caef05ab3/83b3c/spatial-data.webp 1080w,\n/static/d07d53114d80bb20c6aaa50caef05ab3/ab1e7/spatial-data.webp 1366w,\n/static/d07d53114d80bb20c6aaa50caef05ab3/76d8f/spatial-data.webp 1920w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.5385416666666667}}},"author":[{"name":"5기_폴로","bio":"우아한테크코스 5기 폴로(이동훈)입니다 :)","avatar":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAIAAAAC64paAAAACXBIWXMAAAsTAAALEwEAmpwYAAAEv0lEQVR42g2Qa0xTBwCF76LSCX3T120vfd229PZJ6fO2pb0tfdjSF1Ae9iWlLYJQEVZabJWORxpwICDKRKdTN42Pmc3NZZuZmiwzZO+ZLCb7sy3br/3dr82YsCYn59f5ck4OMOg2YqhFLpX1DU+6Y0fz1fXsdNVotgViueFTZ33RoeHCoi2UGDhWurv7a+ZIbHHh9JXttwrFaXewF8BQA4raYDEye+mjxKnV6tWP05U11OkPZqdPbN4am9+I5iuTm7eDQ2M7T19Eh0Zdwe7C+dup6gWLwwvYrFaVUs1mgTZvRG9xxIu1I+UzzmgqPjO/fO9xsrwyfHrl+vd/mvy9WDRt9UVlKm1u6e3QSFFvdQBmvVaKKCAebPJ0G11BR186VVmNjM44gj0nr30SLy9HMuNbj37wxjLZ2ra9O6Yx2/qn3uzszyp1RkAh4rXrUbhVXsdMvqhvIL3+8NnspTsqtCOcyR/qi9vdnqn1d7G+1NqHT8dr52RqtcGGtaEdZqcb8Ni0Wr2OK4BdA2mVxZmYKl/96ueR2hZfIBKy6XIhJG0BmXRQota//+TbrQeP84urWhRFEEQsFgEOl0PbgTFb+HI9ivp7RufPzN98oMK8ZBzOAHMMMGSV8UxSLulAw2R1JV5cSMwudsWS9f4WNghIpFK92cyBWtBOT8/YVOnsdvniDSGizDiNN8e7L4+Gf7xe3b1SGnUjmMfjiWWTU6VsYZZMwOu0asDqdIS6nAwWiw1BkdxEqjR3uHAqEg5tZLufny8+mR/695tbe3882j0/kQq42k2oxYy2t7cxqWREAgMsKsko5TTjcVwaAeZxFAq5RoWEzYblRP9fV+d/Pzfz6us7L3/5dO+7uzfy6XpAL4MtCl79Cx6bBbDwOCvCohNwEpDKoRIEdJKKz/C0yY87rc+Xjv22U3y1e2fvxcN/vrwx0x+waFr9JmXUrk772lztQiBqEY53IR41iLDJGgFNJWBiKt4g1jYbOfT3/c3/nl17+eTi3vN7GycGDXKR36oJdGi9qHo2idUyHcDJw/pa2rAzae8x870a3lGfspowrU14vErRF5XYy8+Xf9oaWzsamuw1Vo5gaZ9+wIuGnKZc0DQ33AmUD+s2JuzbeXvKIUp2ysox0wcL4YWcAwAAH8IpRVAdzBJz6DG/eT3v2prsGgq7fHbzeJ99Lu0CKnHjXAp9I6ot9GpLg6aRkC6Atkr4UCvMr/MMwkFa0+tuVDXoM6MqUdRliLo74qFDMyPx0pAfyIWMU/3m6V5N0qMxyARCiEnEE/BNBLfdKId5EAUPcaCxZEgrhSRckM+iSfgcdSs/YNfP5cLATiH0zkwgbJEQ8CQaicimUygkIodOkcukycQgj0qsFI9n4hEeiyqHOWIuExHUnSXmgb2dOuDmsOJyVgezaYTGJiaFSCESuSCd3Uw2qKXv7dRcmPnahSWdQgJDTDaNKhOyVWKIy6BKBaBOIQSuBGmZdtK+/Q10Ep6Mb2w40MBmNENMqlwEbW8uba7OVQsZHptRFx+k10mtlAc2k2QCsD4E2AiLuJRG4LX9NFLTQRxu/74DhMaDAg6DTScXpsc+u38Js5ogBhWkNbfyQaWYq5FymVSiAKTxweb/AV9SY9zA4JrfAAAAAElFTkSuQmCC"},"images":{"fallback":{"src":"/static/283756d694c1334511090ce8355d08da/ccc41/polo.png","srcSet":"/static/283756d694c1334511090ce8355d08da/ccc41/polo.png 512w","sizes":"100vw"},"sources":[{"srcSet":"/static/283756d694c1334511090ce8355d08da/d689f/polo.webp 512w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":1}}}}]},"fields":{"layout":"post","slug":"/post/2023-10-04-spatial-data/"}},"next":{"excerpt":"[Android] 레이어드 아키텍처에서 이미지 업로드하기 배경 저는 현재 ‘나아가’라는 우테코 프로젝트와 ‘ZOOC…","timeToRead":15,"frontmatter":{"title":"레이어드 아키텍처에서 이미지 업로드하기","tags":["ANDROID","MULTIPART","IMAGE","UPLOAD","ARCHITECTURE"],"date":"2023-11-13T12:00:00.000Z","draft":false,"excerpt":null,"image":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAABbklEQVR42q2Ty0sCURTG71hEUrarRRFREEHQpoePRsScXKRpZfmIEFoEokkLeyxKatM6RysnKEuEgjALjTToj/s6M1MagSDq4uPcO8P53W++c4ex1DzaqnovuBTfGpC75KGRlVIrp0BbAYpGsMQsaQ5cQg9N0kRAUxNAUY+x7AZcpUM4ijF4P45heQnDW46Df94Bu5hRJRoaB45m18HnQzDnw7AUIph6DGKJ4LbXKIbvVzGRC6D/1kHuybncJLtP1olEBo48eGClZvf7ETYrp5gkgK2wi63PMyyXDuCrxAm8pgA6KeMOJWsCKrH8B1Jm4zk/uQth+ikIPzX7yicQClE4SzEI9PmO4j48FIUcw/bXOYS3PQToYBcZGLhzQjZVvRWMgu+6skAnLaL72orBjBtDmRX0SoLyTJteQN+NHT2SrbrWpq1K1Ul2cmsG+zs89pMJSxrVSjnJrtX9rwy1tWioVWVQpsYudtv/lGb1DamVxuoe+L2rAAAAAElFTkSuQmCC"},"images":{"fallback":{"src":"/static/13fb617e5ad8359478dd70acd363e5c2/ff905/image-upload.png","srcSet":"/static/13fb617e5ad8359478dd70acd363e5c2/d734b/image-upload.png 750w,\n/static/13fb617e5ad8359478dd70acd363e5c2/a304c/image-upload.png 1080w,\n/static/13fb617e5ad8359478dd70acd363e5c2/ff905/image-upload.png 1090w","sizes":"100vw"},"sources":[{"srcSet":"/static/13fb617e5ad8359478dd70acd363e5c2/59596/image-upload.webp 750w,\n/static/13fb617e5ad8359478dd70acd363e5c2/45939/image-upload.webp 1080w,\n/static/13fb617e5ad8359478dd70acd363e5c2/1bdb2/image-upload.webp 1090w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.6247706422018349}}},"author":[{"name":"5기_빅스","bio":"우아한테크코스 5기 빅스(권용민)입니다 :)","avatar":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","placeholder":{"fallback":"data:image/jpeg;base64,/9j/2wBDAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/2wBDAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/wgARCAAUABQDASIAAhEBAxEB/8QAGAABAQEBAQAAAAAAAAAAAAAAAAgGCQX/xAAXAQADAQAAAAAAAAAAAAAAAAAEBQYD/9oADAMBAAIQAxAAAAHrDLPv5gE6tGLC6SrKJTouhwmnf//EABwQAAICAwEBAAAAAAAAAAAAAAIEAQYDBQcSIf/aAAgBAQABBQJnKxCfJt1eduoRfbruGk09laIwNk+MF0LDDlcrgZRs/spn/8QAHxEBAQABBAIDAAAAAAAAAAAAAQISAwQRMQATEBQh/9oACAEDAQE/AfsxPuj06l1BNewrgiTF1HDFzCan9yjFTvk84PN3du+28NUwVpUQqyVVhVE9DRMlPaSD0fH/xAAgEQACAQQDAAMAAAAAAAAAAAABAhEAAxIxBAUiUbHw/9oACAECAQE/AU4lxxYYXLai+XUBlO1kLLz5yZWgQ2QU/Bqa61QOq5bgAPF9cwPWK2ZUZbgFmIGgWYjZr99V/8QAJhAAAgIBAwQBBQEAAAAAAAAAAgMBBAUREiIAEyExFAYQMkFRcf/aAAgBAQAGPwK1NMRZcGtYKos/wO1CDmsB+Y4k7YJeY4zPnrPz9avxlk6mQr16bMd2Nym9ppX6j4rgsR+OXx+2DBhwdwoP9fbEqp2CUeQyqK5iuZFzUCQE0QIeUQIzJt049sS3lEe8bGLsoAXZuQvzXiCWQmEjA2NkbJY9hLHcU6nO3n1Ma+pn31yY5LK16maLFZpIsKlhEtuxg+oYHEvH8kZE4EowlZt27bQq3XIV23d70hzYgikYYYw0QPQynUgGS186z/vX/8QAGhABAQADAQEAAAAAAAAAAAAAAREAITFhQf/aAAgBAQABPyHdjjUVIVPKnA6SvSYjWKpJWgYDFIRehFyVtxDMa2PE4SFZOSlDJK6HV0vmApPKkRVDN5hiEHsf+biukU2MsFq7Pv3P/9oADAMBAAIAAwAAABBIN/3/xAAbEQEBAAIDAQAAAAAAAAAAAAABEQBxUYHwkf/aAAgBAwEBPxBuyeqApAArtTJPi693rETuJJ8KVwCkQivL9c//xAAbEQEAAgMBAQAAAAAAAAAAAAABESEAQYFRcf/aAAgBAgEBPxB25ZCMeBMkGgIoEw+3fHXwxotYAYWgG/zAAWTXM//EABkQAQEBAQEBAAAAAAAAAAAAAAERACExQf/aAAgBAQABPxAWCRI8kH4sAzWB8tARyFk48FBERDvl9Fi06Y3nxRfyBkXNEfXNyarr1+EJEciLzxR7qeLfRxEiXgImDNDji1vFaQGKJnoiM2PopVUClvVVV+q7/9k="},"images":{"fallback":{"src":"/static/13a3c587effa024d7cd223f0e8496f46/869a6/vix.jpg","srcSet":"/static/13a3c587effa024d7cd223f0e8496f46/0f5ce/vix.jpg 750w,\n/static/13a3c587effa024d7cd223f0e8496f46/b74b1/vix.jpg 1080w,\n/static/13a3c587effa024d7cd223f0e8496f46/6e2bb/vix.jpg 1366w,\n/static/13a3c587effa024d7cd223f0e8496f46/869a6/vix.jpg 1920w","sizes":"100vw"},"sources":[{"srcSet":"/static/13a3c587effa024d7cd223f0e8496f46/4f03f/vix.webp 750w,\n/static/13a3c587effa024d7cd223f0e8496f46/4f506/vix.webp 1080w,\n/static/13a3c587effa024d7cd223f0e8496f46/f0a0a/vix.webp 1366w,\n/static/13a3c587effa024d7cd223f0e8496f46/26222/vix.webp 1920w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":1}}}}]},"fields":{"layout":"post","slug":"/post/2023-10-17-image-upload/"}},"primaryTag":"query"}},"staticQueryHashes":["2337738035"],"slicesMap":{}}