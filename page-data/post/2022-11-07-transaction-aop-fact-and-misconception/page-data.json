{"componentChunkName":"component---src-templates-post-tsx","path":"/post/2022-11-07-transaction-aop-fact-and-misconception/","result":{"data":{"logo":{"childImageSharp":{"fixed":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAwUlEQVQY003Qvw7BUBTH8YYgLCKExWw1IczEwAtIJCa1GJuyCalI/EmERUgHi5cxeI8uTTt1aHp9r9wmhk/OOfee/HJzNd/3Dc/zutS24zgZIUQpiqIt9YY+vUb9+eur6Kh5GN9LGkEn2DBd1y1zmGfxjjf9AFm1XEQCBe6aVBMVLJHiLBcHTiHwQS0MQ/mSOlYsjPDCAjOMccUFR3Z0NdvYISkDW9jAQi8IAhnYgAyZ4wELEzUfcFZfYmCPJ9ZIfwG9owW1fLgCkwAAAABJRU5ErkJggg==","width":400,"height":88,"src":"/static/0b18bd94a62a12fdc81ea720c28722f6/3891b/tecoble.png","srcSet":"/static/0b18bd94a62a12fdc81ea720c28722f6/3891b/tecoble.png 1x"}}},"markdownRemark":{"html":"<h2>들어가며</h2>\n<p>트랜잭션을 공부하다보면서 자연스럽게 AOP에 대해 접하게 되었습니다.\nAOP를 사용하게 되면서 직접 경험했던 사실과 오해에 대해서 공유하려고 합니다.</p>\n<h2>첫 번째 사실: public이외의 메서드는 AOP가 걸리지 않는다.</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 365px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/af573b452edb91f619a33bf55f35f8e3/dbde8/2022-11-07-aop1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 41.917808219178085%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABJ0AAASdAHeZh94AAABkUlEQVQoz22Ry3LbMAxF9RmZppmklm0pkawX3xRJUbbsTDaZdNFF//9DbkG63XVxBwAxPCAui0FYiPUGHs5g4QLmVlLMUcQNXTehqRo0ryc0dYuWYvsv/uesEMrBzhHWr/DxBkMgbQNC2OCWDVIYiEmAj0kcIw1gA8fUsyw2iHtNGqkubtzhi3n84gt+s4hzp7ANBp/9jGXU2LYPXOIVhgYbNaM/TeCMtuKWIDKfW+Mx2wVWOxR9O+KT1v6pZ7wHSzLwWmL1CqsjONWr04hWwilBPYFgBOIsEfT9dZYGdU1P6lC80d6eVloFAQLHbeEIasJ7FLh6ji3JcVxITk40QOJjVdRXuFKeLNBky+mtu3t4LI+o6wY9NQZaR3CdfUs5nxT6dqBIryFvpdB4fPhOesI30tPjM3bPOxx2BxzLKkOLlLSvbTZcS01+neFt8svcI50lSSahuMTUDTSkpw8Zsf9RZmB9qFHt/wKrfZ2Bkikoeln0CzRd5GRDAi1uyb+cIAlqaVCO2mZI+VKiysA6A/8AwMMBeH8TVWcAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"2022 11 07 aop1\"\n        title=\"2022 11 07 aop1\"\n        src=\"/static/af573b452edb91f619a33bf55f35f8e3/dbde8/2022-11-07-aop1.png\"\n        srcset=\"/static/af573b452edb91f619a33bf55f35f8e3/dbde8/2022-11-07-aop1.png 365w\"\n        sizes=\"(max-width: 365px) 100vw, 365px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>실제 인텔리제이에서 private 메서드에 <code class=\"language-text\">@Transactional</code> 을 선언하면 위와 같이 컴파일 에러를 띄워줍니다.\n해석해보자면 private을 사용하지 말라는군요!</p>\n<h3>왜 private 메서드에는 <code class=\"language-text\">@Transactional</code>이 붙을 수 없을까요?🤔</h3>\n<p>해당 원인을 파악하려면 먼저 프록시에 대해서 알아봐야합니다.\n스프링 aop에서 프록시는 크게 <code class=\"language-text\">JDK Dynamic proxy</code>또는 <code class=\"language-text\">CGLIB</code>으로 작동합니다.\n그리고 spring boot 1.4 버전 이후부터는 default로 <code class=\"language-text\">CGLIB</code>을 사용합니다.</p>\n<p>CGLIB은 동적으로 상속을 통해 프록시를 생성합니다.\n따라서 private 메서드는 상속이 불가능하기 때문에 프록시로 만들어지지 않는것이죠!</p>\n<p>그러면 아래처럼 <code class=\"language-text\">protected</code>나 <code class=\"language-text\">public</code>으로 메서드를 만들면 정상적으로 트랜잭션이 동작할까요?\n정답은 protected일 때 또한 정상 동작하지 않습니다🥲</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 203px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/6bd9ea66b78dcca5fcf91445b4e191f8/187ee/2022-11-07-aop2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 25.615763546798032%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA/ElEQVQY012QXU+DMBSG92/UlULLWj4KIsNtDgZDMMicxpjotf//7vUAYUYvnpxz0renT7oweY2k6RA+HBHlFUzRwOxLBNuCKBEd6nEecnLlw7q2wJkNvvyLdcPHuoibE+K6hXnskXQvSJ7fx2qOTzBVh7v+FbctZdoeQgVgV2y8/J956UIIDbF0JpiAYwm4XMIZewlOs6ReUm8z58KQmxGUvxieVIqzSnDWa3z5G/RqjTed4jvMsbE1Khnjw8vw6W+RcYXd/oC6qlEWFbL0HlEQIfTM78KAu2RGL5KhO5iwyVYxMqLAaEcMZ8OsVx58HcCj/5Q23eWT5bzwB0YUpSvSCS9pAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"protected\"\n        title=\"protected\"\n        src=\"/static/6bd9ea66b78dcca5fcf91445b4e191f8/187ee/2022-11-07-aop2.png\"\n        srcset=\"/static/6bd9ea66b78dcca5fcf91445b4e191f8/187ee/2022-11-07-aop2.png 203w\"\n        sizes=\"(max-width: 203px) 100vw, 203px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span> <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 180px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/67116898ef1328f37a97abf57cb70666/e9ea2/2022-11-07-aop3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 31.666666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABI0lEQVQY01WQy3KCQBBF/ZmozMCMw2OAQVBQoqJSxkTdpFLZJLv8//KmhxIfi1P9vt3Vg3jZID9eoGdLxIsNktct4mrVkdQNbF0XC6qtka73iPISfMThMfGE63idHRTnT5jNDsrMkbYnmPYIs/+gJWfEJK7rLdLmALN9Q/5+QUiCbMg6AQsfuzcxaweCHEEbI0dCjz2oIW2nAf7iQI5cBI6AImt7BA1ILhFMQijhd/jkS1feLzwFM/wmNf7MGpdoRpRoVIpMaPxQ/ite4FtXmKsE1XKFQ3vArmlRVzXSZIqyKKG8yV3QeAES10fIJ4RCRrFiEpIIKGdrMWEvy9IpMhLJTYHI13ShgvQUBH+4kDkumP3FFRvf/nON2cO/evqenv6H/yB/wrk2J28AAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"public-method\"\n        title=\"public-method\"\n        src=\"/static/67116898ef1328f37a97abf57cb70666/e9ea2/2022-11-07-aop3.png\"\n        srcset=\"/static/67116898ef1328f37a97abf57cb70666/e9ea2/2022-11-07-aop3.png 180w\"\n        sizes=\"(max-width: 180px) 100vw, 180px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>분명히 인텔리제이로 확인을 해보면 컴파일 에러는 나오지 않는데 말이죠. 해당 이유는 앞서 말했던 JDK Dynamic proxy 가 원인이었기 때문입니다.\nJDK Dynamic proxy는 인터페이스를 기반으로 동작합니다. 따라서 protected 메서드에서는 프록시가 동작할 수 없는 것이죠.\n그래서 스프링에서는 일관된 AOP적용을 위해서 protected로 선언된 메서드 또한 트랜잭션이 걸리지 않도록 한 것입니다.\n즉, 프록시 설정에 따라 트랜잭션이 적용되었다 안되었다 하는 변칙적인 결과를 막기 위함인거죠.</p>\n<h2>두 번째 사실: 같은 클래스내에서 트랜잭션이 걸린 메소드를 호출하면 트랜잭션이 작동하지 않는다.</h2>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">A</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">progress</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token annotation punctuation\">@Transactional</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">progress</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>예를들어 다음과 같은 상황에서 <code class=\"language-text\">progress()</code>는 정상적으로 트랜잭션이 적용될까요?</p>\n<p>이번에도 안됩니다.</p>\n<p>Spring AOP에서 프록시의 동작 과정을 보면 프록시를 통해 들어오는 외부 메서드 호출을 인터셉트 하여 작동합니다. 바로 이러한 성격때문에 <code class=\"language-text\">self-invocation</code>이 라고 불리는 현상이 발생합니다.</p>\n<p>프록시의 내부 빈에서 프록시를 호출 했다는 것이죠. 그림으로 보면 이해하는데 도움이 될것같아서 그려봤습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1440px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/230f19e03e489df6862ff483c3371996/89066/2022-11-07-aop4.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 69.8%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAABi0lEQVQ4y41Uy27CQAzM//8OZ06REKdc6AVBlbaiJOS9m+fmwdQ2BCgFUkuThI13PGNvsPAgjsej3Luuxz5U8EKNqm4xFbzPerQ4EmZ5jbeNB9t5xz5QaKkAE1fNHWjNtJ3ssZ6p4yQ/0qhpQ1EZKCLPdPUQ/I5zueBTwpJI8rKR52Ho+cVLu0zcmA7WaPEWQlgbslzJc5wk2Gy2SNMUh8MBYRgRQoHnebKu8maakK1wFEUBrfVZ7YCmaQSca4xBRMSqOBM+szz2jUMpJeDY7XZYLpfYbreS23Ud4ji6Klyv17BtG4vFAq7rIs9zfHy4+Pz6JpWnySlSNyqs6xp936NtWyHk+y/COI6FiMHWRCBdNPVPFaNCfVG4Wq0wn88xm83gOA54f5om1O8Jy3xsLpZvFHLRKIqQZRnKshQkSfyPodz1kCd5W3AMY1oaSjA9FJ6yPlvmSZ6OS4ggCC4Iicj3fZRFflX46mCnqpLffT9Ibwe6/MFwyo/SQj4/69UfQ0hJcVZK8hSSc/EfnQE/XOhZ7DIAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"proxy\"\n        title=\"proxy\"\n        src=\"/static/230f19e03e489df6862ff483c3371996/89066/2022-11-07-aop4.png\"\n        srcset=\"/static/230f19e03e489df6862ff483c3371996/0eb09/2022-11-07-aop4.png 500w,\n/static/230f19e03e489df6862ff483c3371996/1263b/2022-11-07-aop4.png 1000w,\n/static/230f19e03e489df6862ff483c3371996/89066/2022-11-07-aop4.png 1440w\"\n        sizes=\"(max-width: 1440px) 100vw, 1440px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span>\nmain메서드에서 그림과 같이 A의 init()를 호출하고 init()에서 progress()를 호출하면 그림과 같이 프록시 내부에서 호출하게 됩니다.\n따라서 proxy가 인터셉트하지 못해서 트랜잭션이 동작하지 않는것입니다.</p>\n<h2>오해: 그렇다면 내부 메서드에서 호출은 AOP적용이 불가능하다</h2>\n<p>해당 주장은 사실이 아닙니다. 공식문서를 잘 보면 해결 방법이 있습니다.</p>\n<blockquote>\n<p>self-invocation(in effect, a method within the target object calling another method of the target object)\ndoes not lead to an actual transaction at runtime…</p>\n</blockquote>\n<p>타겟 내에서 타겟의 다른 메서드를 호출할 때, 런타임에 실제 트랜잭션이 작동하지 않는다고 합니다. 즉, 런타임 시점에 작동은 안 하지만 이것을 컴파일 시점에 적용하면 된다는 것이죠.</p>\n<p>그렇다면 어떻게 컴파일 시점에 프록시를 적용할 수 있을까요?</p>\n<p>스프링에서 AOP를 구현하는 방식에는 스프링 AOP도 있지만 AspectJ라는 강력한 도구도 있습니다. AspectJ는 스프링AOP와 다르게 컴파일 시점에 위빙이 이루어집니다. 따라서 AspectJ를 사용하면 self-invocation문제를 해결할수 있는것이죠!</p>\n<p>그런데 만약 Spring AOP를 쓰고있는 상황에서 이런 문제가 발생하면 어떡하죠? 이럴경우 다른 방법도 존재합니다!</p>\n<h3>첫번째 방법은 <code class=\"language-text\">AopContext를 이용하는 방법</code>입니다.</h3>\n<p>AopContext의 <code class=\"language-text\">currentProxy()</code> 메서드는 현재 AOP proxy를 반환합니다.\n이번엔 코드로 확인해봅시다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Aspect</span>\n<span class=\"token annotation punctuation\">@Component</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">AopService</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token annotation punctuation\">@Pointcut</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"execution(void kitchenpos.application.MenuService*.progress(..))\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">pointCut</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token annotation punctuation\">@Before</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"pointCut()\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">before</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>err<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"aop works!!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>우선 aop를 적용해줍니다.\nprogress() 메서드가 동작하기 전에 <code class=\"language-text\">aop works!!</code> 라는 에러 메시지를 출력해주는 aop입니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">progress</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">progress</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"PROGRESS\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>그리고 다음과 같이 실행을 해주면 아래와 같이 적용되지 않습니다.\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 697px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/e538de1361186e34fd1bb296a0773730/11663/2022-11-07-aop5.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 19.6%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAABJ0AAASdAHeZh94AAAAtElEQVQY022O4Q6CMAyEeRETFBls3egGiiGIEpVofP/3OVmJxhh/fGnT3F0veU5XXE79wtDjdh5wPLSoiFFzg6E/YRf2cKYChwDvAmrfLHAtmghbL5rEOidmRx7FVkNlJfKNmsnnvYApCaYwM4RD2+E+PTAOo3i+iWESqFQOawnBMawmaKWRpdmHdLVGmRdgWh43fodQ1bPW/SXRykhgt2cxxSaxUby/J5NFGyoxUGmFd6NfXn8gercIf6tNAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"test-fail\"\n        title=\"test-fail\"\n        src=\"/static/e538de1361186e34fd1bb296a0773730/11663/2022-11-07-aop5.png\"\n        srcset=\"/static/e538de1361186e34fd1bb296a0773730/0eb09/2022-11-07-aop5.png 500w,\n/static/e538de1361186e34fd1bb296a0773730/11663/2022-11-07-aop5.png 697w\"\n        sizes=\"(max-width: 697px) 100vw, 697px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>이번에는 AopContext를 활용하여 아래와 같이 수정해보겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MenuService</span><span class=\"token punctuation\">)</span><span class=\"token class-name\">AopContext</span><span class=\"token punctuation\">.</span><span class=\"token function\">currentProxy</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">progress</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">progress</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"PROGRESS\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>그리고 <code class=\"language-text\">@EnableAspectJAutoProxy(exposeProxy = true)</code> 옵션을 적용해서 작동시켜 봅니다.\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 563px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/93516c3962ab6fe2b965d04d916c541c/e80ce/2022-11-07-aop6.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 18.4%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAABJ0AAASdAHeZh94AAAA00lEQVQY01WP3WrDMAyF8yAbTVv/ylZsJ01YQtYNyqBlN3v/lzmTDR3s4kMCHR3pdBQ9mPgPc7ZQRw19MtL/hywhuIDoI9gz1lCwUsHkE67DBRtP6LRW8GRFxAgitMrCKINzf8Lh5YD+tW/UXh2VzF2jGn5/fuHn9sD944b3vGCWAx0ZuRoI01SwzSPGISNxaV847RveeFjtkCPjkhOWMaFwxjKv2PcrtrcdHBPIRXR1wQrMhHWKEsu12E4MnoZPzUCEEgNGDkiBRRtQH6q1JmQa8AuTq3iMgQVpAgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"test-success\"\n        title=\"test-success\"\n        src=\"/static/93516c3962ab6fe2b965d04d916c541c/e80ce/2022-11-07-aop6.png\"\n        srcset=\"/static/93516c3962ab6fe2b965d04d916c541c/0eb09/2022-11-07-aop6.png 500w,\n/static/93516c3962ab6fe2b965d04d916c541c/e80ce/2022-11-07-aop6.png 563w\"\n        sizes=\"(max-width: 563px) 100vw, 563px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>aop가 작동하는 것을 확인할 수 있습니다.</p>\n<h3>두 번째 방법은 <code class=\"language-text\">자기 자신을 호출하는 방법</code>입니다.</h3>\n<p>내부에서 프록시를 호출하면 인터셉터가 작동하지 않으므로 외부에서 호출하는 방식으로 해결하는 것입니다.</p>\n<ul>\n<li>@Resource</li>\n<li>@Autowired</li>\n<li>@Inject</li>\n</ul>\n<p>등 여러 방법이 있습니다.</p>\n<p>모두 적용이 가능하지만 이번 예시에서는 <code class=\"language-text\">@Resource</code> 어노테이션을 사용하여 AOP를 적용해보겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">MenuService</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token annotation punctuation\">@Resource</span><span class=\"token punctuation\">(</span>name <span class=\"token operator\">=</span> <span class=\"token string\">\"menuService\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token class-name\">MenuService</span> self<span class=\"token punctuation\">;</span>\n    \n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>위와 같이 <code class=\"language-text\">@Resuroce</code> 를 통해 빈 객체로 등록해주고 이번에는 <code class=\"language-text\">self.progress()</code>를 호출해줍니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    self<span class=\"token punctuation\">.</span><span class=\"token function\">progress</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">progress</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"PROGRESS\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>해당 방법이 성공한 이유는 외부에서 내부 빈으로 호출을 하므로 아래와 같이 aop가 정상 동작합니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 558px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/affb2d369a238af7b33a70adad04b814/65207/2022-11-07-aop7.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 20.6%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAABJ0AAASdAHeZh94AAAAwklEQVQY02WPawrCMBCEexE1NUmbxyalqbUKKiIqFHr/64zbaEXwx8eGzbAzU7jawZFF8BGRIeuhSpXRW/2H0YY1hGgDTtTh6BOuocdACcFFFHIjoZWCdSYvnPGwlWUMynUJsRI8xfc9H7WVy9rpPmJ6jHhebmh9w0YBhTcEX3sQEY6HhPOQOGmTyX9ssGBZ14aI075FQxFt02GX+jzJxffB2VEJrrhVqDUn1RpSyMxS/ZdKcm2lswGZ8DElBD42p34BLFB3PjlLJuYAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"test-success\"\n        title=\"test-success\"\n        src=\"/static/affb2d369a238af7b33a70adad04b814/65207/2022-11-07-aop7.png\"\n        srcset=\"/static/affb2d369a238af7b33a70adad04b814/0eb09/2022-11-07-aop7.png 500w,\n/static/affb2d369a238af7b33a70adad04b814/65207/2022-11-07-aop7.png 558w\"\n        sizes=\"(max-width: 558px) 100vw, 558px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>*주의: 해당 방식은 2.6 보다 낮은 버전에서 가능합니다.\n스프링 부트 2.6 버전부터는 기본적으로 순환 참조를 금지하도록 변경되었습니다.\n만약 2.6 버전 이상에서 실습해보고 싶으시다면 아래의 설정을 추가하시면 됩니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">spring</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">main</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">allow-circular-references</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span></code></pre></div>\n<p><a href=\"https://github.com/spring-projects/spring-boot/wiki/Spring-Boot-2.6-Release-Notes\">Spring Boot 2.6 Release Notes</a></p>\n<h2>마무리</h2>\n<p>지금까지 트랜잭션과 AOP에 대한 사실과 오해를 잠깐 맛보았습니다.</p>\n<p>AOP는 내용이 많고 어렵기도 해서 추가적인 학습들이 필요합니다.</p>\n<p>AOP를 사용하면 부가 기능을 따로 추출하여 비즈니스 로직에만 집중할 수 있는 장점이 생기지만\n잘못 사용하면 그만큼 side-effect가 생깁니다.</p>\n<p>이 글을 읽고 낯설었던 aop에 대해 한걸음 가까워졌으면 좋겠습니다!</p>\n<h2>References</h2>\n<ul>\n<li><a href=\"https://docs.spring.io/spring-framework/docs/current/reference/html/data-access.html#transaction-declarative-annotations\">공식 문서</a></li>\n<li><a href=\"https://stackoverflow.com/questions/34197964/why-doesnt-springs-transactional-work-on-protected-methods\">stack-overflow</a></li>\n<li><a href=\"https://www.youtube.com/watch?v=MFckVKrJLRQ&#x26;t=19s\">JDK Dynamic Proxy 와 CGLIB (1)</a></li>\n<li><a href=\"https://www.youtube.com/watch?v=RHxTV7qFV7M&#x26;t=291s\">JDK Dynamic Proxy 와 CGLIB (2)</a></li>\n</ul>","htmlAst":{"type":"root","children":[{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"들어가며"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"트랜잭션을 공부하다보면서 자연스럽게 AOP에 대해 접하게 되었습니다.\nAOP를 사용하게 되면서 직접 경험했던 사실과 오해에 대해서 공유하려고 합니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"첫 번째 사실: public이외의 메서드는 AOP가 걸리지 않는다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 365px; "},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/af573b452edb91f619a33bf55f35f8e3/dbde8/2022-11-07-aop1.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 41.917808219178085%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABJ0AAASdAHeZh94AAABkUlEQVQoz22Ry3LbMAxF9RmZppmklm0pkawX3xRJUbbsTDaZdNFF//9DbkG63XVxBwAxPCAui0FYiPUGHs5g4QLmVlLMUcQNXTehqRo0ryc0dYuWYvsv/uesEMrBzhHWr/DxBkMgbQNC2OCWDVIYiEmAj0kcIw1gA8fUsyw2iHtNGqkubtzhi3n84gt+s4hzp7ANBp/9jGXU2LYPXOIVhgYbNaM/TeCMtuKWIDKfW+Mx2wVWOxR9O+KT1v6pZ7wHSzLwWmL1CqsjONWr04hWwilBPYFgBOIsEfT9dZYGdU1P6lC80d6eVloFAQLHbeEIasJ7FLh6ji3JcVxITk40QOJjVdRXuFKeLNBky+mtu3t4LI+o6wY9NQZaR3CdfUs5nxT6dqBIryFvpdB4fPhOesI30tPjM3bPOxx2BxzLKkOLlLSvbTZcS01+neFt8svcI50lSSahuMTUDTSkpw8Zsf9RZmB9qFHt/wKrfZ2Bkikoeln0CzRd5GRDAi1uyb+cIAlqaVCO2mZI+VKiysA6A/8AwMMBeH8TVWcAAAAASUVORK5CYII='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"2022 11 07 aop1","title":"2022 11 07 aop1","src":"/static/af573b452edb91f619a33bf55f35f8e3/dbde8/2022-11-07-aop1.png","srcSet":["/static/af573b452edb91f619a33bf55f35f8e3/dbde8/2022-11-07-aop1.png 365w"],"sizes":["(max-width:","365px)","100vw,","365px"],"style":"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;","loading":"lazy"},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"실제 인텔리제이에서 private 메서드에 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"@Transactional"}]},{"type":"text","value":" 을 선언하면 위와 같이 컴파일 에러를 띄워줍니다.\n해석해보자면 private을 사용하지 말라는군요!"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"왜 private 메서드에는 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"@Transactional"}]},{"type":"text","value":"이 붙을 수 없을까요?🤔"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"해당 원인을 파악하려면 먼저 프록시에 대해서 알아봐야합니다.\n스프링 aop에서 프록시는 크게 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"JDK Dynamic proxy"}]},{"type":"text","value":"또는 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"CGLIB"}]},{"type":"text","value":"으로 작동합니다.\n그리고 spring boot 1.4 버전 이후부터는 default로 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"CGLIB"}]},{"type":"text","value":"을 사용합니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"CGLIB은 동적으로 상속을 통해 프록시를 생성합니다.\n따라서 private 메서드는 상속이 불가능하기 때문에 프록시로 만들어지지 않는것이죠!"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"그러면 아래처럼 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"protected"}]},{"type":"text","value":"나 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"public"}]},{"type":"text","value":"으로 메서드를 만들면 정상적으로 트랜잭션이 동작할까요?\n정답은 protected일 때 또한 정상 동작하지 않습니다🥲"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 203px; "},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/6bd9ea66b78dcca5fcf91445b4e191f8/187ee/2022-11-07-aop2.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 25.615763546798032%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA/ElEQVQY012QXU+DMBSG92/UlULLWj4KIsNtDgZDMMicxpjotf//7vUAYUYvnpxz0renT7oweY2k6RA+HBHlFUzRwOxLBNuCKBEd6nEecnLlw7q2wJkNvvyLdcPHuoibE+K6hXnskXQvSJ7fx2qOTzBVh7v+FbctZdoeQgVgV2y8/J956UIIDbF0JpiAYwm4XMIZewlOs6ReUm8z58KQmxGUvxieVIqzSnDWa3z5G/RqjTed4jvMsbE1Khnjw8vw6W+RcYXd/oC6qlEWFbL0HlEQIfTM78KAu2RGL5KhO5iwyVYxMqLAaEcMZ8OsVx58HcCj/5Q23eWT5bzwB0YUpSvSCS9pAAAAAElFTkSuQmCC'); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"protected","title":"protected","src":"/static/6bd9ea66b78dcca5fcf91445b4e191f8/187ee/2022-11-07-aop2.png","srcSet":["/static/6bd9ea66b78dcca5fcf91445b4e191f8/187ee/2022-11-07-aop2.png 203w"],"sizes":["(max-width:","203px)","100vw,","203px"],"style":"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;","loading":"lazy"},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 180px; "},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/67116898ef1328f37a97abf57cb70666/e9ea2/2022-11-07-aop3.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 31.666666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABI0lEQVQY01WQy3KCQBBF/ZmozMCMw2OAQVBQoqJSxkTdpFLZJLv8//KmhxIfi1P9vt3Vg3jZID9eoGdLxIsNktct4mrVkdQNbF0XC6qtka73iPISfMThMfGE63idHRTnT5jNDsrMkbYnmPYIs/+gJWfEJK7rLdLmALN9Q/5+QUiCbMg6AQsfuzcxaweCHEEbI0dCjz2oIW2nAf7iQI5cBI6AImt7BA1ILhFMQijhd/jkS1feLzwFM/wmNf7MGpdoRpRoVIpMaPxQ/ite4FtXmKsE1XKFQ3vArmlRVzXSZIqyKKG8yV3QeAES10fIJ4RCRrFiEpIIKGdrMWEvy9IpMhLJTYHI13ShgvQUBH+4kDkumP3FFRvf/nON2cO/evqenv6H/yB/wrk2J28AAAAAAElFTkSuQmCC'); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"public-method","title":"public-method","src":"/static/67116898ef1328f37a97abf57cb70666/e9ea2/2022-11-07-aop3.png","srcSet":["/static/67116898ef1328f37a97abf57cb70666/e9ea2/2022-11-07-aop3.png 180w"],"sizes":["(max-width:","180px)","100vw,","180px"],"style":"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;","loading":"lazy"},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"분명히 인텔리제이로 확인을 해보면 컴파일 에러는 나오지 않는데 말이죠. 해당 이유는 앞서 말했던 JDK Dynamic proxy 가 원인이었기 때문입니다.\nJDK Dynamic proxy는 인터페이스를 기반으로 동작합니다. 따라서 protected 메서드에서는 프록시가 동작할 수 없는 것이죠.\n그래서 스프링에서는 일관된 AOP적용을 위해서 protected로 선언된 메서드 또한 트랜잭션이 걸리지 않도록 한 것입니다.\n즉, 프록시 설정에 따라 트랜잭션이 적용되었다 안되었다 하는 변칙적인 결과를 막기 위함인거죠."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"두 번째 사실: 같은 클래스내에서 트랜잭션이 걸린 메소드를 호출하면 트랜잭션이 작동하지 않는다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"java"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-java"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-java"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"public"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"class"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"A"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"public"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"void"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"init"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n        "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"this"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"progress"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n\n    "},{"type":"element","tagName":"span","properties":{"className":["token","annotation","punctuation"]},"children":[{"type":"text","value":"@Transactional"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"public"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"void"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"progress"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"예를들어 다음과 같은 상황에서 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"progress()"}]},{"type":"text","value":"는 정상적으로 트랜잭션이 적용될까요?"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"이번에도 안됩니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Spring AOP에서 프록시의 동작 과정을 보면 프록시를 통해 들어오는 외부 메서드 호출을 인터셉트 하여 작동합니다. 바로 이러한 성격때문에 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"self-invocation"}]},{"type":"text","value":"이 라고 불리는 현상이 발생합니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"프록시의 내부 빈에서 프록시를 호출 했다는 것이죠. 그림으로 보면 이해하는데 도움이 될것같아서 그려봤습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1440px; "},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/230f19e03e489df6862ff483c3371996/89066/2022-11-07-aop4.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 69.8%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAABi0lEQVQ4y41Uy27CQAzM//8OZ06REKdc6AVBlbaiJOS9m+fmwdQ2BCgFUkuThI13PGNvsPAgjsej3Luuxz5U8EKNqm4xFbzPerQ4EmZ5jbeNB9t5xz5QaKkAE1fNHWjNtJ3ssZ6p4yQ/0qhpQ1EZKCLPdPUQ/I5zueBTwpJI8rKR52Ho+cVLu0zcmA7WaPEWQlgbslzJc5wk2Gy2SNMUh8MBYRgRQoHnebKu8maakK1wFEUBrfVZ7YCmaQSca4xBRMSqOBM+szz2jUMpJeDY7XZYLpfYbreS23Ud4ji6Klyv17BtG4vFAq7rIs9zfHy4+Pz6JpWnySlSNyqs6xp936NtWyHk+y/COI6FiMHWRCBdNPVPFaNCfVG4Wq0wn88xm83gOA54f5om1O8Jy3xsLpZvFHLRKIqQZRnKshQkSfyPodz1kCd5W3AMY1oaSjA9FJ6yPlvmSZ6OS4ggCC4Iicj3fZRFflX46mCnqpLffT9Ibwe6/MFwyo/SQj4/69UfQ0hJcVZK8hSSc/EfnQE/XOhZ7DIAAAAASUVORK5CYII='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"proxy","title":"proxy","src":"/static/230f19e03e489df6862ff483c3371996/89066/2022-11-07-aop4.png","srcSet":["/static/230f19e03e489df6862ff483c3371996/0eb09/2022-11-07-aop4.png 500w","/static/230f19e03e489df6862ff483c3371996/1263b/2022-11-07-aop4.png 1000w","/static/230f19e03e489df6862ff483c3371996/89066/2022-11-07-aop4.png 1440w"],"sizes":["(max-width:","1440px)","100vw,","1440px"],"style":"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;","loading":"lazy"},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]},{"type":"text","value":"\nmain메서드에서 그림과 같이 A의 init()를 호출하고 init()에서 progress()를 호출하면 그림과 같이 프록시 내부에서 호출하게 됩니다.\n따라서 proxy가 인터셉트하지 못해서 트랜잭션이 동작하지 않는것입니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"오해: 그렇다면 내부 메서드에서 호출은 AOP적용이 불가능하다"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"해당 주장은 사실이 아닙니다. 공식문서를 잘 보면 해결 방법이 있습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"blockquote","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"self-invocation(in effect, a method within the target object calling another method of the target object)\ndoes not lead to an actual transaction at runtime…"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"타겟 내에서 타겟의 다른 메서드를 호출할 때, 런타임에 실제 트랜잭션이 작동하지 않는다고 합니다. 즉, 런타임 시점에 작동은 안 하지만 이것을 컴파일 시점에 적용하면 된다는 것이죠."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"그렇다면 어떻게 컴파일 시점에 프록시를 적용할 수 있을까요?"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"스프링에서 AOP를 구현하는 방식에는 스프링 AOP도 있지만 AspectJ라는 강력한 도구도 있습니다. AspectJ는 스프링AOP와 다르게 컴파일 시점에 위빙이 이루어집니다. 따라서 AspectJ를 사용하면 self-invocation문제를 해결할수 있는것이죠!"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"그런데 만약 Spring AOP를 쓰고있는 상황에서 이런 문제가 발생하면 어떡하죠? 이럴경우 다른 방법도 존재합니다!"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"첫번째 방법은 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"AopContext를 이용하는 방법"}]},{"type":"text","value":"입니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"AopContext의 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"currentProxy()"}]},{"type":"text","value":" 메서드는 현재 AOP proxy를 반환합니다.\n이번엔 코드로 확인해봅시다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"java"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-java"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-java"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","annotation","punctuation"]},"children":[{"type":"text","value":"@Aspect"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","annotation","punctuation"]},"children":[{"type":"text","value":"@Component"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"public"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"class"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"AopService"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n\n    "},{"type":"element","tagName":"span","properties":{"className":["token","annotation","punctuation"]},"children":[{"type":"text","value":"@Pointcut"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"execution(void kitchenpos.application.MenuService*.progress(..))\""}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"public"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"void"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"pointCut"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n\n    "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n\n    "},{"type":"element","tagName":"span","properties":{"className":["token","annotation","punctuation"]},"children":[{"type":"text","value":"@Before"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"pointCut()\""}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"public"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"void"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"before"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n        "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"System"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"err"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"println"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"aop works!!\""}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"우선 aop를 적용해줍니다.\nprogress() 메서드가 동작하기 전에 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"aop works!!"}]},{"type":"text","value":" 라는 에러 메시지를 출력해주는 aop입니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"java"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-java"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-java"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"public"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"void"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"init"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"this"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"progress"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"public"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"void"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"progress"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"System"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"out"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"println"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"PROGRESS\""}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"그리고 다음과 같이 실행을 해주면 아래와 같이 적용되지 않습니다.\n"},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 697px; "},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/e538de1361186e34fd1bb296a0773730/11663/2022-11-07-aop5.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 19.6%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAABJ0AAASdAHeZh94AAAAtElEQVQY022O4Q6CMAyEeRETFBls3egGiiGIEpVofP/3OVmJxhh/fGnT3F0veU5XXE79wtDjdh5wPLSoiFFzg6E/YRf2cKYChwDvAmrfLHAtmghbL5rEOidmRx7FVkNlJfKNmsnnvYApCaYwM4RD2+E+PTAOo3i+iWESqFQOawnBMawmaKWRpdmHdLVGmRdgWh43fodQ1bPW/SXRykhgt2cxxSaxUby/J5NFGyoxUGmFd6NfXn8gercIf6tNAAAAAElFTkSuQmCC'); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"test-fail","title":"test-fail","src":"/static/e538de1361186e34fd1bb296a0773730/11663/2022-11-07-aop5.png","srcSet":["/static/e538de1361186e34fd1bb296a0773730/0eb09/2022-11-07-aop5.png 500w","/static/e538de1361186e34fd1bb296a0773730/11663/2022-11-07-aop5.png 697w"],"sizes":["(max-width:","697px)","100vw,","697px"],"style":"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;","loading":"lazy"},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"이번에는 AopContext를 활용하여 아래와 같이 수정해보겠습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"java"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-java"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-java"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"public"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"void"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"init"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"MenuService"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"AopContext"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"currentProxy"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"progress"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"public"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"void"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"progress"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"System"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"out"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"println"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"PROGRESS\""}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"그리고 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"@EnableAspectJAutoProxy(exposeProxy = true)"}]},{"type":"text","value":" 옵션을 적용해서 작동시켜 봅니다.\n"},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 563px; "},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/93516c3962ab6fe2b965d04d916c541c/e80ce/2022-11-07-aop6.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 18.4%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAABJ0AAASdAHeZh94AAAA00lEQVQY01WP3WrDMAyF8yAbTVv/ylZsJ01YQtYNyqBlN3v/lzmTDR3s4kMCHR3pdBQ9mPgPc7ZQRw19MtL/hywhuIDoI9gz1lCwUsHkE67DBRtP6LRW8GRFxAgitMrCKINzf8Lh5YD+tW/UXh2VzF2jGn5/fuHn9sD944b3vGCWAx0ZuRoI01SwzSPGISNxaV847RveeFjtkCPjkhOWMaFwxjKv2PcrtrcdHBPIRXR1wQrMhHWKEsu12E4MnoZPzUCEEgNGDkiBRRtQH6q1JmQa8AuTq3iMgQVpAgAAAABJRU5ErkJggg=='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"test-success","title":"test-success","src":"/static/93516c3962ab6fe2b965d04d916c541c/e80ce/2022-11-07-aop6.png","srcSet":["/static/93516c3962ab6fe2b965d04d916c541c/0eb09/2022-11-07-aop6.png 500w","/static/93516c3962ab6fe2b965d04d916c541c/e80ce/2022-11-07-aop6.png 563w"],"sizes":["(max-width:","563px)","100vw,","563px"],"style":"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;","loading":"lazy"},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"aop가 작동하는 것을 확인할 수 있습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"두 번째 방법은 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"자기 자신을 호출하는 방법"}]},{"type":"text","value":"입니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"내부에서 프록시를 호출하면 인터셉터가 작동하지 않으므로 외부에서 호출하는 방식으로 해결하는 것입니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"@Resource"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"@Autowired"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"@Inject"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"등 여러 방법이 있습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"모두 적용이 가능하지만 이번 예시에서는 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"@Resource"}]},{"type":"text","value":" 어노테이션을 사용하여 AOP를 적용해보겠습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"java"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-java"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-java"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"public"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"class"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"MenuService"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","annotation","punctuation"]},"children":[{"type":"text","value":"@Resource"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"text","value":"name "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"menuService\""}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"MenuService"}]},{"type":"text","value":" self"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n    \n    "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"위와 같이 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"@Resuroce"}]},{"type":"text","value":" 를 통해 빈 객체로 등록해주고 이번에는 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"self.progress()"}]},{"type":"text","value":"를 호출해줍니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"java"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-java"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-java"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"public"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"void"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"init"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n    self"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"progress"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"public"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"void"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"progress"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"System"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"out"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"println"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"PROGRESS\""}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"해당 방법이 성공한 이유는 외부에서 내부 빈으로 호출을 하므로 아래와 같이 aop가 정상 동작합니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 558px; "},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/affb2d369a238af7b33a70adad04b814/65207/2022-11-07-aop7.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 20.6%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAABJ0AAASdAHeZh94AAAAwklEQVQY02WPawrCMBCEexE1NUmbxyalqbUKKiIqFHr/64zbaEXwx8eGzbAzU7jawZFF8BGRIeuhSpXRW/2H0YY1hGgDTtTh6BOuocdACcFFFHIjoZWCdSYvnPGwlWUMynUJsRI8xfc9H7WVy9rpPmJ6jHhebmh9w0YBhTcEX3sQEY6HhPOQOGmTyX9ssGBZ14aI075FQxFt02GX+jzJxffB2VEJrrhVqDUn1RpSyMxS/ZdKcm2lswGZ8DElBD42p34BLFB3PjlLJuYAAAAASUVORK5CYII='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"test-success","title":"test-success","src":"/static/affb2d369a238af7b33a70adad04b814/65207/2022-11-07-aop7.png","srcSet":["/static/affb2d369a238af7b33a70adad04b814/0eb09/2022-11-07-aop7.png 500w","/static/affb2d369a238af7b33a70adad04b814/65207/2022-11-07-aop7.png 558w"],"sizes":["(max-width:","558px)","100vw,","558px"],"style":"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;","loading":"lazy"},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"*주의: 해당 방식은 2.6 보다 낮은 버전에서 가능합니다.\n스프링 부트 2.6 버전부터는 기본적으로 순환 참조를 금지하도록 변경되었습니다.\n만약 2.6 버전 이상에서 실습해보고 싶으시다면 아래의 설정을 추가하시면 됩니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"yaml"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-yaml"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-yaml"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"spring"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"main"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"allow-circular-references"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","boolean","important"]},"children":[{"type":"text","value":"true"}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://github.com/spring-projects/spring-boot/wiki/Spring-Boot-2.6-Release-Notes"},"children":[{"type":"text","value":"Spring Boot 2.6 Release Notes"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"마무리"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"지금까지 트랜잭션과 AOP에 대한 사실과 오해를 잠깐 맛보았습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"AOP는 내용이 많고 어렵기도 해서 추가적인 학습들이 필요합니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"AOP를 사용하면 부가 기능을 따로 추출하여 비즈니스 로직에만 집중할 수 있는 장점이 생기지만\n잘못 사용하면 그만큼 side-effect가 생깁니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"이 글을 읽고 낯설었던 aop에 대해 한걸음 가까워졌으면 좋겠습니다!"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"References"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://docs.spring.io/spring-framework/docs/current/reference/html/data-access.html#transaction-declarative-annotations"},"children":[{"type":"text","value":"공식 문서"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://stackoverflow.com/questions/34197964/why-doesnt-springs-transactional-work-on-protected-methods"},"children":[{"type":"text","value":"stack-overflow"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://www.youtube.com/watch?v=MFckVKrJLRQ&t=19s"},"children":[{"type":"text","value":"JDK Dynamic Proxy 와 CGLIB (1)"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://www.youtube.com/watch?v=RHxTV7qFV7M&t=291s"},"children":[{"type":"text","value":"JDK Dynamic Proxy 와 CGLIB (2)"}]}]},{"type":"text","value":"\n"}]}],"data":{"quirksMode":false}},"excerpt":"들어가며 트랜잭션을 공부하다보면서 자연스럽게 AOP에 대해 접하게 되었습니다.\nAOP를 사용하게 되면서 직접 경험했던 사실과 오해에 대해서 공유하려고 합니다. 첫 번째 사실: public이외의 메서드는 AOP…","timeToRead":4,"frontmatter":{"title":"AOP에 대한 사실과 오해 그런데 트랜잭션을 사알짝 곁들인..","userDate":"15 November 2022","date":"2022-11-15T13:10:00.000Z","tags":["aop","proxy","transaction"],"excerpt":null,"image":{"childImageSharp":{"fluid":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAA7DAAAOwwHHb6hkAAABKUlEQVQoz62SzUrDQBSF+6Y+hM/gUhciVARxq1Js1eJO608UN26G0iqYJkGrKWLb1LRJ2s4c58fIjAzWgBcuc2cm+ebcwy3hn6OUF4yx79VWFwKaAGrAxF6lrTYftyoUQem8kCr9X0NhMhtj43YZK40l+IO2PO9PejLjbIiXUYenh1E6wDB5k2lVSJlS5PiHqLbK6EauhPTiJ+yRNTQ6FeySVRy1t1BrbeLkYQf1+21ceAeaNUxXqHx7jh5x5u7jOjiW0GQa48qv4ZwDyauD8COA+06kykpzHZdeVVn05ecPDxVUtHrXPeXtx4ZHM5qBhA5ugjq/m2CcRUj5+quHOVQH5XfTecptCLl/fanINm4GMD8QHwtPF82ibWSMlheNhG6+DfRnYNH4BAO+pQBPFj8UAAAAAElFTkSuQmCC","aspectRatio":1.6577540106951871,"src":"/static/4cbd5a9cfa0c8988af4ff5541eb921f3/c9459/spring_aop.png","srcSet":"/static/4cbd5a9cfa0c8988af4ff5541eb921f3/3a443/spring_aop.png 930w,\n/static/4cbd5a9cfa0c8988af4ff5541eb921f3/c9459/spring_aop.png 1064w","sizes":"(max-width: 1064px) 100vw, 1064px"}}},"author":[{"id":"4기_기론","bio":"우아한테크코스 4기 기론(김규철)입니다 :)","avatar":{"children":[{"__typename":"ImageSharp","fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/2wBDAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/wgARCAAUABQDASIAAhEBAxEB/8QAGQABAAIDAAAAAAAAAAAAAAAAAAYHBAUJ/8QAGAEAAgMAAAAAAAAAAAAAAAAABgcEBQj/2gAMAwEAAhADEAAAAd9CseobeNMFigYi5V2WaIUU8CNZn//EAB0QAAEEAgMAAAAAAAAAAAAAAAIDBAUGAQcAERT/2gAIAQEAAQUCLXaawStB8Aqa7wJnaa40Tt94l7dxtboBqyGKbOsxvUTmrSq4x/8A/8QAIhEAAgEDBAIDAAAAAAAAAAAAAQIDBBEhABIzQRMxMlKB/9oACAEDAQE/AY6yVa1VqVpTTTO6U4i55Cd5gVVink+S7CzSIlrkMF0BR2HB+st+vedQzSiqpAJZAFdioDsAD5GFxnGMY6xqBm8EWTxp2fqNf//EACQRAAICAQIFBQAAAAAAAAAAAAECAwQRAAUSEyEiMTRBUXSy/9oACAECAQE/AZNvrPtbNRm3Jb1eKCS49ntqwKvKFtmezVhzwMZQiwyyk4BUuM4Z914j3XT1PULJg9fIwuMfGrEEDUbxaGJi8aByY0JYcqNsMSO4cRJwfc586u+stfYl/ev/xAAqEAACAgEDBAEBCQAAAAAAAAABAgMEEgUREwAUISIGQjEyQUVTYXGRof/aAAgBAQAGPwKOejNcIkSONO5npNEK4PA8uLxGQvDGGaIkZSSouT7nLp5ZNXihhSDCeSesqqYZnxymaGU/XgPTjHoufgsSQ+o2iR+nFAi/0Q5/3rSvlXZ6VHrIi01K897UbPeQ1b5jqyLJSjuLVzrU7c2Y4SMkzY7+3WpfHfjVXKeOQGtqGm6tXhW5TruoJwkxfheSwhYJYzOA++AQaEGqa9STUIqFSO33NlOd7EcKpNJIQTuzyq7Fvq+38eq7TNM5dS7Hk87jDbzjvsP53/fqezTAWZIQgd/Y8fcVZ2jJ8Eq7QKGJOeBYKy7gieJIKCLFfs/l9OV3axhckeWWxDNK7cll0Ul/WJYowNk6/8QAGxABAQEBAAMBAAAAAAAAAAAAAREhADFBUYH/2gAIAQEAAT8hOPn+DE8A2pYOjfRglkxA+KDiZpSXGZn7xdJz2A4cTUdpFoiYwLqC1wKdmcFUdioD0H4Nq946KsaLESFKT44zgOQc9+Co+OOghC7fUzAPCOQL/9oADAMBAAIAAwAAABCn/wCA/8QAGhEBAQADAQEAAAAAAAAAAAAAAREAITFB4f/aAAgBAwEBPxCwvs2WFSQDSHt2CGFEh8VdIDd9xNWYZNEAklAYOCZ9jxT3P//EABoRAQEBAAMBAAAAAAAAAAAAAAERACFBofD/2gAIAQIBAT8QN2YIjMy2GkhY4bKQPKIgFwwBJOsTwqSzOUAVQYFLvsdSeb//xAAYEAEBAQEBAAAAAAAAAAAAAAABEQAhYf/aAAgBAQABPxDo/XpkQnykvtAlttOiHba6C3YDqQf0AovaOCVELdmmV+6MkGxFIH7xp/syTIddN1+4kLc6YoxlezqNalwJlS2/6OXNRTVNaVDa56T1hFoT/9k=","aspectRatio":1,"src":"/static/264a2517af906c5a1c3c22b6f4c181cd/2f1b1/giron.jpg","srcSet":"/static/264a2517af906c5a1c3c22b6f4c181cd/b3d27/giron.jpg 40w,\n/static/264a2517af906c5a1c3c22b6f4c181cd/5a735/giron.jpg 80w,\n/static/264a2517af906c5a1c3c22b6f4c181cd/6e81a/giron.jpg 120w,\n/static/264a2517af906c5a1c3c22b6f4c181cd/2f1b1/giron.jpg 800w,\n/static/264a2517af906c5a1c3c22b6f4c181cd/c4b07/giron.jpg 1440w","sizes":"(max-width: 800px) 100vw, 800px"}}]}}],"source":null}},"relatedPosts":{"totalCount":2,"edges":[{"node":{"id":"cb941db5-d550-5213-8c6b-ce00a6e4fff1","timeToRead":4,"excerpt":"들어가며 트랜잭션을 공부하다보면서 자연스럽게 AOP에 대해 접하게 되었습니다.\nAOP를 사용하게 되면서 직접 경험했던 사실과 오해에 대해서 공유하려고 합니다. 첫 번째 사실: public이외의 메서드는 AOP…","frontmatter":{"title":"AOP에 대한 사실과 오해 그런데 트랜잭션을 사알짝 곁들인..","date":"2022-11-15T13:10:00.000Z"},"fields":{"slug":"/post/2022-11-07-transaction-aop-fact-and-misconception/"}}},{"node":{"id":"5a8145fc-4d1b-5dc4-96f0-1d64e0232543","timeToRead":6,"excerpt":"이 글은 AOP 개념이 생소한 입문자들을 위한 포스팅입니다. 1. OOP의 한계 image…","frontmatter":{"title":"AOP 입문자를 위한 개념 이해하기","date":"2021-06-25T12:00:00.000Z"},"fields":{"slug":"/post/2021-06-25-aop-transaction/"}}}]}},"pageContext":{"slug":"/post/2022-11-07-transaction-aop-fact-and-misconception/","prev":{"excerpt":"상황 스모디 프로젝트를 하면서 랭킹 기능을 도입하기로 했습니다. 랭킹 기능은 유저가 활동을 했을 때, 활동에 따라 랭킹 점수를 부여해야 합니다. 저희 서비스는 챌린지에 도전하고 매일 챌린지에 해당하는 활동을 인증하여 총…","timeToRead":9,"frontmatter":{"title":"스프링 이벤트 적용기","tags":["spring","event"],"date":"2022-11-14T13:10:00.000Z","draft":false,"excerpt":null,"image":{"childImageSharp":{"fluid":{"aspectRatio":1,"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAEEElEQVQ4y02TaVcaSRSG+f3zaTIzSWZJTswkZo4ToxgCKIgg+75D0zvdNLIJR6O4fHqmuiCOH+7pulV9n3rrvVWBXmGAmlgxat6iVzt4dYel+ojp3KLp16jpJcbZFUNljWHe4jSvuLTu6eVzTDpThtkOdjjJMpNjHj0m0C9dMYjN8Dr3OG0Fr2gxrc7RjBVN9YpO9pJ2rodpXjIcP+BVFWaxBPOaxqx8xYW+Rh/d4dRdVtqCQFtZYWu3XFQMFtE4t30VV2ugFSYY5Tvqh2MO919SqsVInSwZZrpcZzOsXRuv30MZrOiZ11iVawZnSwKqdYPmPjKqq6zS4kfbplgIEfkURsuO0co6Wj9Pt50glUyjN0xupy7tZoJSuIHRWNMsrlCzV5i5FQHH9ajXLeLBifDQYnWh49ltovFXJM7fMHG7zEcqE6eHa5UYO00WY4NS6YDg3i5O/pZ60Obrl/e4zpzAfNSjXIySy8UxtJoo7DMbDVh4OtORInKF8bCzmXc1ps5ArvubpvM7WEqLXj1HuxUVmysEZiNNDHpcuC2pRLOzpAfvqegH5LV/qBshMurflPV9qvohZW2fgphvmmEMNy9r5uMBl2OT6QaosglNThrDPMf9Xwn1fpKgkv6ZU+U1aXWHc/UdOXVXwhPKH3TMGEvPlsqmQvXMUwXQ0zZAkVyOLaEwQ0x5KSC/C8h7FDslNvhFRts6Jqt+EPGR1OAtHeuE5dhm6g2ESh2ftVHoQ0X4ZrtuQ6jap2Yc0TC+oQ2zsrBrncqxaqdpm8fy659m4ZlSzA9G4MdAAj0Dx6mT03ZlUcuMUDdDVIwDivqe3KRqBMX4X2nFaNQWygz+Z6jPgaqU3zajFLU94d8H6Zn/jfZfEOn/LPIdYccrTvq/CQ//xHaqUsSTwpH6/MjCw5FJ14iRVN6ITu88dbsiuusrq2hfqGqH0sO8+glrWNoCN/Wyy5vubFRO3YG8yJ1hBMPJorsZ1OE5NfOQhvWVvvCxZ8VoGWHhbwh7WGYu7utsvAFO3L4AblvuwxZjlWblnMxplEI6RjoRIR4NEgsHyZ3HKGbipGLfOAkdUEjF6dRFU8TL8mt9xmTYI+C/gKewu7hKDb1VwGqXMJsF7FYRU+R2pyjDlGtFHPHfSG2Il7OtFbALu7MF+omnMK+XWL/d4/7jIQ/fEjyEEzye5XmIJEV+yn3olIdokvujGOudz/LfRa0kayfDrnzv8sg+cHKhsqgWWb/a5e7dPve7RwKU4vEkI8A+UMSRAIbO5NrdX3vcvd7lslxgIqyaijf/1BTpozB20anxPRjh5vScm+MzbuKpTfjjk+QmYkm+h+Obua/HLFpVWTvb+vjs6W3vo7+BUOzvONuGHIsCWSTz/mbuxw15Vv8fcBBx48HddTAAAAAASUVORK5CYII=","sizes":"(max-width: 800px) 100vw, 800px","src":"/static/9bdf05c582ed968c2c758e7b7bba79df/bc8e0/spring-event.png","srcSet":"/static/9bdf05c582ed968c2c758e7b7bba79df/bc8e0/spring-event.png 800w"}}},"author":[{"id":"4기_토닉","bio":"우아한테크코스 4기 토닉(최우석)입니다 :)","avatar":{"children":[{"fluid":{"aspectRatio":1.5037593984962405,"base64":"data:image/jpeg;base64,/9j/2wBDAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/2wBDAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/wgARCAANABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAcFBgj/xAAWAQEBAQAAAAAAAAAAAAAAAAADAQL/2gAMAwEAAhADEAAAAcxoVyK2pDFjNB//xAAcEAABBAMBAAAAAAAAAAAAAAAFAAIDBAEGEhX/2gAIAQEAAQUCnE0PKL60Kkv51Uci12VottiVyaV5z//EACARAAIABAcAAAAAAAAAAAAAAAECAAMRQRIhMkJhgfD/2gAIAQMBAT8BaXiks9M1pwNQBre8CW52r7uP/8QAHhEAAQIHAQAAAAAAAAAAAAAAAQARAgMxQULB4fD/2gAIAQIBAT8BzEJpfTJ5Y9xf/8QAJBAAAgIABgICAwAAAAAAAAAAAQIDEQASEyEiMQRBI1JhcZH/2gAIAQEABj8C8uQwpqxwFlbKNjYHv9+8HSCpGvk+VA2lGycoXVWUnKNTLdBuQ7pjvgASzsqilsvxFk5V22Fkmh7JPZOPMjXiDEV4mj2Px6O+LkYv80jb/eWnle/Zc1/MOhgvI1WJau1VutM/au8f/8QAGxAAAwEAAwEAAAAAAAAAAAAAAREhMQBBUWH/2gAIAQEAAT8h1JigrRheOG7IBcGRLGjb8Rn0OaIkYZ+CcwbAfHQSQeyMdLj4136o5RYz5TLjAjBMg3zr0NONc//aAAwDAQACAAMAAAAQfC//xAAaEQEBAQEAAwAAAAAAAAAAAAABESExcdHw/9oACAEDAQE/EAGDWNEwBBGZE3onAhxY98e3wX//xAAcEQEBAAICAwAAAAAAAAAAAAABESExAFFBcfH/2gAIAQIBAT8QLZKcEVyXQhEbbca4sj4xr10Dv7L/AP/EABoQAQEBAQADAAAAAAAAAAAAAAERIQAxQVH/2gAIAQEAAT8QLmAMpkrOnCRb95FfsRGhxDLm9cSASZ6QmFg3RXDQFhgAG4CQVVp5pl6rZbAmJFSmsPUkj2FJSnRlH0H/2Q==","sizes":"(max-width: 640px) 100vw, 640px","src":"/static/1081885cea1361e492c86b1f35c90fb1/3bf7d/tonic.jpg","srcSet":"/static/1081885cea1361e492c86b1f35c90fb1/fd013/tonic.jpg 200w,\n/static/1081885cea1361e492c86b1f35c90fb1/25252/tonic.jpg 400w,\n/static/1081885cea1361e492c86b1f35c90fb1/3bf7d/tonic.jpg 640w"}}]}}]},"fields":{"layout":"post","slug":"/post/2022-11-14-spring-event/"}},"next":{"excerpt":"용어 설명     Cycle이란, 사용자가 특정 챌린지에 도전할 때 생성되는 객체이다. 비즈니스 규칙 상 하루에 한번씩 총…","timeToRead":8,"frontmatter":{"title":"데드락 해결 모험기","tags":["Mysql","DeadLock"],"date":"2022-11-21T15:00:00.000Z","draft":false,"excerpt":null,"image":{"childImageSharp":{"fluid":{"aspectRatio":1.332378223495702,"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAIAAABr+ngCAAAACXBIWXMAAAPoAAAD6AG1e1JrAAADU0lEQVQozw3SaVPaCADG8XzXnd1Ou8fs0Wm7OlWoUxWpFBCNgkCEyFVBQYoYTiEYDCScOclJAiGhY+3sS98sH+B58X/mB2RTZ5fxUDp55g0H3CG/L3icuYpPONKcTzSVVmRmrk8W2ogf1nSmQZQiSOTjzvpLl2dv0MeAbBI6h0Akn+p0m2cp2BP2J3OXjWb9rn4jCn0cf2ijFZMqEuXIoAh67a92HfZKHVnoE21GA5ex4FUi3MUqy4WoylRvQAqCUKjVgnC0WS0QBDkimuNSGDrddri3YjFIlsZLUxgqWEX8CtSQLM8Q+pSbaaxlKt8fl8ZcvCnEC3lY4oemZf33/fFgf9Puc1Is8WhJqkahcgmRs1UlD1gzfmkIHD/UpoxpCNqUFhjcGBXpsr/2xUPTFDOZBKqVE7SJkdhUY4wZL2oDVCpjchXIDbuMwsp8TxbGltimm3GlHR/cBpybv3l8rh9PT5n89U9OxwYcdcXOoQeUpAlL4xbziaHzwGkbSzbrSPsO6yAmdVtJeSK+9w77PxB0wrOD5+dnSWTDkcCvto3XoeBBpQymv6TwFk51v+ZSwJtw8DUc9TXu0uTDTdK99fbF6v3+qGOZoqyOl8tv85liLiYDAt3xuX+2b2wlzt3VymEi4YxHgV3P/lvn7r9QaO+2uAbD3mKBVdmnuUApOMahNM3cD9Ge2DINWVWoUSNZzPnfBEBvIgo27wAQDh+ETmyfHC8+2G2pZIToQtVSfdwVNJZTuyhb60sdRaVMtsxhmXm/UI58tNv+Xj/eX4UB3rD/Mp/mGAJtIvZ9xy+fXWsx+Kx9n+3iHDec64wltESyouAZ5NwR3Plrc+2P5EXsvlFyHx8APfJ+MeONOf/NkBRxdB4/C8Qj4G3RfpUGUxCFl7VerpX2ZI/WN9+9CkaCY6r7aMnmXDB0DlC0MS7fNSWEUrsznV0uBHqM7/sPo5ewjKfIQhBNOLfXXx6CXqLfXkFYmZemw47cwKQaUJMLJfm6rOTqcpGfDjVN0Pi21rkQ0AsyD7o//G6zvdt2u26QnCIOLEPUdKYll2/lq9pKWF0prPY9FVWn9KPUEvEr8SHfuQkkj97vbf7p8n46gqGjaOjz6TEIBcqla1Ue6zpDKug1n/kfNk+XFlMqN+AAAAAASUVORK5CYII=","sizes":"(max-width: 1600px) 100vw, 1600px","src":"/static/9a8e208eb938af089c498336dd233cf0/00405/deadlock_teaser.png","srcSet":"/static/9a8e208eb938af089c498336dd233cf0/3a443/deadlock_teaser.png 930w,\n/static/9a8e208eb938af089c498336dd233cf0/00405/deadlock_teaser.png 1600w"}}},"author":[{"id":"4기_알파","bio":"우아한테크코스 4기 알파(배철환)입니다 :)","avatar":{"children":[{"fluid":{"aspectRatio":1.2048192771084338,"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAABYlAAAWJQFJUiTwAAAEO0lEQVQ4yx2U6VNTdxSG8zf6B3SmH/qhnzo6sgRwaV0RLc7U0daFqShaa62ogCDERCIEst1sJLlJSEI2kpDlroEg06cnfLhz59479/m957zvOY4r+i1G9WnGtEmcxgyjtpvz1jpDhofz+xEu7e1yJaVwI65wNRHlYv4L55sfGTnyMmKvMm7+wbh+E6d2h1vaDRzD+l3G9ElGrKcMHaxyKbfE3cgCzxUP7niShJqiXq3Qqddp1KrsqCofoxtcXXnGteRHxsrvGdLu4exNMSIsx5goHCi7mlnmQ8hLOqOiNVpYHY39ShnbsjBME90w5K5j25YcsE99r0o+lyOY2mEuuMRldVo4kwK0ZhmqruANB/nPPsLu9TjsH5EvFHB7PBwfHwvEpifvbbvH8bdv+La2SKZTnJyc0Bt80yzi0Sg3U/dxOA0XQ10Xs8oaWqtDq92mWq0SDmzz5MlDtrd95HezpNNJ1EyKbFYlEPCz5lqmVqug6TqGZdIo17gTXRSg7sJprzNS8OMNKZRLe6yurdBtVcmkoqQSCsVcmnw2SUGutBjj93lpNUsEglt0tS7JaIzZjQVGO54B0M2olRczMhRLFUKhEGuflsgJLJuKYGsH2GYHQz+g39NoVAuoO2H5FiUWDVISAdthBWfOI8asC1DLMWzpPAgG6IkRkVhMlMWpFjLS/CKx4CaT333HxJkz3JuepF4rUs5nKOVVCrsqqrQiXchzsTzgpHCMG3WG2g3eREL0xVE1k5HSUvTNLkeibFDmo+9/YPnHn3g4MobWaWB3Ra2liREK1UqFUrnIBenvqF3HMWH6OVfPsxxNcCJOVqo1McSH1W2iNWuYRpvg27ds/3KNiPTWNFqY7Tr1coGQmNM/OkSV+FzORwT4ddDDNZEa4JHfK+FtcNTvE49HKRWyksUmpoBrezkCq8vSvyJmp356RSRmFVF3cvwNtyRibN8lXrgHsfHK6H3msWuer243jWYTz7oHVY2flqwd1DCkzEO7iyHKLCn3oF5kY3Md07Qo7OVZ+vCO64kFhm2vAHuLTMiUqKJqN5PE4/3Cp+ezRD1rNPZLWK0mdquBJWCrXaN7sMeOEuL9q3fUG3VevXqJsrnB64Cbs+2/cYwa00w03/HMt0pg6yuhRIyVP5+T+/A78fRL1vzzrMfW8SgB3rv9/LsYQp3J8nnORVgWRkJS4XZ95np2Fqd5ezDLUxLsu5zdf80/W1841E3pTQ1lY57s3gxv9ce8MHy86HaYUyxWPkmZj/Osvlkhs5uhWWlybfO+GDIlS+aOKNR/ZVyTBWFNc6E2z5yEejAtmmESiW6zoLzhRdLDk3icpysJlhcVdvwxDNsg7A/zwDfDmChzGrdPOY7f9J/FlMHDFMO9aW7G/mK/VDvdKr3eEVpbp1KqyiFVUV6SUWtjH9oc9/p4ZY2dK15hXP67KPt0RrvE/zcbfpD8bYMhAAAAAElFTkSuQmCC","sizes":"(max-width: 348px) 100vw, 348px","src":"/static/de921188844e6d769c2bc82372a8276d/fffbc/alpha.png","srcSet":"/static/de921188844e6d769c2bc82372a8276d/8ac63/alpha.png 200w,\n/static/de921188844e6d769c2bc82372a8276d/fffbc/alpha.png 348w"}}]}}]},"fields":{"layout":"post","slug":"/post/2022-11-01-mysql-dead-lock/"}},"primaryTag":"aop"}},"staticQueryHashes":["2130001345","4041952199"]}