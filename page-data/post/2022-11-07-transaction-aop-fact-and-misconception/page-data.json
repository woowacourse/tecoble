{"componentChunkName":"component---src-templates-post-tsx","path":"/post/2022-11-07-transaction-aop-fact-and-misconception/","result":{"data":{"logo":{"childImageSharp":{"gatsbyImageData":{"layout":"fixed","backgroundColor":"#080808","images":{"fallback":{"src":"/static/0b18bd94a62a12fdc81ea720c28722f6/a9770/tecoble.png","srcSet":"/static/0b18bd94a62a12fdc81ea720c28722f6/a9770/tecoble.png 400w","sizes":"400px"},"sources":[{"srcSet":"/static/0b18bd94a62a12fdc81ea720c28722f6/65935/tecoble.webp 400w","type":"image/webp","sizes":"400px"}]},"width":500,"height":110}}},"markdownRemark":{"html":"<h2>들어가며</h2>\n<p>트랜잭션을 공부하다보면서 자연스럽게 AOP에 대해 접하게 되었습니다.\nAOP를 사용하게 되면서 직접 경험했던 사실과 오해에 대해서 공유하려고 합니다.</p>\n<h2>첫 번째 사실: public이외의 메서드는 AOP가 걸리지 않는다.</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 365px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/af573b452edb91f619a33bf55f35f8e3/dbde8/2022-11-07-aop1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 41.917808219178085%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABJ0AAASdAHeZh94AAABlUlEQVR42mWQyY7bMBBE9RuBAyeYzFiyJFsLd1GUKEv2LIcgQHLK//9HpUQghyCHQrPZ5OvqzpreQK9vUPMNMt4hA+O4QDDq5Y6m06jyCvX5goqq/1P9T54pNcAT4H3EFB8YCHJuwjxtCHGDNR6611C7OoW+EZCMopUQjeRZQ6R8r0lkq/T4ISf8lDN+ywVbY3HrLL53I5bWYqX77cZGZsRgR7TXHlI4aOXRE+bSfYAfZngXkDV1iw+6/MXHj8njYx4wOY11IjhYbMzX4BC9wWhUqs1U9NSgk1Pv2OjS4lo1yErO7TuJVVvMo8Lbwk+mx2vUuE8KW9glk4IRhGu8LwaPSM0aHR1b5RLsUl6RFc8FitMZXSvYpYOWFlb79FAJyxE7SO4vcMf7yMfDEZ8/HXGgjoevePryhNO3U1JyWLwUqIqKS1cw0mCNC6YxcDcOYRjh6Hw/G6lTXTQtmvqKvu0JeUnAMw3lz/lf4BllXtKZgVEWyxwJMXSnEyyGyHuTdqSFgrcD32qMzqMkaAfupnJOugP/APZiAnX0CzSJAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"2022 11 07 aop1\"\n        title=\"\"\n        src=\"/static/af573b452edb91f619a33bf55f35f8e3/dbde8/2022-11-07-aop1.png\"\n        srcset=\"/static/af573b452edb91f619a33bf55f35f8e3/dbde8/2022-11-07-aop1.png 365w\"\n        sizes=\"(max-width: 365px) 100vw, 365px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>실제 인텔리제이에서 private 메서드에 <code class=\"language-text\">@Transactional</code> 을 선언하면 위와 같이 컴파일 에러를 띄워줍니다.\n해석해보자면 private을 사용하지 말라는군요!</p>\n<h3>왜 private 메서드에는 <code class=\"language-text\">@Transactional</code>이 붙을 수 없을까요?🤔</h3>\n<p>해당 원인을 파악하려면 먼저 프록시에 대해서 알아봐야합니다.\n스프링 aop에서 프록시는 크게 <code class=\"language-text\">JDK Dynamic proxy</code>또는 <code class=\"language-text\">CGLIB</code>으로 작동합니다.\n그리고 spring boot 1.4 버전 이후부터는 default로 <code class=\"language-text\">CGLIB</code>을 사용합니다.</p>\n<p>CGLIB은 동적으로 상속을 통해 프록시를 생성합니다.\n따라서 private 메서드는 상속이 불가능하기 때문에 프록시로 만들어지지 않는것이죠!</p>\n<p>그러면 아래처럼 <code class=\"language-text\">protected</code>나 <code class=\"language-text\">public</code>으로 메서드를 만들면 정상적으로 트랜잭션이 동작할까요?\n정답은 protected일 때 또한 정상 동작하지 않습니다🥲</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 203px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/6bd9ea66b78dcca5fcf91445b4e191f8/187ee/2022-11-07-aop2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 25.615763546798032%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA90lEQVR42nWQy27CMBRE8zdV4sRv14kDpCLlpQIVaYAIsaiqbvv/y+lN0pZuWIw0c2zNvXakH0v4egXlArTNoWwBaTyUyUfmCvIe2peQyiGNM2QJv6so7M8oXw8odi1mbYfp8YrZ8YKwaxC2LSry06bDpDkPpeyBIU2yoXgQlfwfEmlu4JiEjTlsIqBjMWZGnsSJu2RkirLkGkpoaGGgek/S0twK32yFq6twck/4zBfo3BwX8l9hg430WKsS777GR77EijvUyzUO9KLtyx7P8wWCD6TyVmiYAu/X7gEbISP9Mv5zkbMx95tZ+ksjLWSmIFJJZ+Kv8BtNaqMB8CAneAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"protected\"\n        title=\"\"\n        src=\"/static/6bd9ea66b78dcca5fcf91445b4e191f8/187ee/2022-11-07-aop2.png\"\n        srcset=\"/static/6bd9ea66b78dcca5fcf91445b4e191f8/187ee/2022-11-07-aop2.png 203w\"\n        sizes=\"(max-width: 203px) 100vw, 203px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span> <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 180px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/67116898ef1328f37a97abf57cb70666/e9ea2/2022-11-07-aop3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 31.666666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABL0lEQVR42mWQS2/CMBCE82daILYTx06MnUcjUwgECC9B1XKpemlP/f/H6fKooOrhkz1e7+xqAjdboT4cMfQN3LRD3q7hJnNYws062KbDcHSqLVEstzD1M3iPQbAYIoz+ETztj7DTORJXwy13yBdrYodqs4eZzGDGLWy7giPKzQFp6cEeGfjJYCDAiT+GMowh+xyOSbh+BN3jiKlBPAyg+wKG6imdkraKqUGJBJky0DKFkhop3SWXZHw1fMk8vvIpvosWr8bjbTjCQueopMWna/Bux/ggvHYYNy22mx26xQrNc4PcVfC1R0JDfjcNbJQiEwqKpmiu4EgntG1MOuEJjNCEOuvClShsgTKvaLMMkoxi+hPd5RmwUICdsiDBiDC8ZcLPtcv7WV8zu3HJ8T7DHzvYw7wJRKS/AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"public-method\"\n        title=\"\"\n        src=\"/static/67116898ef1328f37a97abf57cb70666/e9ea2/2022-11-07-aop3.png\"\n        srcset=\"/static/67116898ef1328f37a97abf57cb70666/e9ea2/2022-11-07-aop3.png 180w\"\n        sizes=\"(max-width: 180px) 100vw, 180px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>분명히 인텔리제이로 확인을 해보면 컴파일 에러는 나오지 않는데 말이죠. 해당 이유는 앞서 말했던 JDK Dynamic proxy 가 원인이었기 때문입니다.\nJDK Dynamic proxy는 인터페이스를 기반으로 동작합니다. 따라서 protected 메서드에서는 프록시가 동작할 수 없는 것이죠.\n그래서 스프링에서는 일관된 AOP적용을 위해서 protected로 선언된 메서드 또한 트랜잭션이 걸리지 않도록 한 것입니다.\n즉, 프록시 설정에 따라 트랜잭션이 적용되었다 안되었다 하는 변칙적인 결과를 막기 위함인거죠.</p>\n<h2>두 번째 사실: 같은 클래스내에서 트랜잭션이 걸린 메소드를 호출하면 트랜잭션이 작동하지 않는다.</h2>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">A</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">progress</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token annotation punctuation\">@Transactional</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">progress</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>예를들어 다음과 같은 상황에서 <code class=\"language-text\">progress()</code>는 정상적으로 트랜잭션이 적용될까요?</p>\n<p>이번에도 안됩니다.</p>\n<p>Spring AOP에서 프록시의 동작 과정을 보면 프록시를 통해 들어오는 외부 메서드 호출을 인터셉트 하여 작동합니다. 바로 이러한 성격때문에 <code class=\"language-text\">self-invocation</code>이 라고 불리는 현상이 발생합니다.</p>\n<p>프록시의 내부 빈에서 프록시를 호출 했다는 것이죠. 그림으로 보면 이해하는데 도움이 될것같아서 그려봤습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1440px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/230f19e03e489df6862ff483c3371996/89066/2022-11-07-aop4.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 69.8%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAABjklEQVR42o1S2W7CMBDk/z+I90o8lkogoYBUAZHa5iBOnBPbSZh6l4QmlKasNLKVtScz65lhokzdwI8yxGmFShk8U7OpZnnWeHM+8PL6jjDOYZoGZ11DmTHoG/UmCUndZyCZNMkqpPkZiVX6CNL2A5Gjbtq/CbVp2CpVY//edAru63K58Epn6c4koZAl7/0gwPHoQkqJwO5Pp9MNvu8jy1LIQkFb6zP6wxA3y6zwSpimKYqi4D4p1Voz2rZFVVUQUYSs0FBE2BPQwSGhHhDKjpDKdV2sVitst1smNMYgjgXSnnC322GxWGC5XOJwOCDPc7705fn2kBoppFJKMUghCaB1RBiGIRzHwX6/t7PI+FBr1RZlxa/LCmWKsryq3Ww2LGA+n2O9XkMIYfuJTYEaW/4Vm7sZ9oS09zwPJIT25EgmMbtRzz6K7C4OY3KbtbUsRPRjeSrYfQ5pZhQPigkpC210eLXw7KyLImfL2tT/5fD6EG1r1ZO6B2g7wZTZyWA3NhKByJj0P0RJzuOhcXwD7wQ/6h4VgLYAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"proxy\"\n        title=\"\"\n        src=\"/static/230f19e03e489df6862ff483c3371996/89066/2022-11-07-aop4.png\"\n        srcset=\"/static/230f19e03e489df6862ff483c3371996/0eb09/2022-11-07-aop4.png 500w,\n/static/230f19e03e489df6862ff483c3371996/1263b/2022-11-07-aop4.png 1000w,\n/static/230f19e03e489df6862ff483c3371996/89066/2022-11-07-aop4.png 1440w\"\n        sizes=\"(max-width: 1440px) 100vw, 1440px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\nmain메서드에서 그림과 같이 A의 init()를 호출하고 init()에서 progress()를 호출하면 그림과 같이 프록시 내부에서 호출하게 됩니다.\n따라서 proxy가 인터셉트하지 못해서 트랜잭션이 동작하지 않는것입니다.</p>\n<h2>오해: 그렇다면 내부 메서드에서 호출은 AOP적용이 불가능하다</h2>\n<p>해당 주장은 사실이 아닙니다. 공식문서를 잘 보면 해결 방법이 있습니다.</p>\n<blockquote>\n<p>self-invocation(in effect, a method within the target object calling another method of the target object)\ndoes not lead to an actual transaction at runtime…</p>\n</blockquote>\n<p>타겟 내에서 타겟의 다른 메서드를 호출할 때, 런타임에 실제 트랜잭션이 작동하지 않는다고 합니다. 즉, 런타임 시점에 작동은 안 하지만 이것을 컴파일 시점에 적용하면 된다는 것이죠.</p>\n<p>그렇다면 어떻게 컴파일 시점에 프록시를 적용할 수 있을까요?</p>\n<p>스프링에서 AOP를 구현하는 방식에는 스프링 AOP도 있지만 AspectJ라는 강력한 도구도 있습니다. AspectJ는 스프링AOP와 다르게 컴파일 시점에 위빙이 이루어집니다. 따라서 AspectJ를 사용하면 self-invocation문제를 해결할수 있는것이죠!</p>\n<p>그런데 만약 Spring AOP를 쓰고있는 상황에서 이런 문제가 발생하면 어떡하죠? 이럴경우 다른 방법도 존재합니다!</p>\n<h3>첫번째 방법은 <code class=\"language-text\">AopContext를 이용하는 방법</code>입니다.</h3>\n<p>AopContext의 <code class=\"language-text\">currentProxy()</code> 메서드는 현재 AOP proxy를 반환합니다.\n이번엔 코드로 확인해봅시다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Aspect</span>\n<span class=\"token annotation punctuation\">@Component</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">AopService</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token annotation punctuation\">@Pointcut</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"execution(void kitchenpos.application.MenuService*.progress(..))\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">pointCut</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token annotation punctuation\">@Before</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"pointCut()\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">before</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>err<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"aop works!!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>우선 aop를 적용해줍니다.\nprogress() 메서드가 동작하기 전에 <code class=\"language-text\">aop works!!</code> 라는 에러 메시지를 출력해주는 aop입니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">progress</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">progress</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"PROGRESS\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>그리고 다음과 같이 실행을 해주면 아래와 같이 적용되지 않습니다.\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 697px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/e538de1361186e34fd1bb296a0773730/11663/2022-11-07-aop5.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 19.6%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAABJ0AAASdAHeZh94AAAAvElEQVR42nWO2w6CMBBE+RMvQAt0e6GgGJRGiJcY//97xm1JfNKHk810O7OTvR83LNMZS7hg5nm/BkynAYYsOtdjGgP69pC08x6t8ehYx13E2y7N+G6URWaM5c8tCwdZ1okylxC5gCwqqEqhkSunYcTz/sIc5mS25L5ErRuDTAoBTQqeg3VNbGxQ7Ark2zyx2+xRFRKONNNy2yO38sn8i6wRCkSE8ciXlOZA+jaK1Ly3ijD4tYGqCFTrv4Ef6cZ7Usr23mIAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"test-fail\"\n        title=\"\"\n        src=\"/static/e538de1361186e34fd1bb296a0773730/11663/2022-11-07-aop5.png\"\n        srcset=\"/static/e538de1361186e34fd1bb296a0773730/0eb09/2022-11-07-aop5.png 500w,\n/static/e538de1361186e34fd1bb296a0773730/11663/2022-11-07-aop5.png 697w\"\n        sizes=\"(max-width: 697px) 100vw, 697px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>이번에는 AopContext를 활용하여 아래와 같이 수정해보겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MenuService</span><span class=\"token punctuation\">)</span><span class=\"token class-name\">AopContext</span><span class=\"token punctuation\">.</span><span class=\"token function\">currentProxy</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">progress</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">progress</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"PROGRESS\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>그리고 <code class=\"language-text\">@EnableAspectJAutoProxy(exposeProxy = true)</code> 옵션을 적용해서 작동시켜 봅니다.\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 563px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/93516c3962ab6fe2b965d04d916c541c/e80ce/2022-11-07-aop6.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 18.4%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAABJ0AAASdAHeZh94AAAAzUlEQVR42lWQ606EMBCFeREVxULb6QVYCLLXbLLJ6g8T3/9lPgcwRn98mUl75sxpCwmOJJno40pdNZiXWmu99n/xjSBWcYHsM/uw4006Rt9ySiPHPFAYY/DeknxSYcQaS/PaUJUVz4/lL+XDE0aXrPdKqyE+r3e+bh+8X24c8sgUeop1axCGoWdW+tzRxo7gBFs73A+LUZcSY5eZ+qyalmk6cD5d2M9HgmyBCmvcOpiTMO8Cvl4SWpZz989QNSL0cSNLRJqwfYPWqC9c+AbtPXkUGyqzrQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"test-success\"\n        title=\"\"\n        src=\"/static/93516c3962ab6fe2b965d04d916c541c/e80ce/2022-11-07-aop6.png\"\n        srcset=\"/static/93516c3962ab6fe2b965d04d916c541c/0eb09/2022-11-07-aop6.png 500w,\n/static/93516c3962ab6fe2b965d04d916c541c/e80ce/2022-11-07-aop6.png 563w\"\n        sizes=\"(max-width: 563px) 100vw, 563px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>aop가 작동하는 것을 확인할 수 있습니다.</p>\n<h3>두 번째 방법은 <code class=\"language-text\">자기 자신을 호출하는 방법</code>입니다.</h3>\n<p>내부에서 프록시를 호출하면 인터셉터가 작동하지 않으므로 외부에서 호출하는 방식으로 해결하는 것입니다.</p>\n<ul>\n<li>@Resource</li>\n<li>@Autowired</li>\n<li>@Inject</li>\n</ul>\n<p>등 여러 방법이 있습니다.</p>\n<p>모두 적용이 가능하지만 이번 예시에서는 <code class=\"language-text\">@Resource</code> 어노테이션을 사용하여 AOP를 적용해보겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">MenuService</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token annotation punctuation\">@Resource</span><span class=\"token punctuation\">(</span>name <span class=\"token operator\">=</span> <span class=\"token string\">\"menuService\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token class-name\">MenuService</span> self<span class=\"token punctuation\">;</span>\n    \n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>위와 같이 <code class=\"language-text\">@Resuroce</code> 를 통해 빈 객체로 등록해주고 이번에는 <code class=\"language-text\">self.progress()</code>를 호출해줍니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    self<span class=\"token punctuation\">.</span><span class=\"token function\">progress</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">progress</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"PROGRESS\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>해당 방법이 성공한 이유는 외부에서 내부 빈으로 호출을 하므로 아래와 같이 aop가 정상 동작합니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 558px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/affb2d369a238af7b33a70adad04b814/65207/2022-11-07-aop7.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 20.6%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAABJ0AAASdAHeZh94AAAAuElEQVR42mWPawrCQAyEvYhibZO63ey23dYniApCBcH732ZMYxHUHx+BJDOTzKrSoxKH6CNqqREqQZEVBq3oD0dOdwKiCzhJh4NvcQ0b7EPSfsQsVyEzTaYNvC76tYaUFbJF9sVyvlRThtPZKH4ODzzvDwyXG5I0b8NRbIjgeEg475NdO/KZTYzfpKiX7Vq0oUZqevTd1qqomRlyXloq5YSS9FJme63I6N3/gXPGmlgDBGLfiBEmwxeAlXfTdQ5HXwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"test-success\"\n        title=\"\"\n        src=\"/static/affb2d369a238af7b33a70adad04b814/65207/2022-11-07-aop7.png\"\n        srcset=\"/static/affb2d369a238af7b33a70adad04b814/0eb09/2022-11-07-aop7.png 500w,\n/static/affb2d369a238af7b33a70adad04b814/65207/2022-11-07-aop7.png 558w\"\n        sizes=\"(max-width: 558px) 100vw, 558px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>*주의: 해당 방식은 2.6 보다 낮은 버전에서 가능합니다.\n스프링 부트 2.6 버전부터는 기본적으로 순환 참조를 금지하도록 변경되었습니다.\n만약 2.6 버전 이상에서 실습해보고 싶으시다면 아래의 설정을 추가하시면 됩니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">spring</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">main</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">allow-circular-references</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span></code></pre></div>\n<p><a href=\"https://github.com/spring-projects/spring-boot/wiki/Spring-Boot-2.6-Release-Notes\">Spring Boot 2.6 Release Notes</a></p>\n<h2>마무리</h2>\n<p>지금까지 트랜잭션과 AOP에 대한 사실과 오해를 잠깐 맛보았습니다.</p>\n<p>AOP는 내용이 많고 어렵기도 해서 추가적인 학습들이 필요합니다.</p>\n<p>AOP를 사용하면 부가 기능을 따로 추출하여 비즈니스 로직에만 집중할 수 있는 장점이 생기지만\n잘못 사용하면 그만큼 side-effect가 생깁니다.</p>\n<p>이 글을 읽고 낯설었던 aop에 대해 한걸음 가까워졌으면 좋겠습니다!</p>\n<h2>References</h2>\n<ul>\n<li><a href=\"https://docs.spring.io/spring-framework/docs/current/reference/html/data-access.html#transaction-declarative-annotations\">공식 문서</a></li>\n<li><a href=\"https://stackoverflow.com/questions/34197964/why-doesnt-springs-transactional-work-on-protected-methods\">stack-overflow</a></li>\n<li><a href=\"https://www.youtube.com/watch?v=MFckVKrJLRQ&#x26;t=19s\">JDK Dynamic Proxy 와 CGLIB (1)</a></li>\n<li><a href=\"https://www.youtube.com/watch?v=RHxTV7qFV7M&#x26;t=291s\">JDK Dynamic Proxy 와 CGLIB (2)</a></li>\n</ul>","htmlAst":{"type":"root","children":[{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"들어가며"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"트랜잭션을 공부하다보면서 자연스럽게 AOP에 대해 접하게 되었습니다.\nAOP를 사용하게 되면서 직접 경험했던 사실과 오해에 대해서 공유하려고 합니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"첫 번째 사실: public이외의 메서드는 AOP가 걸리지 않는다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 365px; "},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/af573b452edb91f619a33bf55f35f8e3/dbde8/2022-11-07-aop1.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 41.917808219178085%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABJ0AAASdAHeZh94AAABlUlEQVR42mWQyY7bMBBE9RuBAyeYzFiyJFsLd1GUKEv2LIcgQHLK//9HpUQghyCHQrPZ5OvqzpreQK9vUPMNMt4hA+O4QDDq5Y6m06jyCvX5goqq/1P9T54pNcAT4H3EFB8YCHJuwjxtCHGDNR6611C7OoW+EZCMopUQjeRZQ6R8r0lkq/T4ISf8lDN+ywVbY3HrLL53I5bWYqX77cZGZsRgR7TXHlI4aOXRE+bSfYAfZngXkDV1iw+6/MXHj8njYx4wOY11IjhYbMzX4BC9wWhUqs1U9NSgk1Pv2OjS4lo1yErO7TuJVVvMo8Lbwk+mx2vUuE8KW9glk4IRhGu8LwaPSM0aHR1b5RLsUl6RFc8FitMZXSvYpYOWFlb79FAJyxE7SO4vcMf7yMfDEZ8/HXGgjoevePryhNO3U1JyWLwUqIqKS1cw0mCNC6YxcDcOYRjh6Hw/G6lTXTQtmvqKvu0JeUnAMw3lz/lf4BllXtKZgVEWyxwJMXSnEyyGyHuTdqSFgrcD32qMzqMkaAfupnJOugP/APZiAnX0CzSJAAAAAElFTkSuQmCC'); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"2022 11 07 aop1","title":"","src":"/static/af573b452edb91f619a33bf55f35f8e3/dbde8/2022-11-07-aop1.png","srcSet":["/static/af573b452edb91f619a33bf55f35f8e3/dbde8/2022-11-07-aop1.png 365w"],"sizes":"(max-width: 365px) 100vw, 365px","style":"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;","loading":"lazy","decoding":"async"},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"실제 인텔리제이에서 private 메서드에 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"@Transactional"}]},{"type":"text","value":" 을 선언하면 위와 같이 컴파일 에러를 띄워줍니다.\n해석해보자면 private을 사용하지 말라는군요!"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"왜 private 메서드에는 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"@Transactional"}]},{"type":"text","value":"이 붙을 수 없을까요?🤔"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"해당 원인을 파악하려면 먼저 프록시에 대해서 알아봐야합니다.\n스프링 aop에서 프록시는 크게 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"JDK Dynamic proxy"}]},{"type":"text","value":"또는 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"CGLIB"}]},{"type":"text","value":"으로 작동합니다.\n그리고 spring boot 1.4 버전 이후부터는 default로 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"CGLIB"}]},{"type":"text","value":"을 사용합니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"CGLIB은 동적으로 상속을 통해 프록시를 생성합니다.\n따라서 private 메서드는 상속이 불가능하기 때문에 프록시로 만들어지지 않는것이죠!"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"그러면 아래처럼 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"protected"}]},{"type":"text","value":"나 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"public"}]},{"type":"text","value":"으로 메서드를 만들면 정상적으로 트랜잭션이 동작할까요?\n정답은 protected일 때 또한 정상 동작하지 않습니다🥲"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 203px; "},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/6bd9ea66b78dcca5fcf91445b4e191f8/187ee/2022-11-07-aop2.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 25.615763546798032%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA90lEQVR42nWQy27CMBRE8zdV4sRv14kDpCLlpQIVaYAIsaiqbvv/y+lN0pZuWIw0c2zNvXakH0v4egXlArTNoWwBaTyUyUfmCvIe2peQyiGNM2QJv6so7M8oXw8odi1mbYfp8YrZ8YKwaxC2LSry06bDpDkPpeyBIU2yoXgQlfwfEmlu4JiEjTlsIqBjMWZGnsSJu2RkirLkGkpoaGGgek/S0twK32yFq6twck/4zBfo3BwX8l9hg430WKsS777GR77EijvUyzUO9KLtyx7P8wWCD6TyVmiYAu/X7gEbISP9Mv5zkbMx95tZ+ksjLWSmIFJJZ+Kv8BtNaqMB8CAneAAAAABJRU5ErkJggg=='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"protected","title":"","src":"/static/6bd9ea66b78dcca5fcf91445b4e191f8/187ee/2022-11-07-aop2.png","srcSet":["/static/6bd9ea66b78dcca5fcf91445b4e191f8/187ee/2022-11-07-aop2.png 203w"],"sizes":"(max-width: 203px) 100vw, 203px","style":"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;","loading":"lazy","decoding":"async"},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 180px; "},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/67116898ef1328f37a97abf57cb70666/e9ea2/2022-11-07-aop3.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 31.666666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABL0lEQVR42mWQS2/CMBCE82daILYTx06MnUcjUwgECC9B1XKpemlP/f/H6fKooOrhkz1e7+xqAjdboT4cMfQN3LRD3q7hJnNYws062KbDcHSqLVEstzD1M3iPQbAYIoz+ETztj7DTORJXwy13yBdrYodqs4eZzGDGLWy7giPKzQFp6cEeGfjJYCDAiT+GMowh+xyOSbh+BN3jiKlBPAyg+wKG6imdkraKqUGJBJky0DKFkhop3SWXZHw1fMk8vvIpvosWr8bjbTjCQueopMWna/Bux/ggvHYYNy22mx26xQrNc4PcVfC1R0JDfjcNbJQiEwqKpmiu4EgntG1MOuEJjNCEOuvClShsgTKvaLMMkoxi+hPd5RmwUICdsiDBiDC8ZcLPtcv7WV8zu3HJ8T7DHzvYw7wJRKS/AAAAAElFTkSuQmCC'); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"public-method","title":"","src":"/static/67116898ef1328f37a97abf57cb70666/e9ea2/2022-11-07-aop3.png","srcSet":["/static/67116898ef1328f37a97abf57cb70666/e9ea2/2022-11-07-aop3.png 180w"],"sizes":"(max-width: 180px) 100vw, 180px","style":"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;","loading":"lazy","decoding":"async"},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"분명히 인텔리제이로 확인을 해보면 컴파일 에러는 나오지 않는데 말이죠. 해당 이유는 앞서 말했던 JDK Dynamic proxy 가 원인이었기 때문입니다.\nJDK Dynamic proxy는 인터페이스를 기반으로 동작합니다. 따라서 protected 메서드에서는 프록시가 동작할 수 없는 것이죠.\n그래서 스프링에서는 일관된 AOP적용을 위해서 protected로 선언된 메서드 또한 트랜잭션이 걸리지 않도록 한 것입니다.\n즉, 프록시 설정에 따라 트랜잭션이 적용되었다 안되었다 하는 변칙적인 결과를 막기 위함인거죠."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"두 번째 사실: 같은 클래스내에서 트랜잭션이 걸린 메소드를 호출하면 트랜잭션이 작동하지 않는다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"java"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-java"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-java"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"public"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"class"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"A"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"public"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"void"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"init"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n        "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"this"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"progress"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n\n    "},{"type":"element","tagName":"span","properties":{"className":["token","annotation","punctuation"]},"children":[{"type":"text","value":"@Transactional"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"public"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"void"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"progress"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"예를들어 다음과 같은 상황에서 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"progress()"}]},{"type":"text","value":"는 정상적으로 트랜잭션이 적용될까요?"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"이번에도 안됩니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Spring AOP에서 프록시의 동작 과정을 보면 프록시를 통해 들어오는 외부 메서드 호출을 인터셉트 하여 작동합니다. 바로 이러한 성격때문에 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"self-invocation"}]},{"type":"text","value":"이 라고 불리는 현상이 발생합니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"프록시의 내부 빈에서 프록시를 호출 했다는 것이죠. 그림으로 보면 이해하는데 도움이 될것같아서 그려봤습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1440px; "},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/230f19e03e489df6862ff483c3371996/89066/2022-11-07-aop4.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 69.8%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAABjklEQVR42o1S2W7CMBDk/z+I90o8lkogoYBUAZHa5iBOnBPbSZh6l4QmlKasNLKVtScz65lhokzdwI8yxGmFShk8U7OpZnnWeHM+8PL6jjDOYZoGZ11DmTHoG/UmCUndZyCZNMkqpPkZiVX6CNL2A5Gjbtq/CbVp2CpVY//edAru63K58Epn6c4koZAl7/0gwPHoQkqJwO5Pp9MNvu8jy1LIQkFb6zP6wxA3y6zwSpimKYqi4D4p1Voz2rZFVVUQUYSs0FBE2BPQwSGhHhDKjpDKdV2sVitst1smNMYgjgXSnnC322GxWGC5XOJwOCDPc7705fn2kBoppFJKMUghCaB1RBiGIRzHwX6/t7PI+FBr1RZlxa/LCmWKsryq3Ww2LGA+n2O9XkMIYfuJTYEaW/4Vm7sZ9oS09zwPJIT25EgmMbtRzz6K7C4OY3KbtbUsRPRjeSrYfQ5pZhQPigkpC210eLXw7KyLImfL2tT/5fD6EG1r1ZO6B2g7wZTZyWA3NhKByJj0P0RJzuOhcXwD7wQ/6h4VgLYAAAAASUVORK5CYII='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"proxy","title":"","src":"/static/230f19e03e489df6862ff483c3371996/89066/2022-11-07-aop4.png","srcSet":["/static/230f19e03e489df6862ff483c3371996/0eb09/2022-11-07-aop4.png 500w","/static/230f19e03e489df6862ff483c3371996/1263b/2022-11-07-aop4.png 1000w","/static/230f19e03e489df6862ff483c3371996/89066/2022-11-07-aop4.png 1440w"],"sizes":"(max-width: 1440px) 100vw, 1440px","style":"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;","loading":"lazy","decoding":"async"},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]},{"type":"text","value":"\nmain메서드에서 그림과 같이 A의 init()를 호출하고 init()에서 progress()를 호출하면 그림과 같이 프록시 내부에서 호출하게 됩니다.\n따라서 proxy가 인터셉트하지 못해서 트랜잭션이 동작하지 않는것입니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"오해: 그렇다면 내부 메서드에서 호출은 AOP적용이 불가능하다"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"해당 주장은 사실이 아닙니다. 공식문서를 잘 보면 해결 방법이 있습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"blockquote","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"self-invocation(in effect, a method within the target object calling another method of the target object)\ndoes not lead to an actual transaction at runtime…"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"타겟 내에서 타겟의 다른 메서드를 호출할 때, 런타임에 실제 트랜잭션이 작동하지 않는다고 합니다. 즉, 런타임 시점에 작동은 안 하지만 이것을 컴파일 시점에 적용하면 된다는 것이죠."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"그렇다면 어떻게 컴파일 시점에 프록시를 적용할 수 있을까요?"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"스프링에서 AOP를 구현하는 방식에는 스프링 AOP도 있지만 AspectJ라는 강력한 도구도 있습니다. AspectJ는 스프링AOP와 다르게 컴파일 시점에 위빙이 이루어집니다. 따라서 AspectJ를 사용하면 self-invocation문제를 해결할수 있는것이죠!"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"그런데 만약 Spring AOP를 쓰고있는 상황에서 이런 문제가 발생하면 어떡하죠? 이럴경우 다른 방법도 존재합니다!"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"첫번째 방법은 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"AopContext를 이용하는 방법"}]},{"type":"text","value":"입니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"AopContext의 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"currentProxy()"}]},{"type":"text","value":" 메서드는 현재 AOP proxy를 반환합니다.\n이번엔 코드로 확인해봅시다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"java"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-java"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-java"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","annotation","punctuation"]},"children":[{"type":"text","value":"@Aspect"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","annotation","punctuation"]},"children":[{"type":"text","value":"@Component"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"public"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"class"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"AopService"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n\n    "},{"type":"element","tagName":"span","properties":{"className":["token","annotation","punctuation"]},"children":[{"type":"text","value":"@Pointcut"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"execution(void kitchenpos.application.MenuService*.progress(..))\""}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"public"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"void"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"pointCut"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n\n    "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n\n    "},{"type":"element","tagName":"span","properties":{"className":["token","annotation","punctuation"]},"children":[{"type":"text","value":"@Before"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"pointCut()\""}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"public"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"void"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"before"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n        "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"System"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"err"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"println"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"aop works!!\""}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"우선 aop를 적용해줍니다.\nprogress() 메서드가 동작하기 전에 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"aop works!!"}]},{"type":"text","value":" 라는 에러 메시지를 출력해주는 aop입니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"java"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-java"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-java"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"public"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"void"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"init"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"this"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"progress"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"public"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"void"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"progress"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"System"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"out"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"println"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"PROGRESS\""}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"그리고 다음과 같이 실행을 해주면 아래와 같이 적용되지 않습니다.\n"},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 697px; "},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/e538de1361186e34fd1bb296a0773730/11663/2022-11-07-aop5.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 19.6%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAABJ0AAASdAHeZh94AAAAvElEQVR42nWO2w6CMBBE+RMvQAt0e6GgGJRGiJcY//97xm1JfNKHk810O7OTvR83LNMZS7hg5nm/BkynAYYsOtdjGgP69pC08x6t8ehYx13E2y7N+G6URWaM5c8tCwdZ1okylxC5gCwqqEqhkSunYcTz/sIc5mS25L5ErRuDTAoBTQqeg3VNbGxQ7Ark2zyx2+xRFRKONNNy2yO38sn8i6wRCkSE8ciXlOZA+jaK1Ly3ijD4tYGqCFTrv4Ef6cZ7Usr23mIAAAAASUVORK5CYII='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"test-fail","title":"","src":"/static/e538de1361186e34fd1bb296a0773730/11663/2022-11-07-aop5.png","srcSet":["/static/e538de1361186e34fd1bb296a0773730/0eb09/2022-11-07-aop5.png 500w","/static/e538de1361186e34fd1bb296a0773730/11663/2022-11-07-aop5.png 697w"],"sizes":"(max-width: 697px) 100vw, 697px","style":"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;","loading":"lazy","decoding":"async"},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"이번에는 AopContext를 활용하여 아래와 같이 수정해보겠습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"java"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-java"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-java"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"public"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"void"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"init"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"MenuService"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"AopContext"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"currentProxy"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"progress"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"public"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"void"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"progress"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"System"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"out"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"println"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"PROGRESS\""}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"그리고 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"@EnableAspectJAutoProxy(exposeProxy = true)"}]},{"type":"text","value":" 옵션을 적용해서 작동시켜 봅니다.\n"},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 563px; "},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/93516c3962ab6fe2b965d04d916c541c/e80ce/2022-11-07-aop6.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 18.4%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAABJ0AAASdAHeZh94AAAAzUlEQVR42lWQ606EMBCFeREVxULb6QVYCLLXbLLJ6g8T3/9lPgcwRn98mUl75sxpCwmOJJno40pdNZiXWmu99n/xjSBWcYHsM/uw4006Rt9ySiPHPFAYY/DeknxSYcQaS/PaUJUVz4/lL+XDE0aXrPdKqyE+r3e+bh+8X24c8sgUeop1axCGoWdW+tzRxo7gBFs73A+LUZcSY5eZ+qyalmk6cD5d2M9HgmyBCmvcOpiTMO8Cvl4SWpZz989QNSL0cSNLRJqwfYPWqC9c+AbtPXkUGyqzrQAAAABJRU5ErkJggg=='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"test-success","title":"","src":"/static/93516c3962ab6fe2b965d04d916c541c/e80ce/2022-11-07-aop6.png","srcSet":["/static/93516c3962ab6fe2b965d04d916c541c/0eb09/2022-11-07-aop6.png 500w","/static/93516c3962ab6fe2b965d04d916c541c/e80ce/2022-11-07-aop6.png 563w"],"sizes":"(max-width: 563px) 100vw, 563px","style":"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;","loading":"lazy","decoding":"async"},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"aop가 작동하는 것을 확인할 수 있습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"두 번째 방법은 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"자기 자신을 호출하는 방법"}]},{"type":"text","value":"입니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"내부에서 프록시를 호출하면 인터셉터가 작동하지 않으므로 외부에서 호출하는 방식으로 해결하는 것입니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"@Resource"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"@Autowired"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"@Inject"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"등 여러 방법이 있습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"모두 적용이 가능하지만 이번 예시에서는 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"@Resource"}]},{"type":"text","value":" 어노테이션을 사용하여 AOP를 적용해보겠습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"java"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-java"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-java"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"public"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"class"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"MenuService"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","annotation","punctuation"]},"children":[{"type":"text","value":"@Resource"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"text","value":"name "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"menuService\""}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"MenuService"}]},{"type":"text","value":" self"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n    \n    "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"위와 같이 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"@Resuroce"}]},{"type":"text","value":" 를 통해 빈 객체로 등록해주고 이번에는 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"self.progress()"}]},{"type":"text","value":"를 호출해줍니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"java"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-java"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-java"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"public"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"void"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"init"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n    self"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"progress"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"public"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"void"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"progress"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"System"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"out"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"println"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"PROGRESS\""}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"해당 방법이 성공한 이유는 외부에서 내부 빈으로 호출을 하므로 아래와 같이 aop가 정상 동작합니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 558px; "},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/affb2d369a238af7b33a70adad04b814/65207/2022-11-07-aop7.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 20.6%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAABJ0AAASdAHeZh94AAAAuElEQVR42mWPawrCQAyEvYhibZO63ey23dYniApCBcH732ZMYxHUHx+BJDOTzKrSoxKH6CNqqREqQZEVBq3oD0dOdwKiCzhJh4NvcQ0b7EPSfsQsVyEzTaYNvC76tYaUFbJF9sVyvlRThtPZKH4ODzzvDwyXG5I0b8NRbIjgeEg475NdO/KZTYzfpKiX7Vq0oUZqevTd1qqomRlyXloq5YSS9FJme63I6N3/gXPGmlgDBGLfiBEmwxeAlXfTdQ5HXwAAAABJRU5ErkJggg=='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"test-success","title":"","src":"/static/affb2d369a238af7b33a70adad04b814/65207/2022-11-07-aop7.png","srcSet":["/static/affb2d369a238af7b33a70adad04b814/0eb09/2022-11-07-aop7.png 500w","/static/affb2d369a238af7b33a70adad04b814/65207/2022-11-07-aop7.png 558w"],"sizes":"(max-width: 558px) 100vw, 558px","style":"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;","loading":"lazy","decoding":"async"},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"*주의: 해당 방식은 2.6 보다 낮은 버전에서 가능합니다.\n스프링 부트 2.6 버전부터는 기본적으로 순환 참조를 금지하도록 변경되었습니다.\n만약 2.6 버전 이상에서 실습해보고 싶으시다면 아래의 설정을 추가하시면 됩니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"yaml"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-yaml"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-yaml"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"spring"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"main"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"allow-circular-references"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","boolean","important"]},"children":[{"type":"text","value":"true"}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://github.com/spring-projects/spring-boot/wiki/Spring-Boot-2.6-Release-Notes"},"children":[{"type":"text","value":"Spring Boot 2.6 Release Notes"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"마무리"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"지금까지 트랜잭션과 AOP에 대한 사실과 오해를 잠깐 맛보았습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"AOP는 내용이 많고 어렵기도 해서 추가적인 학습들이 필요합니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"AOP를 사용하면 부가 기능을 따로 추출하여 비즈니스 로직에만 집중할 수 있는 장점이 생기지만\n잘못 사용하면 그만큼 side-effect가 생깁니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"이 글을 읽고 낯설었던 aop에 대해 한걸음 가까워졌으면 좋겠습니다!"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"References"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://docs.spring.io/spring-framework/docs/current/reference/html/data-access.html#transaction-declarative-annotations"},"children":[{"type":"text","value":"공식 문서"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://stackoverflow.com/questions/34197964/why-doesnt-springs-transactional-work-on-protected-methods"},"children":[{"type":"text","value":"stack-overflow"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://www.youtube.com/watch?v=MFckVKrJLRQ&t=19s"},"children":[{"type":"text","value":"JDK Dynamic Proxy 와 CGLIB (1)"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://www.youtube.com/watch?v=RHxTV7qFV7M&t=291s"},"children":[{"type":"text","value":"JDK Dynamic Proxy 와 CGLIB (2)"}]}]},{"type":"text","value":"\n"}]}],"data":{"quirksMode":false}},"excerpt":"들어가며 트랜잭션을 공부하다보면서 자연스럽게 AOP에 대해 접하게 되었습니다.\nAOP를 사용하게 되면서 직접 경험했던 사실과 오해에 대해서 공유하려고 합니다. 첫 번째 사실: public이외의 메서드는 AOP…","timeToRead":3,"frontmatter":{"title":"AOP에 대한 사실과 오해 그런데 트랜잭션을 사알짝 곁들인..","userDate":"15 November 2022","date":"2022-11-15T13:10:00.000Z","tags":["aop","proxy","transaction"],"excerpt":null,"image":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAA7DAAAOwwHHb6hkAAABL0lEQVR42rVTS0vDQBDub/WPePTiod70It6UViwFsRettAelUEWtNPiIfRELTUveaTbZ3c/NpinUxAdidxl2GGa/+fab2QL+eRXWCsjFpiwE41R4LIlxtjD+yU/szwzjYnl+LmCaEDGC/ZtNbDU20DcUGXOICTswMI88TL13aX7oiLgBN7Qy4BKQ8eR518MzHN5v43X2IC6OoXsajjs7aPROUH4soqrsodrdRe35QFqzV5ESZBkutBiaT2j2K7jV6tDsN/iRg0u1jAv1CG3tHAPBWtHbgn0XpU4RdbW01DmjYQr6Mr3D1eAULrGQsKcIhRRB5EOZtNAa1eARG+ZcF6e1VDW/yxJ0VZO0OqEBJu4IM38MKop81ZxMl2OAWNPVZJ7b9V8B/jQ6343MWn7KB+BZpTIfqvgOAAAAAElFTkSuQmCC"},"images":{"fallback":{"src":"/static/4cbd5a9cfa0c8988af4ff5541eb921f3/98be2/spring_aop.png","srcSet":"/static/4cbd5a9cfa0c8988af4ff5541eb921f3/7dcdb/spring_aop.png 750w,\n/static/4cbd5a9cfa0c8988af4ff5541eb921f3/98be2/spring_aop.png 1064w","sizes":"100vw"},"sources":[{"srcSet":"/static/4cbd5a9cfa0c8988af4ff5541eb921f3/c5942/spring_aop.avif 750w,\n/static/4cbd5a9cfa0c8988af4ff5541eb921f3/e7e8a/spring_aop.avif 1064w","type":"image/avif","sizes":"100vw"},{"srcSet":"/static/4cbd5a9cfa0c8988af4ff5541eb921f3/d2262/spring_aop.webp 750w,\n/static/4cbd5a9cfa0c8988af4ff5541eb921f3/d39b8/spring_aop.webp 1064w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.6033834586466166}}},"author":[{"name":"4기_기론","bio":"우아한테크코스 4기 기론(김규철)입니다 :)","avatar":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","backgroundColor":"#a89888","images":{"fallback":{"src":"/static/264a2517af906c5a1c3c22b6f4c181cd/73bb6/giron.jpg","srcSet":"/static/264a2517af906c5a1c3c22b6f4c181cd/2f28c/giron.jpg 40w,\n/static/264a2517af906c5a1c3c22b6f4c181cd/499f6/giron.jpg 80w,\n/static/264a2517af906c5a1c3c22b6f4c181cd/73bb6/giron.jpg 120w","sizes":"100vw"},"sources":[{"srcSet":"/static/264a2517af906c5a1c3c22b6f4c181cd/e73fe/giron.webp 40w,\n/static/264a2517af906c5a1c3c22b6f4c181cd/61ca6/giron.webp 80w,\n/static/264a2517af906c5a1c3c22b6f4c181cd/507b0/giron.webp 120w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":1}}}}],"source":null}},"relatedPosts":{"totalCount":2,"edges":[{"node":{"id":"cb941db5-d550-5213-8c6b-ce00a6e4fff1","timeToRead":3,"excerpt":"들어가며 트랜잭션을 공부하다보면서 자연스럽게 AOP에 대해 접하게 되었습니다.\nAOP를 사용하게 되면서 직접 경험했던 사실과 오해에 대해서 공유하려고 합니다. 첫 번째 사실: public이외의 메서드는 AOP…","frontmatter":{"title":"AOP에 대한 사실과 오해 그런데 트랜잭션을 사알짝 곁들인..","date":"2022-11-15T13:10:00.000Z"},"fields":{"slug":"/post/2022-11-07-transaction-aop-fact-and-misconception/"}}},{"node":{"id":"5a8145fc-4d1b-5dc4-96f0-1d64e0232543","timeToRead":5,"excerpt":"이 글은 AOP 개념이 생소한 입문자들을 위한 포스팅입니다. 1. OOP의 한계 image…","frontmatter":{"title":"AOP 입문자를 위한 개념 이해하기","date":"2021-06-25T12:00:00.000Z"},"fields":{"slug":"/post/2021-06-25-aop-transaction/"}}}]}},"pageContext":{"slug":"/post/2022-11-07-transaction-aop-fact-and-misconception/","prev":{"excerpt":"상황 스모디 프로젝트를 하면서 랭킹 기능을 도입하기로 했습니다. 랭킹 기능은 유저가 활동을 했을 때, 활동에 따라 랭킹 점수를 부여해야 합니다. 저희 서비스는 챌린지에 도전하고 매일 챌린지에 해당하는 활동을 인증하여 총…","timeToRead":7,"frontmatter":{"title":"스프링 이벤트 적용기","tags":["spring","event"],"date":"2022-11-14T13:10:00.000Z","draft":false,"excerpt":null,"image":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAEG0lEQVR42kWU11MjRxDG9f/7yXbZRzlQcAfYR5GEQHGRUM5atAqbs1ZZAg4kkF8+94wID109Yfs3X/f0bKhXVqCl7zFor2A0OwhaLpbaf7C8FXTjB7T8EkbmAa6ygmmt4LYfMLdf0C+XMO5O4Ba7sKNZLAolzOIJhOTaA5TUFEH3BZ4kI6jamDSnBLtHW31Ep7CAVOzBNOdwg1cEDRnTVBqzpo5p/QFDYw1jsIbb8knIDKGOcg9bX2HYsDCPC1jJGjxNhFYewaitIYaHuDj7HbVmCtnkAm6hh8diASvPxqDfh6Leo2c+wm78gJpZIKTaz9C9DfyWhmU+j7Vjo1q5QuyfKLRCAK1mQO+X0Oukkb3NQ78zsZp46NxlUIuKMMUV2tUlffsAs3iPkOcPIIoWhDApalpYjgwEdgfx1A7S2V2M/R6mvoqx24Nn1TB025gPTdSqZwgfH8Itr9AKO4icfYXnUspTv0+bcRRLAky9hbHXx8RXMAs0gvUx8qiuToc8rXu05il8f2BLyJX2YckSeq0yJClG3ysEHGhcxchrcyW6XURe/Yq6cY6y9i9EI4KC+g01/RRN4wJ18hVab5tRGB7dLMVPA4VUW3SQjNBkoIJBJ2TzwILhlJCQf0Wk9xOBGegEgrKDnLqPrLqHonbIoWnlD3StFBaBTYJkMA5jhN5hE0pxMbShOQUk5d8gyFuI4twiLv/CrWMlCHjAobfqLgGTBHQ4bBroXFhowiVrfGEWmPD9O66qZYYhmlfQnSIH9WwBuluE6uQgWXHuDadMWZkf8cxC74Mt0IDniShpRzyobUUJGkHDPEdFP6ZDLnkdqzSuGScY+BKP+QSylNnkLeUlyZdITUX/joL2jVLeI3/A043JPyOn7SElf+ElSSt/wvEabwq3KbPUQ+/5M+B8YKJrppCR/0ZO2ec1bOjndONnaNCt17VTsnMU1QOeheVWPxSy0o09+RPIjPXYyO+i48ZgugVqizyvVdO6gGhF0LdvqJYpaplraqcrOG6d2sb4uBAOZM3IoGPqQdbM7UYOhZs4KjkB+UwMN/FLpGJhlHIpVAsCskIUyWuqaVZAVyxhPtJ5LLOR2ycgUdmA2dim5yU3YbTLsKQqzLsy7HZl62luS2xcor0KfdfAQBUxcT/jR05vCxzTYDSQMROrWO8e4+XwHK/XN2RpbDIlbKIZvF7RPCLgNXaL13AK670TrHa/Y96qYkixDDZmCtm7ZIPxkC6lScAvh3jZO8XL0SU2sSw2yQIBCXLNQAI2V2nai2D91zHWO0eY1ysYDemVMGH8Unw2IehQx7zbwtNFDM9CFk+JNPfcEhk8J2/Jtv4pKvD9p8sE5lKTi2HCGOvt6W3fIe9JVmCnz2szfTM+pkOZTd7mfM3f/gemH69Nw/8b0nSURISvtgAAAABJRU5ErkJggg=="},"images":{"fallback":{"src":"/static/9bdf05c582ed968c2c758e7b7bba79df/b7804/spring-event.png","srcSet":"/static/9bdf05c582ed968c2c758e7b7bba79df/f054e/spring-event.png 750w,\n/static/9bdf05c582ed968c2c758e7b7bba79df/b7804/spring-event.png 800w","sizes":"100vw"},"sources":[{"srcSet":"/static/9bdf05c582ed968c2c758e7b7bba79df/4f03f/spring-event.webp 750w,\n/static/9bdf05c582ed968c2c758e7b7bba79df/c1587/spring-event.webp 800w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":1}}},"author":[{"name":"4기_토닉","bio":"우아한테크코스 4기 토닉(최우석)입니다 :)","avatar":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","placeholder":{"fallback":"data:image/jpeg;base64,/9j/2wBDAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/2wBDAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/wgARCAANABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAcFBgj/xAAXAQADAQAAAAAAAAAAAAAAAAABAgME/9oADAMBAAIQAxAAAAHMaEdaqNIIuo2f/8QAGxAAAgIDAQAAAAAAAAAAAAAAAwUABAECBhX/2gAIAQEAAQUCOoo+U25lWS/nlF8bXCaq9LJiQd6f/8QAHxEAAQMDBQAAAAAAAAAAAAAAAgABEQMSITFxgpHw/9oACAEDAQE/ASC6iRs2RjbVpntNTN82j7kv/8QAHxEBAAEBCQAAAAAAAAAAAAAAAREAAhMhMUJhcZHB/9oACAECAQE/AdZZXBz6kim7GPONq//EACQQAAIBAgcAAgMAAAAAAAAAAAECAxESAAQTISIxUSMyQWLB/9oACAEBAAY/As3Jopqxwlla0GhqPf7htGxI1zOagbRRlN0LqGVjYL7a7NuO6McACaZlUUWpfiKk2rx2FSTQUFST2TjORrxBhI27/G/XuC0jF/mkffu+bnKxP7EDDAx/Vrah6V4q3Vh99x//xAAaEAEBAQADAQAAAAAAAAAAAAABESExQVEA/9oACAEBAAE/ISq0JAxHE7nSP0oMAK5nrwN/UksyekxIo8/RKHfXNc5M0tIdtn1QTk9TQVV+YEfczVXIRylS6yuLlh//2gAMAwEAAgADAAAAEDs//8QAGxEBAAICAwAAAAAAAAAAAAAAARFRMWEAIUH/2gAIAQMBAT8QGSDYSCkuiFUCQgOsBAhQcutKo9t5/8QAHBEBAAICAwEAAAAAAAAAAAAAARFBACFRYXHw/9oACAECAQE/EBuBoiu6BALmZ6xISiMOlcvP0Gf/xAAYEAEBAQEBAAAAAAAAAAAAAAABEQAhMf/aAAgBAQABPxChKe6gcz24rwZjYHArYCBLmTvJEYZeSHGJJrrrWGn4CRouIcGW6ITOooWUwKSgPOUPvggiCMl4FlGH/9k="},"images":{"fallback":{"src":"/static/1081885cea1361e492c86b1f35c90fb1/e70fc/tonic.jpg","srcSet":"/static/1081885cea1361e492c86b1f35c90fb1/e70fc/tonic.jpg 640w","sizes":"100vw"},"sources":[{"srcSet":"/static/1081885cea1361e492c86b1f35c90fb1/62859/tonic.webp 640w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.6671874999999999}}}}]},"fields":{"layout":"post","slug":"/post/2022-11-14-spring-event/"}},"next":{"excerpt":"용어 설명  Cycle이란, 사용자가 특정 챌린지에 도전할 때 생성되는 객체이다. 비즈니스 규칙 상 하루에 한번씩 총…","timeToRead":8,"frontmatter":{"title":"데드락 해결 모험기","tags":["Mysql","DeadLock"],"date":"2022-11-21T15:00:00.000Z","draft":false,"excerpt":null,"image":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAIAAABr+ngCAAAACXBIWXMAAAPoAAAD6AG1e1JrAAADGElEQVR42j1T21PaeBjNH9uHbbtTZ9uZdW2rtLVaab2wKE1EKRDKxVxAA5JWiJAEJRAgSAzwCyIJQeuF2dE3H/dz2NnMyUwezvnOdznBOCqcSgRZitwIbfvCga8hfzrDnvdOLoZdgNU3Lh105XTamjjsHB9lgkfM8tKb31bXPje1Y2x3J5Qgt4R9tl4vRegY6OnMnnwsS+KPkd2p19WSmLvVOfWAHMiBbffUgnu+dHQIdYejNgbOaZpUj/K/Lkxgt5EBz6EsUilW4JO6rp/WJUOO0zurn1c/MGxsODiFXvRhRbAyWOFg9ww1QAbi8bV9fXPx67KfyTKpVLiHuuPx+Pb2dml++gv+d69bB5rtGGVbOLT3RZvHQAMwe4/1ri970M9ZR71qpeu8X2Y8CCHDRGFB2JSKlYYCHCCDvnQuKFYByxiaMeigrgZVb0ypfxy3y6QuhPzuP7w+z/39Pcdnn3s97xMxdyRMKHKjrU38oBAWlmVKLEpVuVLOjgxRSBJRYv79zItEPITajYeHB+vcjFPRqcWF2dh3PJ/DWZbSqqUThUsz2MvA9l8s7ZfFaE05YNY/zPweTZBtowa1u/3G3d2dMxrAd+tE+bS+9mR27hNDr6a5YCrpTdLYGu6d9XpeBb8t89k5KobLxabZgskNW633KjBzVa9og/LjbQan/Qpd5IOv/AQRIdeyGQwOC1j6uvH0nWueSoQkKVoQqu2GPUTmUJPaOWNQdSz9H5RHUsJp/iwyni/ut69x9xuWeRSn0izq1EQp51r8OEUQcwwVUxROrfbMFmzlpq+YKo8U7oDGoyvTM3++2KEiSvlw3e/DIGWTAwAGZ60kRwXpuK+QX9hPe+JkE7Kg7haSm0LANTf97Hs8DDbAhCkcy8DO7ZZqSbKVgyYnIdNbVV+AINnIVS1W3d9W6ZXlt899Wxuws//vDBLFErGixU/iIls/J3pLF681BkmUmiE2F6cWFl0rmz7+xx78LY+eIwRO/yUMXoBmlxynO+7JZzXObgryHp7AXR9nX+L+jclGAURoK5/jYOegb9lK2mT/BZvZmpKjMV1DAAAAAElFTkSuQmCC"},"images":{"fallback":{"src":"/static/9a8e208eb938af089c498336dd233cf0/b924f/deadlock_teaser.webp","srcSet":"/static/9a8e208eb938af089c498336dd233cf0/66907/deadlock_teaser.webp 750w,\n/static/9a8e208eb938af089c498336dd233cf0/27610/deadlock_teaser.webp 1080w,\n/static/9a8e208eb938af089c498336dd233cf0/90004/deadlock_teaser.webp 1366w,\n/static/9a8e208eb938af089c498336dd233cf0/b924f/deadlock_teaser.webp 1600w","sizes":"100vw"},"sources":[]},"width":1,"height":0.75}}},"author":[{"name":"4기_알파","bio":"우아한테크코스 4기 알파(배철환)입니다 :)","avatar":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAABYlAAAWJQFJUiTwAAAENElEQVR42iWU+1MTdxTF+R/9J9ofnE5tMYaI44ui0GAf09GxKMWpVrEPRDAICSG8Cwl5kGxeJOQBm817d7O7oUXn0xv7w535zu7eu+d8z7ln6J5xn2vmd3j0STzmNB57DZe1xTUrxLB2yK1KgW+ycSaSUe4lE9wpbuPSfLjPtxhxgoz2Zhg1JhgxvIzr9xlymd8zYk7gtp8w3F7lxskyU4klZqNr+JMpEtk0tdMKbU2jqZ2RyecJJPcZX/2VsaNFrleX+Lr7EHd/EpcAG/KYk4z0HnO76OPPyAYpGdCtNbC7Blq1it0zsSwLs9eTMnBsm7qqUa+qlI6LxLIZXkf83FV+EJQTMrAnyBrvWQzv8sF0sB0H57xPTasRWFuj3+/jDJ71pWyHi4sPRKNRovE4Fx8uPv3AMSyyqQxTyccMjZirXDWDPEos06w36HQ7qKrKUSzK7C9PCYWClEpFMhmFXC5NLp8leniIP7BMqVzENE26poGutfkp4mPIbQQZsddxqWHeHxwIHZVV/woNrUwxlySZiFAqZOSsfKp8JsnedohWo0LkcJ92p00hk2Nu04enGZSB5hpuK49HUKRPyqSVFMu+BY4zcaFxSK9Txzbb6N06545Oq14lr8TJKVEUUb5QOEZJKYwqwU/KC8IMLsfEG4tgNlqks1mUoxi1yrFUURrjPPj8M25euoT37g1OxUZq+ZhKMUvlJE86naJcLjFWynHVyg1UrjJstJiNR3B0g1KlQlY54h+riyPI6rUyTy9/wcrlL/n5yjCaWqYvzwfvc0qSk5OS2EllLH2Ey9YYut7b4avOCXOxBBdij0arRXh/F1OoGk0NWxpjKyvs3R4jsjAvIrTotTVa2ql8tyeusKmWy4znYzJwd0A5IJT3+TG6Ld465d+LC6HxvwC23pQ7bNCoVQivvuesnMfqNqTqIlaMYrHIx48fCcfijFb8uJ31gSibIso6DzffsOEPoIr/dnZ3iMcPhFYHvalidDQcOQ9Q9zpNjLbK9k5IFO5wVjtjZWkRb/StrOym+NCex11e5SDyt1x2gbXNdfyvXxL2Lcp9lbDbDRwpu1XD6qjorQrHqQRvXs5zdqaysPCG3WAAX2SbK9qcDOx58XT+YDq8yq74K5FJ8f7lHNnfH5HO/Ebg4C9CiXVC8TCLoQNevwuTfVZgY3ZdqIZRxGZbwRCT6ecSKFMyUFJixPJypf2K2b0AVltHqzeJ7vgoFGdY1Kd5IZv0wmjz4sjibcCmNFNlbc7PkbhBr3eZ2noiiTVIK+9g9aZkqb/FI0M9rT94GliiIIliOX2SYtzl6DyvlAAz0jzrT+F7FyexE8O0TVKJFNMbz/AMQA2YGpMMPTJu4TZloO6VCHrAncxzWbWyLL0lodDH1HucVs+oVFSqp1URooXdt2VrzokpCVy5cTzSd13y9LF+k/8AAl+ArsSh5fgAAAAASUVORK5CYII="},"images":{"fallback":{"src":"/static/de921188844e6d769c2bc82372a8276d/0ffb4/alpha.png","srcSet":"/static/de921188844e6d769c2bc82372a8276d/0ffb4/alpha.png 348w","sizes":"100vw"},"sources":[{"srcSet":"/static/de921188844e6d769c2bc82372a8276d/afef7/alpha.webp 348w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.8275862068965518}}}}]},"fields":{"layout":"post","slug":"/post/2022-11-01-mysql-dead-lock/"}},"primaryTag":"aop"}},"staticQueryHashes":["2337738035"],"slicesMap":{}}