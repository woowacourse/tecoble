{"componentChunkName":"component---src-templates-post-tsx","path":"/post/2022-09-20-external-in-transaction/","result":{"data":{"logo":{"childImageSharp":{"gatsbyImageData":{"layout":"fixed","backgroundColor":"#080808","images":{"fallback":{"src":"/static/0b18bd94a62a12fdc81ea720c28722f6/a9770/tecoble.png","srcSet":"/static/0b18bd94a62a12fdc81ea720c28722f6/a9770/tecoble.png 400w","sizes":"400px"},"sources":[{"srcSet":"/static/0b18bd94a62a12fdc81ea720c28722f6/65935/tecoble.webp 400w","type":"image/webp","sizes":"400px"}]},"width":500,"height":110}}},"markdownRemark":{"html":"<p>트랜잭션 처리를 위해서는 데이터베이스와 통신하기 위한 <code class=\"language-text\">커넥션</code>이 필요하다. 하지만 커넥션 생성을 위해서 많은 비용이 필요하다. 이러한 비용을 절감하기 위해 커넥션을 미리 생성한 뒤 <code class=\"language-text\">커넥션 풀</code>을 통해 관리한다.</p>\n<p>커넥션 풀의 개수는 <code class=\"language-text\">제한</code>되어 있다. 만약 동시에 데이터베이스 처리 로직이 담긴 요청을 커넥션 풀의 개수 이상으로 받았다고 가정하자. 커넥션을 획득하지 못한 요청은 다른 데이터베이스 커넥션이 반납될 때까지 기다리게 될 것이다. 결국 이러한 상황이 길어지면 <code class=\"language-text\">병목 현상</code>이 발생하게 된다.</p>\n<p><img src=\"https://user-images.githubusercontent.com/59357153/192680529-da0076fe-6ac4-4fdc-aae5-49a00551abab.png\" alt=\"\"></p>\n<h2>불필요한 로직이 섞인 트랜잭션</h2>\n<p>먼저 간단한 예시를 위해 아래와 같은 요구사항을 줬다고 가정한다.</p>\n<ul>\n<li>회원가입을 진행한다.</li>\n<li>회원가입은 외부 <code class=\"language-text\">OAuth</code>를 통해 진행된다.</li>\n<li>우리는 전달받은 <code class=\"language-text\">인가 코드</code>를 기반으로 <code class=\"language-text\">회원 정보를 조회</code>한 뒤 <code class=\"language-text\">회원가입</code>을 진행한다.</li>\n<li>회원가입이 완료되면 <code class=\"language-text\">NEWBIE</code>라는 칭호를 획득할 수 있다. (회원은 여러 개의 칭호를 가질 수 있다고 가정한다. <code class=\"language-text\">회원 : 칭호 = 1 : N</code>)</li>\n<li>회원가입이 완료되면 가입한 email을 통해 가입 완료 메일을 전송한다.</li>\n</ul>\n<p>위 과정을 코드로 표현하면 아래와 같다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@RequiredArgsConstructor</span>\n<span class=\"token annotation punctuation\">@Service</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">MemberService</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">String</span> <span class=\"token constant\">NEWBIE</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"뉴비\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">String</span> <span class=\"token constant\">CONGRATULATIONS_MESSAGE</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"가입을 축하드립니다!\"</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">MemberRepository</span> memberRepository<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">HonorRepository</span> honorRepository<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">OAuthClient</span> oAuthClient<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">EmailSender</span> emailSender<span class=\"token punctuation\">;</span>\n\n    <span class=\"token annotation punctuation\">@Transactional</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">Member</span> <span class=\"token function\">register</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">final</span> <span class=\"token class-name\">String</span> code<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\">Member</span> member <span class=\"token operator\">=</span> oAuthClient<span class=\"token punctuation\">.</span><span class=\"token function\">getMember</span><span class=\"token punctuation\">(</span>code<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 1</span>\n\n        <span class=\"token class-name\">Member</span> savedMember <span class=\"token operator\">=</span> memberRepository<span class=\"token punctuation\">.</span><span class=\"token function\">save</span><span class=\"token punctuation\">(</span>member<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 2</span>\n        honorRepository<span class=\"token punctuation\">.</span><span class=\"token function\">save</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Honor</span><span class=\"token punctuation\">(</span>savedMember<span class=\"token punctuation\">,</span> <span class=\"token constant\">NEWBIE</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 3</span>\n\n        emailSender<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span>savedMember<span class=\"token punctuation\">.</span><span class=\"token function\">getEmail</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">CONGRATULATIONS_MESSAGE</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 4</span>\n\n        <span class=\"token keyword\">return</span> savedMember<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li><code class=\"language-text\">1</code>: 외부 서비스에서 인가 코드를 전달하여 회원 정보를 조회한다.</li>\n<li><code class=\"language-text\">2</code>: 조회한 회원 정보를 기반으로 저장한다.</li>\n<li><code class=\"language-text\">3</code>: 가입과 동시에 <code class=\"language-text\">NEWBIE</code> 칭호를 획득한다.</li>\n<li><code class=\"language-text\">4</code>: 가입 축하 메일을 전송한다.</li>\n</ul>\n<p>이 모든 과정은 하나의 논리적인 작업 단위이기 때문에 하나의 트랜잭션으로 묶여 진행된다.</p>\n<p>위 로직 중 데이터베이스 트랜잭션이 실질적으로 사용되는 부분은 어디일까? 바로 <code class=\"language-text\">2</code>, <code class=\"language-text\">3</code>이다. <code class=\"language-text\">MemberRepository</code>와 <code class=\"language-text\">HonorRepository</code>는 <code class=\"language-text\">member</code>와 <code class=\"language-text\">honor</code>를 적절히 <code class=\"language-text\">영속</code>시키기 위해 <code class=\"language-text\">데이터베이스 커넥션</code>을 활용한다. 외부 서비스를 통해 회원 정보를 조회하는 <code class=\"language-text\">1</code>과 메일을 전송하기 위한 <code class=\"language-text\">4</code>는 데이터베이스와 관련된 처리가 아니므로 데이터베이스를 활용한 트랜잭션이라 보기 어렵다.</p>\n<p>또한 외부 서비스는 우리가 <code class=\"language-text\">제어할 수 없는 영역</code>에 가깝다. 데이터베이스의 커넥션과 요청 처리를 위한 스레드는 외부 서비스에서 적절한 응답이 올 때까지 계속 <code class=\"language-text\">대기</code>해야 한다. 특히 데이터베이스의 커넥션은 <code class=\"language-text\">한정된 개수</code>를 가지고 있다. 대기 시간이 길어질수록 <code class=\"language-text\">병목 현상</code>이 발생할 가능성이 커진다.</p>\n<p>위 코드를 그림으로 표현하면 아래와 같다.</p>\n<p><img src=\"https://user-images.githubusercontent.com/59357153/192531474-38498110-b3c8-47b1-aafd-0c1ab3944c33.png\" alt=\"\"></p>\n<p>실질적으로 데이터베이스의 트랜잭션이 필요한 부분은 파란 화살표지만, 데이터베이스 커넥션을 사용하지 않는 시간까지 불필요하게 <code class=\"language-text\">낭비</code>되고 있는 것을 확인할 수 있다.</p>\n<h2>외부 리소스 요청 로직 분리하기</h2>\n<p>트랜잭션은 필요한 부분에 최소한으로 적용되어야 하므로, 제어할 수 없는 외부 요청 로직을 분리해야 한다. 먼저 작성된 코드에서 트랜잭션이 필요한 로직만 남겨둔다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@RequiredArgsConstructor</span>\n<span class=\"token annotation punctuation\">@Service</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">MemberService</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">String</span> <span class=\"token constant\">NEWBIE</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"뉴비\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">String</span> <span class=\"token constant\">CONGRATULATIONS_MESSAGE</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"가입을 축하드립니다!\"</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">MemberRepository</span> memberRepository<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">HonorRepository</span> honorRepository<span class=\"token punctuation\">;</span>\n\n    <span class=\"token annotation punctuation\">@Transactional</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">Member</span> <span class=\"token function\">save</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">final</span> <span class=\"token class-name\">Member</span> member<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\">Member</span> savedMember <span class=\"token operator\">=</span> memberRepository<span class=\"token punctuation\">.</span><span class=\"token function\">save</span><span class=\"token punctuation\">(</span>member<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        honorRepository<span class=\"token punctuation\">.</span><span class=\"token function\">save</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Honor</span><span class=\"token punctuation\">(</span>savedMember<span class=\"token punctuation\">,</span> <span class=\"token constant\">NEWBIE</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> savedMember<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>트랜잭션이 불필요한 로직을 상위 클래스로 분리하여 작성한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@RequiredArgsConstructor</span>\n<span class=\"token annotation punctuation\">@Component</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">MemberRegister</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">String</span> <span class=\"token constant\">CONGRATULATIONS_MESSAGE</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"가입을 축하드립니다!\"</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">MemberService</span> memberService<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">OAuthClient</span> oAuthClient<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">EmailSender</span> emailSender<span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">Member</span> <span class=\"token function\">register</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">final</span> <span class=\"token class-name\">String</span> code<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\">Member</span> member <span class=\"token operator\">=</span> oAuthClient<span class=\"token punctuation\">.</span><span class=\"token function\">getMember</span><span class=\"token punctuation\">(</span>code<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">Member</span> savedMember <span class=\"token operator\">=</span> memberService<span class=\"token punctuation\">.</span><span class=\"token function\">save</span><span class=\"token punctuation\">(</span>member<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        emailSender<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span>savedMember<span class=\"token punctuation\">.</span><span class=\"token function\">getEmail</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">CONGRATULATIONS_MESSAGE</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> savedMember<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>기존에 <code class=\"language-text\">memberService</code>를 호출하던 부분을 <code class=\"language-text\">memberRegister</code>를 의존하도록 변경한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@RequiredArgsConstructor</span>\n<span class=\"token annotation punctuation\">@RequestMapping</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/members\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token annotation punctuation\">@RestController</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">MemberController</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">MemberRegister</span> memberRegister<span class=\"token punctuation\">;</span>\n\n    <span class=\"token annotation punctuation\">@PostMapping</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">ResponseEntity</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">MemberResponse</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">register</span><span class=\"token punctuation\">(</span><span class=\"token annotation punctuation\">@RequestBody</span> <span class=\"token class-name\">MemberRegisterRequest</span> request<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\">Member</span> savedMember <span class=\"token operator\">=</span> memberRegister<span class=\"token punctuation\">.</span><span class=\"token function\">register</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">.</span><span class=\"token function\">getCode</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">MemberResponse</span> response <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">MemberResponse</span><span class=\"token punctuation\">(</span>savedMember<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> <span class=\"token class-name\">ResponseEntity</span><span class=\"token punctuation\">.</span><span class=\"token function\">ok</span><span class=\"token punctuation\">(</span>response<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>위 로직을 그림으로 표현하면 아래와 같다.</p>\n<p><img src=\"https://user-images.githubusercontent.com/59357153/192531482-de0d3295-a02c-42c5-a5fe-5493be9d7fc7.png\" alt=\"\"></p>\n<p>불필요하게 낭비되던 데이터베이스 커넥션 유지 시간이 줄어든 것을 확인할 수 있다.</p>\n<h2>정리</h2>\n<p>지금까지 트랜잭션 내의 외부 리소스 요청에 대한 로직을 분리해야 하는 이유와 방법에 대해 간단히 알아보았다.</p>\n<p><code class=\"language-text\">제어할 수 없는 영역</code>인 외부 리소스에 대한 요청을 트랜잭션에서 분리하지 않으면 응답이 올 때까지 요청 스레드가 <code class=\"language-text\">대기</code>하게 된다. 이때 요청에 데이터베이스 로직이 포함되면 커넥션도 함께 <code class=\"language-text\">대기</code>하게 된다. <code class=\"language-text\">한정된 개수</code>를 가진 커넥션을 빠르게 반납하지 않으면 <code class=\"language-text\">병목 현상</code>이 일어날 수 있다.</p>\n<p>이런 상황을 피하기 위해서는 트랜잭션이 활성화된 범위를 <code class=\"language-text\">최소화</code>해야한다. 이러한 개선 작업을 통해 불필요하게 낭비되는 서버 자원을 적절히 아낄 수 있다.</p>\n<h2>Referernces.</h2>\n<ul>\n<li><a href=\"https://www.youtube.com/watch?v=Xx9BXrzNHn8\">구구의 Servlet &#x26; Servlet Container 강의</a></li>\n<li>백은빈, 이성욱 지음, 『Real MySQL 8.0』 (위키북스, 2021), 158-160.</li>\n</ul>","htmlAst":{"type":"root","children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"트랜잭션 처리를 위해서는 데이터베이스와 통신하기 위한 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"커넥션"}]},{"type":"text","value":"이 필요하다. 하지만 커넥션 생성을 위해서 많은 비용이 필요하다. 이러한 비용을 절감하기 위해 커넥션을 미리 생성한 뒤 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"커넥션 풀"}]},{"type":"text","value":"을 통해 관리한다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"커넥션 풀의 개수는 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"제한"}]},{"type":"text","value":"되어 있다. 만약 동시에 데이터베이스 처리 로직이 담긴 요청을 커넥션 풀의 개수 이상으로 받았다고 가정하자. 커넥션을 획득하지 못한 요청은 다른 데이터베이스 커넥션이 반납될 때까지 기다리게 될 것이다. 결국 이러한 상황이 길어지면 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"병목 현상"}]},{"type":"text","value":"이 발생하게 된다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"img","properties":{"src":"https://user-images.githubusercontent.com/59357153/192680529-da0076fe-6ac4-4fdc-aae5-49a00551abab.png","alt":""},"children":[]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"불필요한 로직이 섞인 트랜잭션"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"먼저 간단한 예시를 위해 아래와 같은 요구사항을 줬다고 가정한다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"회원가입을 진행한다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"회원가입은 외부 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"OAuth"}]},{"type":"text","value":"를 통해 진행된다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"우리는 전달받은 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"인가 코드"}]},{"type":"text","value":"를 기반으로 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"회원 정보를 조회"}]},{"type":"text","value":"한 뒤 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"회원가입"}]},{"type":"text","value":"을 진행한다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"회원가입이 완료되면 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"NEWBIE"}]},{"type":"text","value":"라는 칭호를 획득할 수 있다. (회원은 여러 개의 칭호를 가질 수 있다고 가정한다. "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"회원 : 칭호 = 1 : N"}]},{"type":"text","value":")"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"회원가입이 완료되면 가입한 email을 통해 가입 완료 메일을 전송한다."}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"위 과정을 코드로 표현하면 아래와 같다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"java"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-java"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-java"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","annotation","punctuation"]},"children":[{"type":"text","value":"@RequiredArgsConstructor"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","annotation","punctuation"]},"children":[{"type":"text","value":"@Service"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"public"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"class"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"MemberService"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n\n    "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"private"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"static"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"final"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"String"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","constant"]},"children":[{"type":"text","value":"NEWBIE"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"뉴비\""}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"private"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"static"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"final"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"String"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","constant"]},"children":[{"type":"text","value":"CONGRATULATIONS_MESSAGE"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"가입을 축하드립니다!\""}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n\n    "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"private"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"final"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"MemberRepository"}]},{"type":"text","value":" memberRepository"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"private"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"final"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"HonorRepository"}]},{"type":"text","value":" honorRepository"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"private"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"final"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"OAuthClient"}]},{"type":"text","value":" oAuthClient"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"private"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"final"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"EmailSender"}]},{"type":"text","value":" emailSender"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n\n    "},{"type":"element","tagName":"span","properties":{"className":["token","annotation","punctuation"]},"children":[{"type":"text","value":"@Transactional"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"public"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"Member"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"register"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"final"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"String"}]},{"type":"text","value":" code"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n        "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"Member"}]},{"type":"text","value":" member "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"text","value":" oAuthClient"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"getMember"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"text","value":"code"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"// 1"}]},{"type":"text","value":"\n\n        "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"Member"}]},{"type":"text","value":" savedMember "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"text","value":" memberRepository"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"save"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"text","value":"member"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"// 2"}]},{"type":"text","value":"\n        honorRepository"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"save"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"new"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"Honor"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"text","value":"savedMember"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","constant"]},"children":[{"type":"text","value":"NEWBIE"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"// 3"}]},{"type":"text","value":"\n\n        emailSender"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"send"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"text","value":"savedMember"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"getEmail"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","constant"]},"children":[{"type":"text","value":"CONGRATULATIONS_MESSAGE"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"// 4"}]},{"type":"text","value":"\n\n        "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"return"}]},{"type":"text","value":" savedMember"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"1"}]},{"type":"text","value":": 외부 서비스에서 인가 코드를 전달하여 회원 정보를 조회한다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"2"}]},{"type":"text","value":": 조회한 회원 정보를 기반으로 저장한다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"3"}]},{"type":"text","value":": 가입과 동시에 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"NEWBIE"}]},{"type":"text","value":" 칭호를 획득한다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"4"}]},{"type":"text","value":": 가입 축하 메일을 전송한다."}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"이 모든 과정은 하나의 논리적인 작업 단위이기 때문에 하나의 트랜잭션으로 묶여 진행된다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"위 로직 중 데이터베이스 트랜잭션이 실질적으로 사용되는 부분은 어디일까? 바로 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"2"}]},{"type":"text","value":", "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"3"}]},{"type":"text","value":"이다. "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"MemberRepository"}]},{"type":"text","value":"와 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"HonorRepository"}]},{"type":"text","value":"는 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"member"}]},{"type":"text","value":"와 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"honor"}]},{"type":"text","value":"를 적절히 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"영속"}]},{"type":"text","value":"시키기 위해 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"데이터베이스 커넥션"}]},{"type":"text","value":"을 활용한다. 외부 서비스를 통해 회원 정보를 조회하는 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"1"}]},{"type":"text","value":"과 메일을 전송하기 위한 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"4"}]},{"type":"text","value":"는 데이터베이스와 관련된 처리가 아니므로 데이터베이스를 활용한 트랜잭션이라 보기 어렵다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"또한 외부 서비스는 우리가 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"제어할 수 없는 영역"}]},{"type":"text","value":"에 가깝다. 데이터베이스의 커넥션과 요청 처리를 위한 스레드는 외부 서비스에서 적절한 응답이 올 때까지 계속 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"대기"}]},{"type":"text","value":"해야 한다. 특히 데이터베이스의 커넥션은 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"한정된 개수"}]},{"type":"text","value":"를 가지고 있다. 대기 시간이 길어질수록 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"병목 현상"}]},{"type":"text","value":"이 발생할 가능성이 커진다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"위 코드를 그림으로 표현하면 아래와 같다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"img","properties":{"src":"https://user-images.githubusercontent.com/59357153/192531474-38498110-b3c8-47b1-aafd-0c1ab3944c33.png","alt":""},"children":[]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"실질적으로 데이터베이스의 트랜잭션이 필요한 부분은 파란 화살표지만, 데이터베이스 커넥션을 사용하지 않는 시간까지 불필요하게 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"낭비"}]},{"type":"text","value":"되고 있는 것을 확인할 수 있다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"외부 리소스 요청 로직 분리하기"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"트랜잭션은 필요한 부분에 최소한으로 적용되어야 하므로, 제어할 수 없는 외부 요청 로직을 분리해야 한다. 먼저 작성된 코드에서 트랜잭션이 필요한 로직만 남겨둔다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"java"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-java"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-java"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","annotation","punctuation"]},"children":[{"type":"text","value":"@RequiredArgsConstructor"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","annotation","punctuation"]},"children":[{"type":"text","value":"@Service"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"public"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"class"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"MemberService"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n\n    "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"private"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"static"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"final"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"String"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","constant"]},"children":[{"type":"text","value":"NEWBIE"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"뉴비\""}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"private"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"static"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"final"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"String"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","constant"]},"children":[{"type":"text","value":"CONGRATULATIONS_MESSAGE"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"가입을 축하드립니다!\""}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n\n    "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"private"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"final"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"MemberRepository"}]},{"type":"text","value":" memberRepository"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"private"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"final"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"HonorRepository"}]},{"type":"text","value":" honorRepository"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n\n    "},{"type":"element","tagName":"span","properties":{"className":["token","annotation","punctuation"]},"children":[{"type":"text","value":"@Transactional"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"public"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"Member"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"save"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"final"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"Member"}]},{"type":"text","value":" member"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n        "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"Member"}]},{"type":"text","value":" savedMember "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"text","value":" memberRepository"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"save"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"text","value":"member"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n        honorRepository"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"save"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"new"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"Honor"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"text","value":"savedMember"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","constant"]},"children":[{"type":"text","value":"NEWBIE"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n        "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"return"}]},{"type":"text","value":" savedMember"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"트랜잭션이 불필요한 로직을 상위 클래스로 분리하여 작성한다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"java"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-java"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-java"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","annotation","punctuation"]},"children":[{"type":"text","value":"@RequiredArgsConstructor"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","annotation","punctuation"]},"children":[{"type":"text","value":"@Component"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"public"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"class"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"MemberRegister"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n\n    "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"private"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"static"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"final"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"String"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","constant"]},"children":[{"type":"text","value":"CONGRATULATIONS_MESSAGE"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"가입을 축하드립니다!\""}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n\n    "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"private"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"final"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"MemberService"}]},{"type":"text","value":" memberService"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"private"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"final"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"OAuthClient"}]},{"type":"text","value":" oAuthClient"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"private"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"final"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"EmailSender"}]},{"type":"text","value":" emailSender"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n\n    "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"public"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"Member"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"register"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"final"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"String"}]},{"type":"text","value":" code"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n        "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"Member"}]},{"type":"text","value":" member "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"text","value":" oAuthClient"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"getMember"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"text","value":"code"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n        "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"Member"}]},{"type":"text","value":" savedMember "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"text","value":" memberService"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"save"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"text","value":"member"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n        emailSender"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"send"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"text","value":"savedMember"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"getEmail"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","constant"]},"children":[{"type":"text","value":"CONGRATULATIONS_MESSAGE"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n        "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"return"}]},{"type":"text","value":" savedMember"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"기존에 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"memberService"}]},{"type":"text","value":"를 호출하던 부분을 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"memberRegister"}]},{"type":"text","value":"를 의존하도록 변경한다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"java"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-java"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-java"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","annotation","punctuation"]},"children":[{"type":"text","value":"@RequiredArgsConstructor"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","annotation","punctuation"]},"children":[{"type":"text","value":"@RequestMapping"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"/members\""}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","annotation","punctuation"]},"children":[{"type":"text","value":"@RestController"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"public"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"class"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"MemberController"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n\n    "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"private"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"final"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"MemberRegister"}]},{"type":"text","value":" memberRegister"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n\n    "},{"type":"element","tagName":"span","properties":{"className":["token","annotation","punctuation"]},"children":[{"type":"text","value":"@PostMapping"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"public"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"ResponseEntity"}]},{"type":"element","tagName":"span","properties":{"className":["token","generics"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"<"}]},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"MemberResponse"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":">"}]}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"register"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","annotation","punctuation"]},"children":[{"type":"text","value":"@RequestBody"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"MemberRegisterRequest"}]},{"type":"text","value":" request"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n        "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"Member"}]},{"type":"text","value":" savedMember "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"text","value":" memberRegister"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"register"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"text","value":"request"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"getCode"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n        "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"MemberResponse"}]},{"type":"text","value":" response "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"new"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"MemberResponse"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"text","value":"savedMember"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n        "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"return"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"ResponseEntity"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"ok"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"text","value":"response"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"위 로직을 그림으로 표현하면 아래와 같다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"img","properties":{"src":"https://user-images.githubusercontent.com/59357153/192531482-de0d3295-a02c-42c5-a5fe-5493be9d7fc7.png","alt":""},"children":[]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"불필요하게 낭비되던 데이터베이스 커넥션 유지 시간이 줄어든 것을 확인할 수 있다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"정리"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"지금까지 트랜잭션 내의 외부 리소스 요청에 대한 로직을 분리해야 하는 이유와 방법에 대해 간단히 알아보았다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"제어할 수 없는 영역"}]},{"type":"text","value":"인 외부 리소스에 대한 요청을 트랜잭션에서 분리하지 않으면 응답이 올 때까지 요청 스레드가 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"대기"}]},{"type":"text","value":"하게 된다. 이때 요청에 데이터베이스 로직이 포함되면 커넥션도 함께 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"대기"}]},{"type":"text","value":"하게 된다. "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"한정된 개수"}]},{"type":"text","value":"를 가진 커넥션을 빠르게 반납하지 않으면 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"병목 현상"}]},{"type":"text","value":"이 일어날 수 있다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"이런 상황을 피하기 위해서는 트랜잭션이 활성화된 범위를 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"최소화"}]},{"type":"text","value":"해야한다. 이러한 개선 작업을 통해 불필요하게 낭비되는 서버 자원을 적절히 아낄 수 있다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Referernces."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://www.youtube.com/watch?v=Xx9BXrzNHn8"},"children":[{"type":"text","value":"구구의 Servlet & Servlet Container 강의"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"백은빈, 이성욱 지음, 『Real MySQL 8.0』 (위키북스, 2021), 158-160."}]},{"type":"text","value":"\n"}]}],"data":{"quirksMode":false}},"excerpt":"…","timeToRead":3,"frontmatter":{"title":"트랜잭션 내에 외부 리소스 요청이 담기게 되면 어떤 문제가 발생할까?","userDate":"20 September 2022","date":"2022-09-20T00:00:00.000Z","tags":["transactional"],"excerpt":null,"image":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA+UlEQVR42p2TO6qEMBSGU1i4CxvBQlyCNq5EcQWKjbYWLkZFcQVWFpbuQAvdgCC+/ssJzGUu3HEmcyCcPyT5ch4Jg6Bd13W7zu4OHseBdV35vCgK1HX99kL2KoJxHOG6LjzPg+M4MAwDjDFEUfRdhNu2YZ5nDiWQLMuwLAvDMNym/i+QUiXLsozDdF2Hqqpc53n+Z89HwH3fuY/jmEPCMPzV5J/3CEVYVRWHKIoCTdO4LstSPMJHfbqu4+lS/Qhm2zbatsWyLOJNIUvTFJIkwTRNJEmCIAjg+z6maXrZGPbuAfd9j6ZpuD7PU/wdPtsDQHDSVDcad7/lB9e0E9L6AdueAAAAAElFTkSuQmCC"},"images":{"fallback":{"src":"/static/78909983daa4e23be69f5f64d315c228/afa5c/external-in-transaction.png","srcSet":"/static/78909983daa4e23be69f5f64d315c228/0dee1/external-in-transaction.png 750w,\n/static/78909983daa4e23be69f5f64d315c228/8beaa/external-in-transaction.png 1080w,\n/static/78909983daa4e23be69f5f64d315c228/d079a/external-in-transaction.png 1366w,\n/static/78909983daa4e23be69f5f64d315c228/afa5c/external-in-transaction.png 1920w","sizes":"100vw"},"sources":[{"srcSet":"/static/78909983daa4e23be69f5f64d315c228/ba386/external-in-transaction.avif 750w,\n/static/78909983daa4e23be69f5f64d315c228/8adb1/external-in-transaction.avif 1080w,\n/static/78909983daa4e23be69f5f64d315c228/dc6b3/external-in-transaction.avif 1366w,\n/static/78909983daa4e23be69f5f64d315c228/031aa/external-in-transaction.avif 1920w","type":"image/avif","sizes":"100vw"},{"srcSet":"/static/78909983daa4e23be69f5f64d315c228/a66aa/external-in-transaction.webp 750w,\n/static/78909983daa4e23be69f5f64d315c228/65dd5/external-in-transaction.webp 1080w,\n/static/78909983daa4e23be69f5f64d315c228/4fad6/external-in-transaction.webp 1366w,\n/static/78909983daa4e23be69f5f64d315c228/c512e/external-in-transaction.webp 1920w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.5625}}},"author":[{"name":"4기_매트","bio":"우아한테크코스 4기 매트(최기현)입니다 :)","avatar":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","backgroundColor":"#384848","images":{"fallback":{"src":"/static/d0383ede10aebc9055f7d5902f2ac4ea/99ed2/mat.jpg","srcSet":"/static/d0383ede10aebc9055f7d5902f2ac4ea/f6b2a/mat.jpg 40w,\n/static/d0383ede10aebc9055f7d5902f2ac4ea/1b13e/mat.jpg 80w,\n/static/d0383ede10aebc9055f7d5902f2ac4ea/99ed2/mat.jpg 120w","sizes":"100vw"},"sources":[{"srcSet":"/static/d0383ede10aebc9055f7d5902f2ac4ea/2be77/mat.webp 40w,\n/static/d0383ede10aebc9055f7d5902f2ac4ea/5e049/mat.webp 80w,\n/static/d0383ede10aebc9055f7d5902f2ac4ea/f7a7a/mat.webp 120w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.9083333333333333}}}}],"source":null}},"relatedPosts":{"totalCount":3,"edges":[{"node":{"id":"f86a6336-fe74-5ddf-b375-b6fcdd2abb6d","timeToRead":6,"excerpt":"안녕하세요. 우아한테크코스 5기 BE…","frontmatter":{"title":"무한스크롤 기능에서 동시성 이슈 해결하기","date":"2023-10-11T12:00:00.000Z"},"fields":{"slug":"/post/2023-08-16-ObjectOptimisticLockingFailureException/"}}},{"node":{"id":"2f9c3482-bb8c-5939-8d77-c45988ed96be","timeToRead":3,"excerpt":"…","frontmatter":{"title":"트랜잭션 내에 외부 리소스 요청이 담기게 되면 어떤 문제가 발생할까?","date":"2022-09-20T00:00:00.000Z"},"fields":{"slug":"/post/2022-09-20-external-in-transaction/"}}},{"node":{"id":"4bbaafa6-9116-5be7-acdb-8d49ba5f2d3e","timeToRead":2,"excerpt":"@Transactional…","frontmatter":{"title":"Transactional 어노테이션","date":"2021-04-26T12:00:00.000Z"},"fields":{"slug":"/post/2021-05-25-transactional/"}}}]}},"pageContext":{"slug":"/post/2022-09-20-external-in-transaction/","prev":{"excerpt":"레벨 3 프로젝트 과정 중 이미지 서버를 개발하고 개선해나가는 과정을 이야기하려 합니다. 왜 이미지 서버를 만들어야 하는가? 레벨…","timeToRead":4,"frontmatter":{"title":"이미지 스토리지 서버 구축 및 최적화","tags":["nginx","image","cache"],"date":"2022-09-13T12:00:00.000Z","draft":false,"excerpt":null,"image":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABYlAAAWJQFJUiTwAAABjElEQVR42oVS3ytDYRg+N/4Cf4RLLl3IDaXsBhFTK3GBpKmVRX6m/MqPTrJxQbbEFK0lTdaM2hoXw47ThllLcXZhkpLtzPnO45xvjNHyfH31fu/7fs/3vO/7MfiErCwVSUlESkrn+GRZxu+8fGfm54X9Oz+Kt3Qot3fCF+eojxACSd2SRM/PqUeYuSEsXPQruw/C613Oo8w7ySSy3BY0ewZU7+pRtKZB6XYbbDcuGruO3EAUU9TevGLR522CNTSDYX8LlrnRHKVMmrxTQ388jfajSarMzNtR5ejGXHAdiVgctQ11cB94ICRjCpkWq/wETMFBWMOzMHobwSdOM9XI5JvQ4J2H1mlEjaLSfR9AtaMLUwELjS0umSA8xJEkrxjxt2KFHwd73gtLaBr9vmY8vgnZshmVVcVl4hb1BwMoYEtQaC6D7nAM0Zd7GlN7SORMa3yCEx3uCswEetDproQztpFVlx3KF1SnLeLCTtSDfFCJw09nOBFctNQ0Ef9O+Uvuz+9BFJvI8h/C/77NB7BjNkm6qQVYAAAAAElFTkSuQmCC"},"images":{"fallback":{"src":"/static/30e739e21332622c2eb01b602c2e97e4/10565/image-storage-server.png","srcSet":"/static/30e739e21332622c2eb01b602c2e97e4/99583/image-storage-server.png 750w,\n/static/30e739e21332622c2eb01b602c2e97e4/c4ce2/image-storage-server.png 1080w,\n/static/30e739e21332622c2eb01b602c2e97e4/b7075/image-storage-server.png 1366w,\n/static/30e739e21332622c2eb01b602c2e97e4/10565/image-storage-server.png 1618w","sizes":"100vw"},"sources":[{"srcSet":"/static/30e739e21332622c2eb01b602c2e97e4/2b35b/image-storage-server.webp 750w,\n/static/30e739e21332622c2eb01b602c2e97e4/509d8/image-storage-server.webp 1080w,\n/static/30e739e21332622c2eb01b602c2e97e4/2e994/image-storage-server.webp 1366w,\n/static/30e739e21332622c2eb01b602c2e97e4/fef7f/image-storage-server.webp 1618w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.42398022249690975}}},"author":[{"name":"4기_오리","bio":"우아한테크코스 4기 오리(최진영)입니다 :)","avatar":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAADxElEQVR42pWU60/TVxjH+2+Q8M7XC5svNBt7s5ERN4aOdYpCoQiCMDpuFWiH3FruJVLaighlSoEBLWA3izZcZli5VOZg3HQrFJxsU+NmgBcOBvSzX0u6TVF0JznJOXnO+T7f73MT8Ypre3sbj8fzz917/u/dv0SvAub9uLW15TsPDTnQ1hpYW11lc3Pz/wN6mXnX/LyLgoJiIj46RPDBfYQfPoLdft1n8zvbE9DLyi9zfX0dqVRKcHAwCVH7SUsO58DBtxkedjzl9KWA/sfFxcVIJBJkqacJfXc/x8ShJCQkMT019XJAv3FmdoavLUZ0NRqORZ4gP/8scvkZMrLkHBe/RcSRDxgbu7m3ZD+r3x+vYvpCx9qtIpydycRGRRB/KoXcnGwUCiUJkveI+PAADx7+8dS/FwJ2WczMj2jhnh5+q+MXRz5lOZFIY6I5HhVH3NF9NBhy2NHieX6W/VJ/dC3RZykXwM6xekuNqz+P+9+VsDJbwVinDGPFSeQn36Tb3LxL7jOAO4YbNwb4afBzuFvDwzEVndoYBi4ncdP8KWNdmfDAwF9zpVhNlWzsLsN/AT2eHYb9djO/OpQCYC23bZnoqgtxjk/QWKfBaU4DVzW4q7A25/N45cmLY+hnOHDdysKAHB5dYNlxFmO1DFtbKdpyBXZjAizXsjmrxtpSyp8be7SeP4Zu9yJGzWkGTTJWJsvYXtAwdzWD+wLrroZc3EMq7g0psdu6d9WgD9AbVP/296ZOfx5plJjJqwqeTBT4WN0eVNBhsdLRWEhl7sfM3lnwvd3Y2PD982OIni2ZBbeb3Mwk4iRismXRfNWho6k6FashlrLcSDJSolgSQnLNomfb85yyGR0dZWJigpnpKX6YvkP7xTzWxpU0aAsY/36auz8vYx8YxmwspK/pFJcqY3jkLEGeFEaNVkdHezsWi8U3PBYXlxCpVCrUajWtrS20tHVSlRfDhDWd5kuNuFzz1J03YDI1U1GuIfHoOyyMFKOtLqW+oYkv29qEzlGg1WqFPk8lO1aMqKenB5vNxsjwMM0trWQlx5MfF05TfZ3AfJJvh4aYF8JgaqynSBqGKvMEl00tWK9cYW5uDofDQW9vLyUlpcREhCEymUwYjUbf1ur0pEZ/Qm1mPFkpiXQKUpxOp5AkvRDXdC6o80gXkpUolVClqeJcTY0wIwsICAggMDCQoNffQGQw6JF9lobk8CFiQoPJyznD4OA3WLq6USqVpKSkCFNGTpEwwkytbfT191OhLkImft/n/LWgIEJCQnzSL9bX8zfLih3KzdB9DgAAAABJRU5ErkJggg=="},"images":{"fallback":{"src":"/static/eb0d39b517ea32a18b9b6239fa2da091/30cdc/ori.png","srcSet":"/static/eb0d39b517ea32a18b9b6239fa2da091/30cdc/ori.png 300w","sizes":"100vw"},"sources":[{"srcSet":"/static/eb0d39b517ea32a18b9b6239fa2da091/078c3/ori.webp 300w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":1}}}}]},"fields":{"layout":"post","slug":"/post/2022-09-13-image-storage-server/"}},"next":{"excerpt":"본 포스팅은 도커에 대한 자세한 개념, 도커 기본 명령어, 컨테이너 실행 실습, 도커 컴포즈, 도커 이미지 빌드, 도커 허브에 이미지 배포 등 전반적인 도커 기초에 대한 내용을 다룬다. 도커 (Docker…","timeToRead":15,"frontmatter":{"title":"이론과 실습을 통해 이해하는 Docker 기초","tags":["docker"],"date":"2022-09-25T12:00:00.000Z","draft":false,"excerpt":null,"image":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAABSklEQVR42rWSy0rDQBSGs3crPoeP4tpX8ClcCm7cCLopitSFLrxU8FYJrVFQK4Ta0oto2swkrbTapDF2mkl+c2mqcSfVgcM5M3Pm+zlnjoA/XsLPA9fzQguWNynQG4Ec1wX3bSJgDCs2CBa2j1BuUhDzAwZzIhHOx0Lc9cAcDjeIeeQTwLhESdExs7wLYXETczs5zGcKuCMv4Z1CKHpvr6CaBpUQaBoFbbVQVxogemvMSAAPio+Y3RAxtX6J6dUsTstPYSctx8WSTLH33MVaWUe61kaGGKgoKtL7GayktmDZdrLkoJSmSnBfqSIlybguVdE3DFjvNhxf74wayGomTnwv6iZuOza6Zh+lWh35mwIGjEXAuHc900/OSzgWc5CLDzg8v/D3V2h3uoke/+pTBmwYKgXGhsPQvsYpyIl8HHujd9/FhH8f7EmBnyIOS24kZ/CsAAAAAElFTkSuQmCC"},"images":{"fallback":{"src":"/static/40a730f43ffb6c029e36c9be353f9f92/afa5c/docker-basic.png","srcSet":"/static/40a730f43ffb6c029e36c9be353f9f92/0dee1/docker-basic.png 750w,\n/static/40a730f43ffb6c029e36c9be353f9f92/8beaa/docker-basic.png 1080w,\n/static/40a730f43ffb6c029e36c9be353f9f92/d079a/docker-basic.png 1366w,\n/static/40a730f43ffb6c029e36c9be353f9f92/afa5c/docker-basic.png 1920w","sizes":"100vw"},"sources":[{"srcSet":"/static/40a730f43ffb6c029e36c9be353f9f92/a66aa/docker-basic.webp 750w,\n/static/40a730f43ffb6c029e36c9be353f9f92/65dd5/docker-basic.webp 1080w,\n/static/40a730f43ffb6c029e36c9be353f9f92/4fad6/docker-basic.webp 1366w,\n/static/40a730f43ffb6c029e36c9be353f9f92/c512e/docker-basic.webp 1920w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.5625}}},"author":[{"name":"4기_후디","bio":"우아한테크코스 4기 후디(조동현)입니다 :)","avatar":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAIAAAAC64paAAAACXBIWXMAAAsTAAALEwEAmpwYAAAEvElEQVR42hWOWVNaBwCF71/oU5pJJh0THZOmpkmzTXZMpSKKAeWyc0EBBYQLaAAZouwXUJZEEVB2EFwCAm6oQQG1xpiaaZqmnWZrmsR00qbTmf6Ckpkz5+37zgFoFCq2CazHkklkrkyqkMJyLlfC4cJcLgyxhCQyp6mZhsGSsE1kkNTO40kglqCFyMK3QM14BoC6dJHDIHNYEIUC4QhQQwOBSqIJ+FK+UOHzeFQqHbNNyuJImWwxk9VV1lEon3TfYYh19a3ADWxj7bWGOgwGJDSreuAufifYSqIxBWXGaXMo5H1UGp/G4LNYXRKJgsHobAXZraQ2kNwOkjmAw6ypOXlFpBiQ9w3ZrWaP0wTicWJBJwRxW4hsKo1Hh4QMFizt7p+IBrtEvXRIRKXzCa2spmYK0IjFX7yKveNf3P7lv9zGK3883yUzNOFIDCrJbuj2WLsRVQcTvIFG1UIUYq+0o41KqEddJjei+BQM4LToFHKlO7a69dM/+Qd7+Z33+e234eQ2YgtnU0k+j6OWsZ06gVxAvimkwGwc/tsz3TzCCCLwDcDAVRT2Gro1nn24/eRjaXdvcf3lQuG35Y0X9x9/LO3skVk3T5++cDdgTIUty1N2nYR58ujhYQSeiSLj3j7g/GUMqp40t/astPuhfHtp89W97XcrpV9jDmSt+HOHzIyuQ+cS9tyEc31u1NrDxl07m41aZkLIpE8LXL7ejCWwVh/slR79vfbwz6WNV5mVJ7nSs7A3GLVppF0wGo3ZnB/7sTi+kw+HreKAnlfIuHIT9nTEUoZxRLqwuPuhnJWtP5Y2f8/ff1Pcebf1+N90puhV83wIXJx1FTP2e8mBKV//TEi3OX87n7ozH3cAl1CNrE5lcfevtZ339+6/Xf7+dW795Vz+6eLq06X1F1SmqAvCDyPSmEtZSNsmRtWZiG4hrk/5NSt3h4BT5+t4Ym3hh/Lsm/L5sqLwYG916/Vy6fnaxnNYJIGImGTQkoki8wnT3LgpN2mOj8hDDmk+5QJqUWg8gSKEVZIenUI90Nvn7Dd69BY/Yo9GIskxs3RMxynNeqcDxkzEkA5bFicHYq6bfrt8dcYFzI8PpsPmyVF9wNE7jHQfq6yQdVJdFvkdk2LMoQ44lFNezdL0UMilToYMqaAmFbyV9KtnY9ZPcDpinomYy50MIjG3puZolXdQsTnr3pxzFzPuQsb7aDVUSLvGnMrpgH4xYUyH+ic8ymzEnE8OAZM+w5TfWM603+S1Kb+sqhixKuM+a9Rr9Q2Z3U4k4LK4nUZrvyg81JvwqLIRbTaqXUwMLk/dBuKjhkmfMT6qn/SZBrVwTXUFjyc8+A216iLr8Dl6xTn6oTPUgyeJt2TtJhlIwl7hkuttKmg+alpI2IHQcH9kRBt2ace9xh4hs/rIF0w6/fhZTM0FQsUZyoFTlP0nwH1f4dUS9vggH2Y2iBmYkT4oG9QtJGzAqFMdHNaEhrXTAYugnXS8+ghIYn5WWXfwa/z+E8QDp8if17TsryEoRYyItcMoo2rExDFDe8KtmQoMAv7bfTGPITKin4k62xnE40erQLZi31lOZa2o8jpcjZYeQYmOobiW3rYAwpFyQRoO5dVCul5xe0f3/7W+WZyG8qhMAAAAAElFTkSuQmCC"},"images":{"fallback":{"src":"/static/e88c3ca6c1dcd01f0a3a4db5b3373c50/9d770/hudi.png","srcSet":"/static/e88c3ca6c1dcd01f0a3a4db5b3373c50/1f5a0/hudi.png 750w,\n/static/e88c3ca6c1dcd01f0a3a4db5b3373c50/49c33/hudi.png 1080w,\n/static/e88c3ca6c1dcd01f0a3a4db5b3373c50/9d770/hudi.png 1326w","sizes":"100vw"},"sources":[{"srcSet":"/static/e88c3ca6c1dcd01f0a3a4db5b3373c50/bfb22/hudi.webp 750w,\n/static/e88c3ca6c1dcd01f0a3a4db5b3373c50/f8491/hudi.webp 1080w,\n/static/e88c3ca6c1dcd01f0a3a4db5b3373c50/9ca41/hudi.webp 1326w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.9969834087481146}}}}]},"fields":{"layout":"post","slug":"/post/2022-09-20-docker-basic/"}},"primaryTag":"transactional"}},"staticQueryHashes":["2337738035"],"slicesMap":{}}