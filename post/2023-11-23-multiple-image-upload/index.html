<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 2.27.0"/><link rel="preconnect" href="https://www.googletagmanager.com"/><link rel="dns-prefetch" href="https://www.googletagmanager.com"/><link rel="sitemap" type="application/xml" href="/sitemap.xml"/><link rel="canonical" href="https://tecoble.techcourse.co.kr/post/2023-11-23-multiple-image-upload/" data-baseprotocol="https:" data-basehost="tecoble.techcourse.co.kr"/><title data-react-helmet="true">다중 이미지 업로드 최적화: 병렬 스트림과 CompletableFuture</title><link data-react-helmet="true" rel="icon" href="data:image/vnd.microsoft.icon;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAjhJREFUeNrEV4uRgkAMzdmAlGAJdqDXgSVYgiXQgSVYgiWgFYAVYAdqBXv7kDAhhGVFPDOT8QObvPyzRDU55xLPqefSfY7KWkdCkmrlufs/yhnET/0l87ykCLper1QUBV0uF7rf79Xv5fJ5dLVa0Xq9pkgqPP9S7ZInrDx3m83GwSlJkrg0bR65LMucF149CzHObbdbV5ZRkUyJY3673arDWuBut6ve5N8QfjgcOgoAcL/fO++N5l1pQF9OUAPFv9xnFZRBQaRV1bsMBJ8wro8aAOx6iyFwDMFbQyCiPdBnKRi500cIF2Qgf4IAoMTKAXhGK7W8FUo+9oSVE9QqTm/JYrFoJRy7Dp8saKgKYLUmyMUzHQqKjWcoRyzWIOA5ywtkvaRjGsqPkCd0OOAFcC8AdrE82NcfYhjyLEOkgS0AyFSUjJXFY9nyMBoW00w259PpRN5FrYZ9Pp/pHYJMJp4Tj8ej+W+mD/BgkcNnapIyZ/Rl6gDAqJWkQzIFSZktAIiRdjlm/Dsk9wPOh/l8bgNA/OEBCcI3IPJlOEq5L0MzoVtLiyyT4/HYKZMpGxHKPNiI+rrVFK2YB54G1QHA1uqePXYYQQ53UjncgsOItxlrzr8yjq0uqtuzCQCKIRAcWjaGFhIL6GAOaPQAMXYlw0KrAehZE9wHUBUyfq8spagk9qQEAJkaQFAqlMr7QOxaDsUcTpwBa+W8lqexVn3iYvLy1QzXMbRUXM14drx1Nfv25ZS+fT3/E2AAsWMCdac8y9AAAAAASUVORK5CYII=" type="image/x-icon"/><meta data-react-helmet="true" name="description" content="사이드 프로젝트로 sns…"/><meta data-react-helmet="true" property="og:site_name" content="Tecoble"/><meta data-react-helmet="true" property="og:type" content="article"/><meta data-react-helmet="true" property="og:title" content="다중 이미지 업로드 최적화: 병렬 스트림과 CompletableFuture"/><meta data-react-helmet="true" property="og:description" content="사이드 프로젝트로 sns…"/><meta data-react-helmet="true" property="og:url" content="https://post/2023-11-23-multiple-image-upload/"/><meta data-react-helmet="true" property="og:image" content="https://static/28febf62529b1836b34c354877ee228e/271e4/multiple-image-upload.png"/><meta data-react-helmet="true" property="article:published_time" content="2023-11-23T13:00:00.000Z"/><meta data-react-helmet="true" property="article:tag" content="parallelism"/><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"/><meta data-react-helmet="true" name="twitter:title" content="다중 이미지 업로드 최적화: 병렬 스트림과 CompletableFuture"/><meta data-react-helmet="true" name="twitter:description" content="사이드 프로젝트로 sns…"/><meta data-react-helmet="true" name="twitter:url" content="https://post/2023-11-23-multiple-image-upload/"/><meta data-react-helmet="true" name="twitter:image" content="https://tecoble.techcourse.co.kr//static/28febf62529b1836b34c354877ee228e/271e4/multiple-image-upload.png"/><meta data-react-helmet="true" name="twitter:label1" content="Written by"/><meta data-react-helmet="true" name="twitter:data1" content="5기_애쉬"/><meta data-react-helmet="true" name="twitter:label2" content="Filed under"/><meta data-react-helmet="true" name="twitter:data2" content="parallelism"/><meta data-react-helmet="true" property="og:image:width" content="1494"/><meta data-react-helmet="true" property="og:image:height" content="849.8129032258065"/><link rel="alternate" type="application/rss+xml" href="/rss.xml"/><link as="script" rel="preload" href="/webpack-runtime-674180cef417bd6b6e8f.js"/><link as="script" rel="preload" href="/framework-2de79c8137b068b61a3a.js"/><link as="script" rel="preload" href="/app-7871a49fb71b5d2fd8af.js"/><link as="script" rel="preload" href="/commons-4c188b18bcaae3f07bde.js"/><link as="script" rel="preload" href="/component---src-templates-post-tsx-a08628f9047d81b892e4.js"/><link as="fetch" rel="preload" href="/page-data/post/2023-11-23-multiple-image-upload/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/2130001345.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/4041952199.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="post-template"><style data-emotion="css-global 8s70am">html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td,article,aside,canvas,details,embed,figure,figcaption,footer,header,hgroup,menu,nav,output,ruby,section,summary,time,mark,audio,video{margin:0;padding:0;border:0;font:inherit;font-size:100%;vertical-align:baseline;}body{line-height:1;}ol,ul{list-style:none;}blockquote,q{quotes:none;}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none;}table{border-spacing:0;border-collapse:collapse;}img{max-width:100%;}html{box-sizing:border-box;font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;}*,*:before,*:after{box-sizing:inherit;}a{background-color:transparent;}a:active,a:hover{outline:0;}b,strong{font-weight:bold;}i,em,dfn{font-style:italic;}h1{margin:0.67em 0;font-size:2em;}small{font-size:80%;}sub,sup{position:relative;font-size:75%;line-height:0;vertical-align:baseline;}sup{top:-0.5em;}sub{bottom:-0.25em;}img{border:0;}svg:not(:root){overflow:hidden;}mark{background-color:#fdffb6;}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em;}button,input,optgroup,select,textarea{margin:0;color:inherit;font:inherit;}button{overflow:visible;border:none;}button,select{text-transform:none;}button,html input[type='button'],input[type='reset'],input[type='submit']{cursor:pointer;-webkit-appearance:button;}button[disabled],html input[disabled]{cursor:default;}button::-moz-focus-inner,input::-moz-focus-inner{padding:0;border:0;}input{line-height:normal;}input:focus{outline:none;}input[type='checkbox'],input[type='radio']{box-sizing:border-box;padding:0;}input[type='number']::-webkit-inner-spin-button,input[type='number']::-webkit-outer-spin-button{height:auto;}input[type='search']{box-sizing:content-box;-webkit-appearance:textfield;}input[type='search']::-webkit-search-cancel-button,input[type='search']::-webkit-search-decoration{-webkit-appearance:none;}legend{padding:0;border:0;}textarea{overflow:auto;}table{border-spacing:0;border-collapse:collapse;}td,th{padding:0;}html{overflow-x:hidden;overflow-y:scroll;font-size:62.5%;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);}body{overflow-x:hidden;color:#303a3e;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Oxygen,Ubuntu,Cantarell,'Open Sans','Helvetica Neue',sans-serif;font-size:1.6rem;line-height:1.6em;font-weight:400;font-style:normal;letter-spacing:0;text-rendering:optimizeLegibility;background:#fff;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;-moz-font-feature-settings:'liga' on;}hr{position:relative;display:block;width:100%;margin:2.5em 0 3.5em;padding:0;height:1px;border:0;border-top:1px solid #e4eaed;}audio,canvas,iframe,img,svg,video{vertical-align:middle;}fieldset{margin:0;padding:0;border:0;}textarea{resize:vertical;}p,ul,ol,dl,blockquote{margin:0 0 1.5em 0;}ol,ul{padding-left:1.3em;padding-right:1.5em;}ol ol,ul ul,ul ol,ol ul{margin:0.5em 0 1em;}ul{list-style:disc;}ol{list-style:decimal;}ul,ol{max-width:100%;}li{margin:0.5em 0;padding-left:0.3em;line-height:1.6em;}dt{float:left;margin:0 20px 0 0;width:120px;color:#15171A;font-weight:500;text-align:right;}dd{margin:0 0 5px 0;text-align:left;}blockquote{margin:1.5em 0;padding:0 1.6em 0 1.6em;border-left:#e5eff5 0.5em solid;}blockquote p{margin:0.8em 0;font-size:1.2em;font-weight:300;}blockquote small{display:inline-block;margin:0.8em 0 0.8em 1.5em;font-size:0.9em;opacity:0.8;}blockquote cite{font-weight:bold;}blockquote cite a{font-weight:normal;}a{color:#26a6ed;-webkit-text-decoration:none;text-decoration:none;}a:hover{-webkit-text-decoration:underline;text-decoration:underline;}h1,h2,h3,h4,h5,h6{margin-top:0;line-height:1.15;font-weight:600;text-rendering:optimizeLegibility;}h1{margin:0 0 0.5em 0;font-size:5.5rem;font-weight:600;}@media (max-width: 500px){h1{font-size:2.2rem;}}h2{margin:1.5em 0 0.5em 0;font-size:2.2rem;}@media (max-width: 500px){h2{font-size:1.8rem;}}h3{margin:1.5em 0 0.5em 0;font-size:1.8rem;font-weight:500;}@media (max-width: 500px){h3{font-size:1.7rem;}}h4{margin:1.5em 0 0.5em 0;font-size:1.6rem;font-weight:500;}h5{margin:1.5em 0 0.5em 0;font-size:1.4rem;font-weight:500;}h6{margin:1.5em 0 0.5em 0;font-size:1.4rem;font-weight:500;}body{background:#fff;}@media (prefers-color-scheme: dark){body{color:rgba(255, 255, 255, 0.75);background:#191b1f;}img{opacity:0.9;}}</style><style data-emotion="css 12e1ozp">.css-12e1ozp .site-main{margin-top:64px;background:#fff;padding-bottom:4vw;}@media (prefers-color-scheme: dark){.css-12e1ozp .site-main{background:#191b1f;}}</style><style data-emotion="css 159sn72">.css-159sn72{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;min-height:100vh;}.css-159sn72 .site-main{margin-top:64px;background:#fff;padding-bottom:4vw;}@media (prefers-color-scheme: dark){.css-159sn72 .site-main{background:#191b1f;}}</style><div class="css-159sn72"><header class="site-header"><style data-emotion="css sdrsc">.css-sdrsc{position:relative;padding:0 5vw;position:fixed;top:0;right:0;left:0;z-index:1000;background:#0a0b0c;}@media (max-width: 700px){.css-sdrsc{padding-right:0;padding-left:0;}}</style><div class="css-sdrsc"><style data-emotion="css 1q5n7pp">.css-1q5n7pp{margin:0 auto;max-width:1040px;width:100%;}</style><div class="css-1q5n7pp"><style data-emotion="css 1phqi3w">.css-1phqi3w{position:relative;z-index:100;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;overflow-y:hidden;height:64px;font-size:1.3rem;}</style><nav class="css-1phqi3w"><style data-emotion="css vp1an1">.css-vp1an1{-webkit-flex:1 0 auto;-ms-flex:1 0 auto;flex:1 0 auto;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;overflow-x:auto;overflow-y:hidden;-webkit-overflow-scrolling:touch;margin-right:10px;padding:10px 0 80px;font-weight:500;letter-spacing:0.2px;text-transform:uppercase;white-space:nowrap;-ms-overflow-scrolling:touch;}@media (max-width: 700px){.css-vp1an1{margin-right:0;padding-left:5vw;}}</style><div class="site-nav-left css-vp1an1"><style data-emotion="css 1l8e9ha">.css-1l8e9ha{position:relative;z-index:100;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;display:inline-block;margin-right:32px;padding:12px 0;color:#fff;font-size:1.7rem;line-height:1.8rem;font-weight:bold;letter-spacing:-0.5px;text-transform:none;}.css-1l8e9ha:hover{-webkit-text-decoration:none;text-decoration:none;}.css-1l8e9ha img{display:block;width:auto;height:21px;}</style><a class="site-nav-logo css-1l8e9ha" href="/"><img src="/static/0b18bd94a62a12fdc81ea720c28722f6/3891b/tecoble.png" alt="Tecoble"/></a><style data-emotion="css 1muigz5">.css-1muigz5{position:relative;-webkit-align-self:flex-start;-ms-flex-item-align:flex-start;align-self:flex-start;}</style><div class="css-1muigz5"><style data-emotion="css 1gas2t1">.css-1gas2t1{position:absolute;z-index:1000;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;margin:0 0 0 -12px;padding:0;list-style:none;-webkit-transition:all 1s cubic-bezier(0.19, 1, 0.22, 1);transition:all 1s cubic-bezier(0.19, 1, 0.22, 1);}.css-1gas2t1 li{display:block;margin:0;padding:0;}.css-1gas2t1 li a{position:relative;display:block;padding:12px 12px;color:#fff;opacity:0.8;-webkit-transition:opacity 0.35s ease-in-out;transition:opacity 0.35s ease-in-out;}.css-1gas2t1 li a:hover{-webkit-text-decoration:none;text-decoration:none;opacity:1;}.css-1gas2t1 li a:before{content:'';position:absolute;right:100%;bottom:8px;left:12px;height:1px;background:#fff;opacity:0.25;-webkit-transition:all 0.35s ease-in-out;transition:all 0.35s ease-in-out;}.css-1gas2t1 li a:hover:before{right:12px;opacity:0.5;}</style><ul role="menu" class="css-1gas2t1"><li role="menuitem"><a href="/">Home</a></li><li role="menuitem"><a href="https://woowacourse.github.io/">woowacourse</a></li></ul><style data-emotion="css ybggi6">.css-ybggi6{visibility:hidden;position:absolute;top:9px;color:#fff;font-size:1.7rem;font-weight:400;text-transform:none;opacity:0;-webkit-transition:all 1s cubic-bezier(0.19, 1, 0.22, 1);transition:all 1s cubic-bezier(0.19, 1, 0.22, 1);-webkit-transform:translateY(175%);-moz-transform:translateY(175%);-ms-transform:translateY(175%);transform:translateY(175%);}.css-ybggi6 .dash{left:-25px;}.css-ybggi6 .dash:before{content:'– ';opacity:0.5;}</style><span class="nav-post-title css-ybggi6">다중 이미지 업로드 최적화: 병렬 스트림과 CompletableFuture</span></div></div><style data-emotion="css 19iu1ve">.css-19iu1ve{-webkit-flex:0 1 auto;-ms-flex:0 1 auto;flex:0 1 auto;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:end;-ms-flex-pack:end;-webkit-justify-content:flex-end;justify-content:flex-end;padding:10px 0;height:64px;}@media (max-width: 700px){.css-19iu1ve{display:none;}}</style><div class="css-19iu1ve"><style data-emotion="css ienhkd">.css-ienhkd{-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><div class="css-ienhkd"></div></div></nav></div></div></header><style data-emotion="css zqbwy4">.css-zqbwy4{-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;position:relative;padding:0 5vw;}@media (prefers-color-scheme: dark){.css-zqbwy4{background:#191b1f;}}</style><main id="site-main" class="site-main css-zqbwy4"><div class="css-1q5n7pp"><style data-emotion="css l1e7lw">.css-l1e7lw{position:relative;z-index:50;}</style><article class="css-l1e7lw"><style data-emotion="css rxh1cu">.css-rxh1cu{position:relative;margin:0 auto;padding:70px 170px 50px;border-top-left-radius:3px;border-top-right-radius:3px;}@media (max-width: 1170px){.css-rxh1cu{padding:60px 11vw 50px;}}@media (max-width: 800px){.css-rxh1cu{padding-right:5vw;padding-left:5vw;}}@media (max-width: 500px){.css-rxh1cu{padding:20px 0 35px;}}</style><header class="post-full-header css-rxh1cu"><style data-emotion="css 1ehbhhx">.css-1ehbhhx{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:start;-ms-flex-pack:start;-webkit-justify-content:flex-start;justify-content:flex-start;-webkit-box-flex-wrap:wrap;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:#738a94;font-size:2.5rem;line-height:1.4em;font-weight:600;text-transform:uppercase;}</style><section class="post-full-tags css-1ehbhhx"><a href="/tags/parallelism/">#parallelism</a><a href="/tags/parallel-stream/">, <!-- -->#parallel stream</a><a href="/tags/completable-future/">, <!-- -->#CompletableFuture</a></section><style data-emotion="css qs7bhz">.css-qs7bhz{margin:0 0 0.2em;color:#0b0c0e;}@media (max-width: 500px){.css-qs7bhz{margin-top:0.2em;font-size:3.3rem;}}@media (prefers-color-scheme: dark){.css-qs7bhz{color:rgba(255, 255, 255, 0.9);}}</style><h1 class="post-full-title css-qs7bhz">다중 이미지 업로드 최적화: 병렬 스트림과 CompletableFuture</h1><style data-emotion="css 1v4p0ul">.css-1v4p0ul{margin:20px 0 0;color:var(--midgrey);font-family:Georgia,serif;font-size:2.3rem;line-height:1.4em;font-weight:300;}@media (max-width: 500px){.css-1v4p0ul{font-size:1.9rem;line-height:1.5em;}}@media (prefers-color-scheme: dark){.css-1v4p0ul{color:#90a2aa;}}</style><p class="post-full-custom-excerpt css-1v4p0ul"></p><style data-emotion="css cp69tq">.css-cp69tq{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;margin:35px 0 0;padding-top:15px;border-top:1px solid #e4eaed;}.css-cp69tq .post-full-byline-content{-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;}.css-cp69tq .post-full-byline-content .author-list{-webkit-box-pack:start;-ms-flex-pack:start;-webkit-justify-content:flex-start;justify-content:flex-start;padding:0 12px 0 0;}.css-cp69tq .post-full-byline-meta{margin:2px 0 0;color:#90a2aa;font-size:1.2rem;line-height:1.2em;letter-spacing:0.2px;text-transform:uppercase;}.css-cp69tq .post-full-byline-meta h4{margin:0 0 3px;font-size:1.3rem;line-height:1.4em;font-weight:500;}.css-cp69tq .post-full-byline-meta h4 a{color:#2c3036;}.css-cp69tq .post-full-byline-meta h4 a:hover{color:#15171A;}.css-cp69tq .post-full-byline-meta .bull{display:inline-block;margin:0 4px;opacity:0.6;}@media (prefers-color-scheme: dark){.css-cp69tq{border-top-color:#3b4049;}.css-cp69tq .post-full-byline-meta h4 a{color:rgba(255, 255, 255, 0.75);}.css-cp69tq .post-full-byline-meta h4 a:hover{color:#fff;}}</style><div class="post-full-byline css-cp69tq"><section class="post-full-byline-content"><style data-emotion="css teqkql">.css-teqkql{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-flex-wrap:wrap;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin:0 0 0 4px;padding:0;list-style:none;}</style><ul class="author-list css-teqkql"><style data-emotion="css 1q168dw">.css-1q168dw{position:relative;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;margin:0;padding:0;}.css-1q168dw:hover .author-name-tooltip{opacity:1;-webkit-transform:translateY(0px);-moz-transform:translateY(0px);-ms-transform:translateY(0px);transform:translateY(0px);}</style><li class="author-list-item css-1q168dw"><style data-emotion="css 1xzzdyg">.css-1xzzdyg{position:absolute;bottom:130%;left:50%;z-index:600;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;margin-left:-200px;width:400px;font-size:1.4rem;line-height:1.5em;background:white;border-radius:3px;box-shadow:rgba(39, 44, 49, 0.08) 0 12px 26px,rgba(39, 44, 49, 0.06) 1px 3px 8px;opacity:0;-webkit-transition:all 0.35s cubic-bezier(0.4, 0.01, 0.165, 0.99);transition:all 0.35s cubic-bezier(0.4, 0.01, 0.165, 0.99);-webkit-transform:scale(0.98) translateY(15px);-moz-transform:scale(0.98) translateY(15px);-ms-transform:scale(0.98) translateY(15px);transform:scale(0.98) translateY(15px);pointer-events:none;padding:20px 20px 22px;}.css-1xzzdyg:before{content:'';position:absolute;top:100%;left:50%;display:block;margin-left:-8px;width:0;height:0;border-top:8px solid #fff;border-right:8px solid transparent;border-left:8px solid transparent;}.css-1xzzdyg .author-info{-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;padding:0 0 0 20px;}.css-1xzzdyg .author-info h2{margin:8px 0 0;font-size:1.6rem;}.css-1xzzdyg .author-info p{margin:4px 0 0;color:color(var(--midgrey) l(-10%));}.css-1xzzdyg .author-info .bio h2{margin-top:0;}.css-1xzzdyg .author-info .bio p{margin-top:0.8em;}.css-1xzzdyg .author-profile-image{-webkit-flex:0 0 60px;-ms-flex:0 0 60px;flex:0 0 60px;margin:0;width:60px;height:60px;border:none;}@media (max-width: 1170px){.css-1xzzdyg{margin-left:-50px;width:430px;}.css-1xzzdyg:before{left:50px;}}@media (max-width: 650px){.css-1xzzdyg{display:none;}}@media (prefers-color-scheme: dark){.css-1xzzdyg{background:#22252a;box-shadow:0 12px 26px rgba(0, 0, 0, 0.4);}.css-1xzzdyg:before{border-top-color:#22252a;}}</style><div class="author-card css-1xzzdyg"><style data-emotion="css 121fnpm">.css-121fnpm{display:block;width:100%;height:100%;background:#e4eaed;border-radius:100%;object-fit:cover;}@media (prefers-color-scheme: dark){.css-121fnpm{background:#191b1f;}}</style><div class="author-profile-image css-121fnpm gatsby-image-wrapper" style="position:relative;overflow:hidden"><div aria-hidden="true" style="width:100%;padding-bottom:100%"></div><img aria-hidden="true" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAAEOElEQVQ4y3WUfUxbVRTAz3stFlqKlBLookZpoLXLYpY4tQQGQ8nENRvug5FpYKlQTcYfElaKWjAzmWkmhg0LjI6wMSHMBcgEFwduA7bZ4UTs0GQDJSWiwgAjEuJY+9p3vPftPQIZnuS+d+697/zOxz3vAoiCiNKQK92HVnQyWFFnxDnAm88Je/B/Uj96jXUN98InP3yz9VB/+3TLnSEtWHXwzpXW4dLrHeW7rp8Bx7ddRbarbT9RIBcKKUoGzv324XcXLe95v4TqkcuyNcDTd24ytbf7oW50YEPlUPfbdVd7lDL7bnDf8+2qvXvjBd2ONKj/dWijY7DjLTR/xtzs65c5h7qLa3xXko6N9IHn5xvMGiCFfeC9wDivdcLB4Q54epMJVIlaNdnaLKQIsJc+NhfuFr43JKfAnq8bhbJszNkmK248tjbl8rN1kGY7AE88v0mol8FopDBnesbWk1+cP3+83G4fTU9PPxsdE+Mm69uTkpLUh1fZ6zboZKLjteJyuVidTkfV/U1NTXPkoyUUZXZ2Fn0+H+bm5lLLmZiYGB/DMEeJnqzX6yEuLo5dgZINyMnJYcmiEHBDQ4PEwRCRMBGqkhGka1lZWQtRUVFe4hzVavX9xMTEQuIANBoNKwDlcrlU1HcrKiqoDU+EgnhRFx6BQIDOQ729vTQUW0REhIdAkILJ/DWBwBIRYU4CxvHxcWoUJoFJYAkoDCLc/Pw8ms3mSzQ5mUx2Ijo6+h+iN0vRAfG0j/Y28cRPT0/T9JBGJwJw1ZvnOE7Yt9lsfxEbrRhMNIlLTVmgVCqBeBnQarWoUqkeTE5OrgBp6SQYAUllFfZramooUCMdKE2UBPaQHhsbuxAfH/8n0Y90dXVJZ4HrSVlZGd/Z2UnV+xaLpY3YJIgHK5UOEshkhAAzia4sKSmZFiMKT0xM4OLiIo0WW1tbedI6vNfrxbGxMRpl2OFw0MNIoxCS5UOgQqGgijBZWloCt9vtosC5uTkuOzsbZ2ZmcHl5Ge12Oz81NSWUksK+v3ULDQbD5UeaWcq7oKBA3tzcDEaj8dLg4CAGg8GQaLxa+IW/5/n2ts95vT65m5jFiRjmEXBqaiprMplox1dXVVXRonNnWlr4Sb+f/91/l5+79weP4UA472ApwmPPXFj1q7HSz7FGpHsvPz+/R6hhKLR82/cjl3+ggNdvK8O84kr8qqsNLe97w6mOcVRrnqrdsv8kFPUgs+6dmJmZyZKuB9I6eR6Ph6TM4YN/F3FfUSWaP8ZAxkfzQZO1L5hxdDFoaUTu2dzjNESL0MuRj7PrQv1+P2O1Wqn68g6LpT3V/GIDaF/aUngO9XtOoaF0GFNer8eUVz/lkl85MmWUyRS6SFUCqDT69W9umnJ1dbWQQqPnFDgOlwL75HbYexphZyPCGxcRck7wYHEjZDl/AZaRgyJSA0pN0grjPzCzuhysiM1SAAAAAElFTkSuQmCC" alt="" style="position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;object-position:center;opacity:1"/><noscript><picture><source srcset="/static/96f35a33c23d4e1240108a07c2620fee/22f7f/ash.png 40w,
/static/96f35a33c23d4e1240108a07c2620fee/587c9/ash.png 80w,
/static/96f35a33c23d4e1240108a07c2620fee/d966b/ash.png 120w,
/static/96f35a33c23d4e1240108a07c2620fee/37d5a/ash.png 300w" sizes="(max-width: 300px) 100vw, 300px" /><img loading="lazy" sizes="(max-width: 300px) 100vw, 300px" srcset="/static/96f35a33c23d4e1240108a07c2620fee/22f7f/ash.png 40w,
/static/96f35a33c23d4e1240108a07c2620fee/587c9/ash.png 80w,
/static/96f35a33c23d4e1240108a07c2620fee/d966b/ash.png 120w,
/static/96f35a33c23d4e1240108a07c2620fee/37d5a/ash.png 300w" src="/static/96f35a33c23d4e1240108a07c2620fee/37d5a/ash.png" alt="" style="position:absolute;top:0;left:0;opacity:1;width:100%;height:100%;object-fit:cover;object-position:center"/></picture></noscript></div><div class="author-info"><div class="bio"><h2>5기_애쉬</h2><p>우아한테크코스 5기 애쉬(정설희)입니다 :)</p><p><a href="/author/5-기-애쉬/">More posts</a> by<!-- --> <!-- -->5기_애쉬<!-- -->.</p></div></div></div><style data-emotion="css cdhz0m">.css-cdhz0m{display:block;overflow:hidden;margin:0 -4px;width:40px;height:40px;border:#fff 2px solid;border-radius:100%;-webkit-transition:all 0.5s cubic-bezier(0.4, 0.01, 0.165, 0.99) 700ms;transition:all 0.5s cubic-bezier(0.4, 0.01, 0.165, 0.99) 700ms;}@media (max-width: 500px){.css-cdhz0m{width:36px;height:36px;}}@media (prefers-color-scheme: dark){.css-cdhz0m{border-color:#1a1c20;}}</style><a class="author-avatar css-cdhz0m" href="/author/5-기-애쉬/"><div class="author-profile-image css-121fnpm gatsby-image-wrapper" style="position:relative;overflow:hidden"><div aria-hidden="true" style="width:100%;padding-bottom:100%"></div><img aria-hidden="true" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAAEOElEQVQ4y3WUfUxbVRTAz3stFlqKlBLookZpoLXLYpY4tQQGQ8nENRvug5FpYKlQTcYfElaKWjAzmWkmhg0LjI6wMSHMBcgEFwduA7bZ4UTs0GQDJSWiwgAjEuJY+9p3vPftPQIZnuS+d+697/zOxz3vAoiCiNKQK92HVnQyWFFnxDnAm88Je/B/Uj96jXUN98InP3yz9VB/+3TLnSEtWHXwzpXW4dLrHeW7rp8Bx7ddRbarbT9RIBcKKUoGzv324XcXLe95v4TqkcuyNcDTd24ytbf7oW50YEPlUPfbdVd7lDL7bnDf8+2qvXvjBd2ONKj/dWijY7DjLTR/xtzs65c5h7qLa3xXko6N9IHn5xvMGiCFfeC9wDivdcLB4Q54epMJVIlaNdnaLKQIsJc+NhfuFr43JKfAnq8bhbJszNkmK248tjbl8rN1kGY7AE88v0mol8FopDBnesbWk1+cP3+83G4fTU9PPxsdE+Mm69uTkpLUh1fZ6zboZKLjteJyuVidTkfV/U1NTXPkoyUUZXZ2Fn0+H+bm5lLLmZiYGB/DMEeJnqzX6yEuLo5dgZINyMnJYcmiEHBDQ4PEwRCRMBGqkhGka1lZWQtRUVFe4hzVavX9xMTEQuIANBoNKwDlcrlU1HcrKiqoDU+EgnhRFx6BQIDOQ729vTQUW0REhIdAkILJ/DWBwBIRYU4CxvHxcWoUJoFJYAkoDCLc/Pw8ms3mSzQ5mUx2Ijo6+h+iN0vRAfG0j/Y28cRPT0/T9JBGJwJw1ZvnOE7Yt9lsfxEbrRhMNIlLTVmgVCqBeBnQarWoUqkeTE5OrgBp6SQYAUllFfZramooUCMdKE2UBPaQHhsbuxAfH/8n0Y90dXVJZ4HrSVlZGd/Z2UnV+xaLpY3YJIgHK5UOEshkhAAzia4sKSmZFiMKT0xM4OLiIo0WW1tbedI6vNfrxbGxMRpl2OFw0MNIoxCS5UOgQqGgijBZWloCt9vtosC5uTkuOzsbZ2ZmcHl5Ge12Oz81NSWUksK+v3ULDQbD5UeaWcq7oKBA3tzcDEaj8dLg4CAGg8GQaLxa+IW/5/n2ts95vT65m5jFiRjmEXBqaiprMplox1dXVVXRonNnWlr4Sb+f/91/l5+79weP4UA472ApwmPPXFj1q7HSz7FGpHsvPz+/R6hhKLR82/cjl3+ggNdvK8O84kr8qqsNLe97w6mOcVRrnqrdsv8kFPUgs+6dmJmZyZKuB9I6eR6Ph6TM4YN/F3FfUSWaP8ZAxkfzQZO1L5hxdDFoaUTu2dzjNESL0MuRj7PrQv1+P2O1Wqn68g6LpT3V/GIDaF/aUngO9XtOoaF0GFNer8eUVz/lkl85MmWUyRS6SFUCqDT69W9umnJ1dbWQQqPnFDgOlwL75HbYexphZyPCGxcRck7wYHEjZDl/AZaRgyJSA0pN0grjPzCzuhysiM1SAAAAAElFTkSuQmCC" alt="5기_애쉬" style="position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;object-position:center;opacity:1"/><noscript><picture><source srcset="/static/96f35a33c23d4e1240108a07c2620fee/22f7f/ash.png 40w,
/static/96f35a33c23d4e1240108a07c2620fee/587c9/ash.png 80w,
/static/96f35a33c23d4e1240108a07c2620fee/d966b/ash.png 120w,
/static/96f35a33c23d4e1240108a07c2620fee/37d5a/ash.png 300w" sizes="(max-width: 300px) 100vw, 300px" /><img loading="lazy" sizes="(max-width: 300px) 100vw, 300px" srcset="/static/96f35a33c23d4e1240108a07c2620fee/22f7f/ash.png 40w,
/static/96f35a33c23d4e1240108a07c2620fee/587c9/ash.png 80w,
/static/96f35a33c23d4e1240108a07c2620fee/d966b/ash.png 120w,
/static/96f35a33c23d4e1240108a07c2620fee/37d5a/ash.png 300w" src="/static/96f35a33c23d4e1240108a07c2620fee/37d5a/ash.png" alt="5기_애쉬" style="position:absolute;top:0;left:0;opacity:1;width:100%;height:100%;object-fit:cover;object-position:center"/></picture></noscript></div></a></li></ul><section class="post-full-byline-meta"><h4 class="author-name"><a href="/author/5-기-애쉬/">5기_애쉬</a></h4><div class="byline-meta-content"><time class="byline-meta-date" dateTime="2023-11-23">23 Nov 2023</time><span class="byline-reading-time"><span class="bull">•</span> <!-- -->10<!-- --> min read</span></div></section></section></div></header><style data-emotion="css 4wxe1t">.css-4wxe1t{margin:25px 0 50px;height:560px;background:#c5d2d9 center center;-webkit-background-size:cover;background-size:cover;border-radius:5px;}@media (max-width: 1170px){.css-4wxe1t{margin:25px -6vw 50px;border-radius:0;}.css-4wxe1t img{max-width:1170px;}}@media (max-width: 800px){.css-4wxe1t{height:400px;}}@media (max-width: 500px){.css-4wxe1t{margin-bottom:4vw;height:350px;}}</style><figure class="css-4wxe1t"><div class=" gatsby-image-wrapper" style="position:relative;overflow:hidden;height:100%"><div aria-hidden="true" style="width:100%;padding-bottom:56.88172043010753%"></div><img aria-hidden="true" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABYlAAAWJQFJUiTwAAACFElEQVQoz32RS2gTURSGL3ar1G4EFTduXLgRBJc+ENGFVESwINiuVHBRanUr7hS7UBd2ax8+QcRqbRKwTVJMTdKgwUKJeU2a2HbymkkmJCSSTD4nExLT0vZeLvPfc77577n3CLYZ9Xq9rddcTihozbius9MQO5lVKxV+P37A+5PHmLnWS9rnbuZrNZPpPHRLwxbQ+pZLRVxnj2M/d4Lnh3uIvHlhxvVqtc1tNhWbE526+rdC4P4wjt5TWK5eILngbJ28wahTi+0SkiShaRpZY8WmP5ALBqjodUKhIKqqslUhbUPdWFVjr1OnWCyyLsvktAJqXkOKRk0wk8sTiydMLSeTqLkcjfbUGv8bjWp4NCrveEPdDBS1UlM34Lyy8cUL//fFvFFlqbCxmcYU4ZTCE/8KZ7wa1+eXGLI7ee2X6POscdGrcMNm45l3mUc+idOLBfodPxi2zxtMjMsemUveNDetFkb9UdNSeFZVrviyiFmZPV8WOTIzxz3XCru+KQhblANTFvqcy5xfSCHmkuyd/s5Rq5O7rjjCZMIc/DhNvzduXKyG+JlQuGV10zU2RPfEQ3reTjHydYlDr0bpnhxEjI8xYHEz8MlB1/ggu8dH2P/us8H8Yt/Lp/RM3kGMTXB71tdsSrlcIamkCKQThDIrROQoipojkkoQzK4STIaQMynWsw3mj8HEkGTJZMItRg6RUjKm4T+uEQuTZdxYFgAAAABJRU5ErkJggg==" alt="다중 이미지 업로드 최적화: 병렬 스트림과 CompletableFuture" style="position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;object-position:center;opacity:1;transition-delay:500ms"/><noscript><picture><source srcset="/static/28febf62529b1836b34c354877ee228e/3a443/multiple-image-upload.png 930w,
/static/28febf62529b1836b34c354877ee228e/271e4/multiple-image-upload.png 1494w" sizes="(max-width: 1494px) 100vw, 1494px" /><img loading="lazy" sizes="(max-width: 1494px) 100vw, 1494px" srcset="/static/28febf62529b1836b34c354877ee228e/3a443/multiple-image-upload.png 930w,
/static/28febf62529b1836b34c354877ee228e/271e4/multiple-image-upload.png 1494w" src="/static/28febf62529b1836b34c354877ee228e/271e4/multiple-image-upload.png" alt="다중 이미지 업로드 최적화: 병렬 스트림과 CompletableFuture" style="position:absolute;top:0;left:0;opacity:1;width:100%;height:100%;object-fit:cover;object-position:center"/></picture></noscript></div></figure><style data-emotion="css 1hzbvd8">.css-1hzbvd8{position:relative;margin:0 auto;padding:0 170px 6vw;min-height:230px;font-family:Georgia,serif;font-size:2rem;line-height:1.6em;background:#fff;}@media (max-width: 1170px){.css-1hzbvd8{padding:0 11vw;}}@media (max-width: 800px){.css-1hzbvd8{padding:0 5vw;font-size:1.8rem;}}@media (max-width: 500px){.css-1hzbvd8{padding:0;}}@media (max-width: 500px){.css-1hzbvd8 .post-full-custom-excerpt{font-size:1.9rem;line-height:1.5em;}}.css-1hzbvd8 .no-image{padding-top:0;}.css-1hzbvd8 h1,.css-1hzbvd8 h2,.css-1hzbvd8 h3,.css-1hzbvd8 h4,.css-1hzbvd8 h5,.css-1hzbvd8 h6,.css-1hzbvd8 p,.css-1hzbvd8 ul,.css-1hzbvd8 ol,.css-1hzbvd8 dl,.css-1hzbvd8 pre,.css-1hzbvd8 blockquote,.css-1hzbvd8 .post-full-comments,.css-1hzbvd8 .footnotes{margin:0 0 1.5em 0;min-width:100%;}@media (max-width: 500px){.css-1hzbvd8 p,.css-1hzbvd8 ul,.css-1hzbvd8 ol,.css-1hzbvd8 dl,.css-1hzbvd8 pre,.css-1hzbvd8 .post-full-comments,.css-1hzbvd8 .footnotes{margin-bottom:1.28em;}}.css-1hzbvd8 li{word-break:break-word;}.css-1hzbvd8 li p{margin:0;}.css-1hzbvd8 a{color:#15171A;word-break:break-word;box-shadow:#15171A 0 -1px 0 inset;-webkit-transition:all 0.2s ease-in-out;transition:all 0.2s ease-in-out;}.css-1hzbvd8 a:hover{color:#3eb0ef;-webkit-text-decoration:none;text-decoration:none;box-shadow:#3eb0ef 0 -1px 0 inset;}.css-1hzbvd8 strong,.css-1hzbvd8 em{color:#0a0b0c;}.css-1hzbvd8 small{display:inline-block;line-height:1.6em;}.css-1hzbvd8 img,.css-1hzbvd8 video{display:block;margin:1.5em auto;width:100%;max-width:1040px;height:auto;}@media (max-width: 1040px){.css-1hzbvd8 img,.css-1hzbvd8 video{width:100%;}}.css-1hzbvd8 img[src$='#full']{max-width:none;width:100vw;}.css-1hzbvd8 img+br+small{display:block;margin-top:-3em;margin-bottom:1.5em;text-align:center;}.css-1hzbvd8 iframe{margin:0 auto!important;}.css-1hzbvd8 blockquote{margin:0 0 1.5em;padding:0 1.5em;border-left:#3eb0ef 3px solid;}@media (max-width: 500px){.css-1hzbvd8 blockquote{padding:0 1.3em;}}.css-1hzbvd8 blockquote p{margin:0 0 1em 0;color:inherit;font-size:inherit;line-height:inherit;font-style:italic;}.css-1hzbvd8 blockquote p:last-child{margin-bottom:0;}.css-1hzbvd8 code{padding:0 5px 2px;font-size:0.8em;line-height:1em;font-weight:400!important;background:#e5eff5;border-radius:3px;}.css-1hzbvd8 p code{word-break:break-all;}.css-1hzbvd8 pre{overflow-x:auto;padding:20px;max-width:100%;color:#e5eff5;font-size:1.4rem;line-height:1.5em;border-radius:5px;}.css-1hzbvd8 pre code{padding:0;font-size:inherit;line-height:inherit;background:transparent;}.css-1hzbvd8 pre code :not(span){color:inherit;}.css-1hzbvd8 .fluid-width-video-wrapper{margin:1.5em 0 3em;}.css-1hzbvd8 hr{margin:2em 0;}.css-1hzbvd8 hr:after{content:'';position:absolute;top:-15px;left:50%;display:block;margin-left:-10px;width:1px;height:30px;background:#e4eaed;box-shadow:#fff 0 0 0 5px;-webkit-transform:rotate(45deg);-moz-transform:rotate(45deg);-ms-transform:rotate(45deg);transform:rotate(45deg);}.css-1hzbvd8 hr+p{margin-top:1.2em;}.css-1hzbvd8 h1,.css-1hzbvd8 h2,.css-1hzbvd8 h3,.css-1hzbvd8 h4,.css-1hzbvd8 h5,.css-1hzbvd8 h6{color:#0a0b0c;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Oxygen,Ubuntu,Cantarell,'Open Sans','Helvetica Neue',sans-serif;}.css-1hzbvd8 h1{margin:0.5em 0 0.4em;font-size:4.2rem;line-height:1.25em;font-weight:600;}.css-1hzbvd8 p+h1{margin-top:0.8em;}@media (max-width: 800px){.css-1hzbvd8 h1{font-size:3.2rem;line-height:1.25em;}}.css-1hzbvd8 h2{margin:0.5em 0 0.4em;font-size:3.2rem;line-height:1.25em;font-weight:600;}.css-1hzbvd8 p+h2{margin-top:0.8em;}@media (max-width: 800px){.css-1hzbvd8 h2{margin-bottom:0.3em;font-size:2.8rem;line-height:1.25em;}}.css-1hzbvd8 h3{margin:0.5em 0 0.2em;font-size:2.5rem;line-height:1.3em;font-weight:600;}.css-1hzbvd8 h2+h3{margin-top:0.7em;}@media (max-width: 800px){.css-1hzbvd8 h3{margin-bottom:0.3em;font-size:2.4rem;line-height:1.3em;}}.css-1hzbvd8 h4{margin:0.5em 0 0.2em;font-size:2.5rem;font-weight:600;}.css-1hzbvd8 h2+h4{margin-top:0.7em;}.css-1hzbvd8 h3+h4{margin-top:0;}@media (max-width: 800px){.css-1hzbvd8 h4{margin-bottom:0.3em;font-size:2.4rem;line-height:1.3em;}}.css-1hzbvd8 h5{display:block;margin:0.5em 0;padding:0.4em 1em 0.9em;border:0;color:#3eb0ef;font-family:Georgia,serif;font-size:3.2rem;line-height:1.35em;text-align:center;}@media (min-width: 1180px){.css-1hzbvd8 h5{max-width:1060px;}}@media (max-width: 800px){.css-1hzbvd8 h5{margin-bottom:1em;margin-left:1.3em;padding:0 0 0.5em;font-size:2.4rem;text-align:initial;}}.css-1hzbvd8 h6{margin:0.5em 0 0.2em 0;font-size:2rem;font-weight:700;}@media (max-width: 800px){.css-1hzbvd8 h6{font-size:1.8rem;line-height:1.4em;}}.css-1hzbvd8 table{display:inline-block;overflow-x:auto;margin:0.5em 0 2.5em;max-width:100%;width:auto;border-spacing:0;border-collapse:collapse;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Oxygen,Ubuntu,Cantarell,'Open Sans','Helvetica Neue',sans-serif;font-size:1.6rem;white-space:nowrap;vertical-align:top;}.css-1hzbvd8 table{-webkit-overflow-scrolling:touch;background:radial-gradient(ellipse at left, rgba(0, 0, 0, 0.2) 0%, rgba(0, 0, 0, 0) 75%) 0 center,radial-gradient(ellipse at right, rgba(0, 0, 0, 0.2) 0%, rgba(0, 0, 0, 0) 75%) 100% center;background-attachment:scroll,scroll;-webkit-background-size:10px 100%,10px 100%;background-size:10px 100%,10px 100%;background-repeat:no-repeat;}.css-1hzbvd8 table td:first-of-type{background-image:linear-gradient(
      to right,
      rgba(255, 255, 255, 1) 50%,
      rgba(255, 255, 255, 0) 100%
    );-webkit-background-size:20px 100%;background-size:20px 100%;background-repeat:no-repeat;}.css-1hzbvd8 table td:last-child{background-image:linear-gradient(
      to left,
      rgba(255, 255, 255, 1) 50%,
      rgba(255, 255, 255, 0) 100%
    );-webkit-background-position:100% 0;background-position:100% 0;-webkit-background-size:20px 100%;background-size:20px 100%;background-repeat:no-repeat;}.css-1hzbvd8 table th{color:#15171A;font-size:1.2rem;font-weight:700;letter-spacing:0.2px;text-align:left;text-transform:uppercase;background-color:#f4f8fb;}.css-1hzbvd8 table th,.css-1hzbvd8 table td{padding:6px 12px;border:#e1edf4 1px solid;}@media (prefers-color-scheme: dark){.css-1hzbvd8{background:#191b1f;}.css-1hzbvd8 h1,.css-1hzbvd8 h2,.css-1hzbvd8 h3,.css-1hzbvd8 h4,.css-1hzbvd8 h6{color:rgba(255, 255, 255, 0.9);}.css-1hzbvd8 a{color:#fff;box-shadow:inset 0 -1px 0 #fff;}.css-1hzbvd8 strong{color:#fff;}.css-1hzbvd8 em{color:#fff;}.css-1hzbvd8 code{color:#fff;background:#000;}.css-1hzbvd8 hr{border-top-color:#2b2f36;}.css-1hzbvd8 figcaption{color:rgba(255, 255, 255, 0.6);}.css-1hzbvd8 table td:first-of-type{background-image:linear-gradient(to right, #191b1f 50%, #191b1f 100%);}.css-1hzbvd8 table td:last-child{background-image:linear-gradient(270deg, #191b1f 50%, rgba(25, 27, 31, 0));}.css-1hzbvd8 table th{color:rgba(255, 255, 255, 0.85);background-color:#2b2f36;}.css-1hzbvd8 table th,.css-1hzbvd8 table td{border:#2b2f36 1px solid;}.css-1hzbvd8 .kg-bookmark-container,.css-1hzbvd8 .kg-bookmark-container:hover{color:rgba(255, 255, 255, 0.75);box-shadow:0 0 1px rgba(255, 255, 255, 0.9);}}.css-1hzbvd8 code[class*='language-'],.css-1hzbvd8 pre[class*='language-']{color:white;background:none;font-family:Consolas,Menlo,Monaco,source-code-pro,Courier New,monospace;font-feature-settings:normal;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;margin-bottom:0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;}.css-1hzbvd8 pre[class*='language-']{overflow:auto;}.css-1hzbvd8 *:not(pre)>code[class*='language-']{border-radius:0.3em;background:rgb(1, 22, 39);color:white;padding:0.15em 0.5em;white-space:normal;}.css-1hzbvd8 .token.attr-name{color:rgb(173, 219, 103);font-style:italic;}.css-1hzbvd8 .token.comment{color:rgb(128, 147, 147);}.css-1hzbvd8 .token.string,.css-1hzbvd8 .token.url{color:rgb(173, 219, 103);}.css-1hzbvd8 .token.variable{color:rgb(214, 222, 235);}.css-1hzbvd8 .token.number{color:rgb(247, 140, 108);}.css-1hzbvd8 .token.builtin,.css-1hzbvd8 .token.char,.css-1hzbvd8 .token.constant,.css-1hzbvd8 .token.function{color:rgb(130, 170, 255);}.css-1hzbvd8 .token.punctuation{color:rgb(199, 146, 234);}.css-1hzbvd8 .token.selector,.css-1hzbvd8 .token.doctype{color:rgb(199, 146, 234);font-style:'italic';}.css-1hzbvd8 .token.class-name{color:rgb(255, 203, 139);}.css-1hzbvd8 .token.tag,.css-1hzbvd8 .token.operator,.css-1hzbvd8 .token.keyword{color:#ffa7c4;}.css-1hzbvd8 .token.boolean{color:rgb(255, 88, 116);}.css-1hzbvd8 .token.property{color:rgb(128, 203, 196);}.css-1hzbvd8 .token.namespace{color:rgb(178, 204, 214);}.css-1hzbvd8 pre[data-line]{padding:1em 0 1em 3em;position:relative;}.css-1hzbvd8 .gatsby-highlight-code-line{background-color:hsla(207, 95%, 15%, 1);display:block;margin-right:-1.3125rem;margin-left:-1.3125rem;padding-right:1em;padding-left:1.25em;border-left:0.25em solid #ffa7c4;}.css-1hzbvd8 .gatsby-highlight{margin-bottom:1.75rem;margin-left:-1.3125rem;margin-right:-1.3125rem;border-radius:10px;background:#011627;-webkit-overflow-scrolling:touch;overflow:auto;}.css-1hzbvd8 .gatsby-highlight pre[class*='language-']{float:left;min-width:100%;}</style><section class="post-full-content css-1hzbvd8"><div><p>사이드 프로젝트로 sns 서비스를 개발하며 사용자가 다수의 이미지를 업로드하는 기능을 개발하게 되었다.
웹 애플리케이션에서 다중 이미지 업로드는 일반적이며, 이를 효율적으로 처리하는 것은 사용자 경험 향상에 중요한 역할을 한다.</p>
<p>그렇다면 서버 측에서는 여러 장의 이미지를 어떻게 효율적으로 업로드할 수 있을까?</p>
<p>이 글에서는 구체적인 이미지 저장 방법(로컬 스토리지 저장, 클라우드 서비스 사용, DB에 바이너리 데이터로 저장 등)을 떠나, 이미지 업로드 과정을 어떻게 하면 더 효율적이고 빠르게 처리할 수 있을지에 집중해 보고자 한다.
병렬 처리와 같은 기술을 활용하여 서버 성능을 최대한 활용하고, 사용자에게 빠른 응답 시간을 제공하는 방법을 예제 코드와 함께 살펴보자.</p>
<h1>예제 코드 소개</h1>
<p>이번 예제에서는 <code class="language-text">이미지 동반 포스트 업로드 서비스</code> 를 구현했다.
전체 소스코드는 <a href="https://github.com/xxeol2/multi-image-upload-demo">Github</a>에서 확인 가능하다.</p>
<blockquote>
<p>[요구사항]</p>
<ul>
<li>한 포스트당 최대 10장의 이미지를 포함할 수 있다.</li>
<li>업로드 실패 시, 해당 포스트에 대한 모든 이미지 파일을 저장소에서 삭제한다.</li>
</ul>
</blockquote>
<p>클래스의 구조와 전체적인 코드의 흐름은 아래와 같다.</p>
<span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:2000px">
      <a class="gatsby-resp-image-link" href="/static/f6ae6a382331b2f963c08f28699dce46/c3538/%ED%81%B4%EB%9E%98%EC%8A%A4%20%EA%B5%AC%EC%A1%B0%EB%8F%84.png" style="display:block" target="_blank" rel="noopener">
    <span class="gatsby-resp-image-background-image" style="padding-bottom:42.199999999999996%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABYlAAAWJQFJUiTwAAABT0lEQVQoz11SiZaDIBDr///jbi+rtR6AXAMe2WiPdZdnXkYYApPhgGXht2Dl/RjHEcpp9FZt/IFS0FrDR0FnPOrO4KEG5kWkPOLwllnZWgttNEII6FWP4/2ME3GsTjg/rija27ZuKKitR9lZHG8PXO4dau0REwVTpPKGgK5p0NQ1jDGYpokJQsQd5FPBPC+QlJHHaYOkxLkJh/p6xf18RkU0RQFN0Xmef2tf/vK6NvMwHyItiCzboR88jBfYILyh93hDnEMgRASe/4MfMIjFEMjRwiWPtm+h6aMyFlVv8V3UG26tgaKPh/0lHEXKstx8WkV1MGhci6/yiAs9VEL/eMi6YWSZXjJknCH5GUdJbMqrw/tOL68jUk5MDAj0LyQy46Zt0dCWTg+o2OFL1aCo2RS1ViJPweUt9Ir3c/9Hovk5ZzhuXgVXsduj59Nxm4c/utpqqliiZ0MAAAAASUVORK5CYII=&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image" alt="       " title="       " src="/static/f6ae6a382331b2f963c08f28699dce46/f97d7/%ED%81%B4%EB%9E%98%EC%8A%A4%20%EA%B5%AC%EC%A1%B0%EB%8F%84.png" srcSet="/static/f6ae6a382331b2f963c08f28699dce46/0eb09/%ED%81%B4%EB%9E%98%EC%8A%A4%20%EA%B5%AC%EC%A1%B0%EB%8F%84.png 500w, /static/f6ae6a382331b2f963c08f28699dce46/1263b/%ED%81%B4%EB%9E%98%EC%8A%A4%20%EA%B5%AC%EC%A1%B0%EB%8F%84.png 1000w, /static/f6ae6a382331b2f963c08f28699dce46/f97d7/%ED%81%B4%EB%9E%98%EC%8A%A4%20%EA%B5%AC%EC%A1%B0%EB%8F%84.png 2000w, /static/f6ae6a382331b2f963c08f28699dce46/c3538/%ED%81%B4%EB%9E%98%EC%8A%A4%20%EA%B5%AC%EC%A1%B0%EB%8F%84.png 2258w" sizes="(max-width: 2000px) 100vw, 2000px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy"/>
  </a>
    </span>
<ul>
<li><code class="language-text">PostFacadeService</code>는 전체 이미지 파일 업로드를 <code class="language-text">ImageStorageService</code>에 요청한다.</li>
<li><code class="language-text">ImageStorageService</code>는 각 이미지 파일 업로드를 <code class="language-text">StorageClient</code>에 요청한다.</li>
<li>이미지 업로드가 성공하면, <code class="language-text">PostFacadeService</code>는 포스트 저장을 <code class="language-text">PostService</code>에 요청한다.</li>
</ul>
<p>이 포스트에서는 주로 <code class="language-text">ImageStorageService</code>에 집중하여 여러 이미지 업로드 방법을 살펴본다.</p>
<h1>순차적 업로드 방식</h1>
<p>가장 기본적인 방법은 모든 이미지를 하나씩 순차적으로 업로드하는 것이다.</p>
<p>아래는 <code class="language-text">ImageStorageService</code>에서 파일 업로드를 담당하는 <code class="language-text">uploadFiles()</code> 코드이다.</p>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">ImageUploadResponse</span> <span class="token function">uploadFiles</span><span class="token punctuation">(</span><span class="token class-name">MultipartFile</span><span class="token punctuation">[</span><span class="token punctuation">]</span> imageFiles<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">validate</span><span class="token punctuation">(</span>imageFiles<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> fileNames <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span>imageFiles<span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>storageClient<span class="token operator">::</span><span class="token function">upload</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>fileNames<span class="token operator">::</span><span class="token function">add</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token function">convertFileNamesToResponse</span><span class="token punctuation">(</span>fileNames<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        executor<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token function">deleteFiles</span><span class="token punctuation">(</span>fileNames<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">InternalServerException</span><span class="token punctuation">(</span><span class="token string">&quot;이미지 업로드 시 예외가 발생했습니다.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>이미지 파일들을 순차적으로 <code class="language-text">StorageClient</code>에 업로드 요청을 보내고, 업로드에 성공한 파일의 이름을 모아 반환한다.</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">[nio-8080-exec-1] : File Upload 시작 (871cb6aae189.png)
[nio-8080-exec-1] : File Upload 완료 (871cb6aae189.png)
[nio-8080-exec-1] : File Upload 시작 (1e17f3995ade.png)
[nio-8080-exec-1] : File Upload 완료 (1e17f3995ade.png)
[nio-8080-exec-1] : File Upload 시작 (587ab1b903d3.png)
[nio-8080-exec-1] : File Upload 완료 (587ab1b903d3.png)</code></pre></div>
<p>위 로그에서 <code class="language-text">[nio-8080-exec-1]</code>은 해당 작업이 진행된 스레드 이름을 나타낸다. 모든 요청이 단일 스레드에서 순차적으로 처리되는 것을 확인할 수 있다.</p>
<span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:1240px">
      <a class="gatsby-resp-image-link" href="/static/f5fb869d29fb03758d5909ef1c72430d/09504/%EC%88%9C%EC%B0%A8%EC%A0%81%20%EC%97%85%EB%A1%9C%EB%93%9C%20%EA%B5%AC%EC%A1%B0.png" style="display:block" target="_blank" rel="noopener">
    <span class="gatsby-resp-image-background-image" style="padding-bottom:31.8%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAABYlAAAWJQFJUiTwAAABFUlEQVQY03WQiW7CMBBE+f+f4wqBEOUil52ThARykVcDagVVO9Jqx97ReNaL6/XKerdme9AQsWC1XbE77AiCgKXiuqETRzFrfYPl2byj6zqcQBDKjPl+f94t4jRG3lKK8czBNp49GTK2R41iKMlVHR2TmoaszxGp5BEiCkP2pk16g7geSPLyZXhpLoRlRFKniEQgaknaZIqrfsmUWOBHPk7i4WYnaqUfx4m+u3GpK0RRcYqkOl9fho/XPM/DD3yKvMB2bTamhuXbrI0NR8tECom+13Fc52fdpr9jq3iaI1layZMX7cBinuePfym7CqOw8KsI6+zSjO3H/Fvf9hOi6sjbCalWDkuV+Da9DN/rL/ye/6d74Auvo8h21dLAEQAAAABJRU5ErkJggg==&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image" alt="          " title="          " src="/static/f5fb869d29fb03758d5909ef1c72430d/09504/%EC%88%9C%EC%B0%A8%EC%A0%81%20%EC%97%85%EB%A1%9C%EB%93%9C%20%EA%B5%AC%EC%A1%B0.png" srcSet="/static/f5fb869d29fb03758d5909ef1c72430d/0eb09/%EC%88%9C%EC%B0%A8%EC%A0%81%20%EC%97%85%EB%A1%9C%EB%93%9C%20%EA%B5%AC%EC%A1%B0.png 500w, /static/f5fb869d29fb03758d5909ef1c72430d/1263b/%EC%88%9C%EC%B0%A8%EC%A0%81%20%EC%97%85%EB%A1%9C%EB%93%9C%20%EA%B5%AC%EC%A1%B0.png 1000w, /static/f5fb869d29fb03758d5909ef1c72430d/09504/%EC%88%9C%EC%B0%A8%EC%A0%81%20%EC%97%85%EB%A1%9C%EB%93%9C%20%EA%B5%AC%EC%A1%B0.png 1240w" sizes="(max-width: 1240px) 100vw, 1240px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy"/>
  </a>
    </span>
<h2>성능 측정</h2>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">[PostFacadeService.createPost] 실행 시간(ms): 1396
[PostFacadeService.createPost] 실행 시간(ms): 1287
[PostFacadeService.createPost] 실행 시간(ms): 1251
[PostFacadeService.createPost] 실행 시간(ms): 1383
[PostFacadeService.createPost] 실행 시간(ms): 1338</code></pre></div>
<p>10장의 354KB 이미지를 업로드하는 데에 평균 1331ms가 소요되었다.</p>
<p>다중 이미지 업로드 시, 단일 스레드를 사용하여 순차적으로 처리하는 방식은 간단하고 직관적이다.
이 방법을 사용하면, 각 이미지는 이전 이미지가 완전히 업로드된 후에 업로드된다.
그러나 이러한 단일 스레드 방식은 이미지 하나당 소요되는 시간이 누적되어 전체 업로드 시간이 길어지는 단점이 있다.
예를 들어, 이미지 하나를 업로드하는데 평균 130ms가 소요되고 10개의 이미지를 업로드한다면, 총소요 시간은 약 1300ms가 된다.</p>
<p>이에 비해, 여러 스레드를 사용하여 이미지를 병렬로 업로드하면 처리 시간을 단축할 수 있다.
이 방식에서는 여러 이미지가 동시에 업로드되므로, 10장의 이미지를 업로드하는 데 걸리는 시간을 1331ms에서 더 단축할 수 있을 것으로 예상된다.</p>
<p>이제 병렬 스트림을 활용한 이미지 업로드 방식에 대해 자세히 알아보자.</p>
<h1>병렬 스트림을 활용한 업로드</h1>
<p>Java 8부터는 컬렉션의 병렬 처리를 지원하는 “병렬 스트림(parallel stream)“이 도입되었다.
이를 활용하면, 여러 CPU 코어를 통해 작업을 효율적으로 분산시켜 더 빠르게 수행할 수 있다.</p>
<p>이를 활용하여 이미지 업로드를 병렬적으로 처리할 수 있다.</p>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">ImageUploadResponse</span> <span class="token function">uploadFiles</span><span class="token punctuation">(</span><span class="token class-name">MultipartFile</span><span class="token punctuation">[</span><span class="token punctuation">]</span> imageFiles<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">validate</span><span class="token punctuation">(</span>imageFiles<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> fileNames <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span>imageFiles<span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">parallel</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 병렬 스트림 생성</span>
            <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>storageClient<span class="token operator">::</span><span class="token function">upload</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>fileNames<span class="token operator">::</span><span class="token function">add</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token function">convertFileNamesToResponse</span><span class="token punctuation">(</span>fileNames<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        executor<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token function">deleteFiles</span><span class="token punctuation">(</span>fileNames<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">InternalServerException</span><span class="token punctuation">(</span><span class="token string">&quot;이미지 업로드 시 예외가 발생했습니다.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>각 이미지 업로드 요청이 병렬 스레드에서 동시에 처리되는 것을 로그로 확인할 수 있다. 아래 로그에서 <code class="language-text">[onPool-worker-*]</code>는 해당 작업이 진행된 스레드 이름이다.</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">[onPool-worker-6] : File Upload 시작 (871cb6aae189.png)
[onPool-worker-4] : File Upload 시작 (9af5a8a21538.png)
[onPool-worker-2] : File Upload 시작 (1e17f3995ade.png)
[onPool-worker-1] : File Upload 시작 (587ab1b903d3.png)
[onPool-worker-5] : File Upload 시작 (bdc9a80b2331.png)
[onPool-worker-7] : File Upload 시작 (faac3d412e3e.png)
[onPool-worker-3] : File Upload 시작 (85db46aad248.png)
[onPool-worker-1] : File Upload 완료 (587ab1b903d3.png)
[onPool-worker-1] : File Upload 시작 (3cf2f27aacb3.png)
[onPool-worker-5] : File Upload 완료 (bdc9a80b2331.png)
[onPool-worker-5] : File Upload 시작 (9343ba3a01d1.png)
[onPool-worker-2] : File Upload 완료 (1e17f3995ade.png)
...</code></pre></div>
<span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:946px">
      <a class="gatsby-resp-image-link" href="/static/a7c886ecb60b19d012528f417b926b67/b2dbf/%EB%B3%91%EB%A0%AC%20%EC%8A%A4%ED%8A%B8%EB%A6%BC%20%EA%B5%AC%EC%A1%B0.png" style="display:block" target="_blank" rel="noopener">
    <span class="gatsby-resp-image-background-image" style="padding-bottom:76.2%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAABYlAAAWJQFJUiTwAAACDUlEQVQ4y5WTC3eaQBCF8///VVqTxrxKmijGIC+BRVBEJai8vu5i1XjSnNo9Z46zuHNn5t6ZC844TdOc/FZVhe2MGfuC9Xp98t+Fcv5l+4C9b7keTrzCXxQY44lMUB7eXJxb4R7sttvl+3WXlbymFQy9mDx/PwLWdd22UBQFxbZoW9hsNq0pf1tsD8DT6ZQgCIiiCFvMGAUJQRgpKJo9oAqybJvLziWPPx8Zu2P6uk6ne4X2S2O5WKKSmqZJmqYH8DAMuXt4JJnPTzl0PJfeSGdRLxGrEGtsy8wmGTl+KkhXKZ7nMf8TqDqZJQl2EJPK4l8Ml1QmPbTseA6msNggH1ZzdHOAHbntXeQTwtmEOIrbVhVor9fjW+eKKCtRzIXLAtfzj4DJPOHVHGJFO2DVlulZGJGJEYwk4TlZlhHHMUW5U7OUVY5cgRXOcYKI7XZ7BFRZHdtB0zT0gY7jOBhvBrf3d/T6PYQQ7WMFrHxltRRRSA6vH5550V8lx9Xp2FRNxfNswH34xOtsxJ3QeJr2Pw22OoZh8OPmBj95l7yDLedRzeUJoHLW5aa1si7JSzk60q+bGprPs6hEePNnpJKBQCpjuh84/Jj9y7VrPla6u7iui+1L0eIp1OXnCs9du2wj6fFWTKS6mhkzFBnDSc4w3G3Lf69empe8yWAzzlugfpAxkKDq29m7/Ddxvjq/AaDoguLe0GLbAAAAAElFTkSuQmCC&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image" alt="         " title="         " src="/static/a7c886ecb60b19d012528f417b926b67/b2dbf/%EB%B3%91%EB%A0%AC%20%EC%8A%A4%ED%8A%B8%EB%A6%BC%20%EA%B5%AC%EC%A1%B0.png" srcSet="/static/a7c886ecb60b19d012528f417b926b67/0eb09/%EB%B3%91%EB%A0%AC%20%EC%8A%A4%ED%8A%B8%EB%A6%BC%20%EA%B5%AC%EC%A1%B0.png 500w, /static/a7c886ecb60b19d012528f417b926b67/b2dbf/%EB%B3%91%EB%A0%AC%20%EC%8A%A4%ED%8A%B8%EB%A6%BC%20%EA%B5%AC%EC%A1%B0.png 946w" sizes="(max-width: 946px) 100vw, 946px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy"/>
  </a>
    </span>
<h2>성능 측정</h2>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">[PostFacadeService.createPost] 실행 시간(ms): 256
[PostFacadeService.createPost] 실행 시간(ms): 223
[PostFacadeService.createPost] 실행 시간(ms): 213
[PostFacadeService.createPost] 실행 시간(ms): 217
[PostFacadeService.createPost] 실행 시간(ms): 238</code></pre></div>
<p>병렬 스트림을 활용하니 처리 시간이 평균 1331ms에서 229ms로 약 <strong>5배 이상 단축</strong>되었다.</p>
<h2>병렬 스트림 사용 시 주의점</h2>
<p>병렬 처리 중 공유 자원에 대한 동시 접근 시 문제가 발생할 수 있다.</p>
<h3>공유 자원과 <code class="language-text">ConcurrentModificationException</code></h3>
<p>본 예제에서 이미지 파일들을 병렬로 업로드하는 작업 중 실패가 발생하면, 이미 업로드된 이미지들을 삭제하려고 한다.
이 과정에서 <code class="language-text">ConcurrentModificationException</code> 예외가 발생할 수 있다.
이는 여러 스레드가 동시에 같은 컬렉션을 수정하려 할 때 발생하는 예외이다.</p>
<p><code class="language-text">uploadFiles</code> 메서드에서 파일 업로드가 성공하면 해당 파일의 이름을 <code class="language-text">fileNames</code> 리스트에 추가한다.
만약 어떤 스레드의 업로드가 실패하면, 즉시 <code class="language-text">deleteFiles(fileNames)</code> 메서드를 호출하여 삭제 작업을 시작한다.
이때 다른 스레드가 아직 업로드를 완료하지 않아 리스트에 새로운 요소를 추가하는 상황이 발생하면 <code class="language-text">ConcurrentModificationException</code> 예외가 발생한다.</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">Exception in thread &quot;taskExecutor-1&quot; java.util.ConcurrentModificationException
at java.base/java.util.ArrayList.forEach(ArrayList.java:1513)
at practice.s3.application.ImageStorageService.deleteFiles(ImageStorageService.java:67)
at practice.s3.application.ImageStorageService.lambda$uploadFiles$0(ImageStorageService.java:38) &lt;3 internal lines&gt;</code></pre></div>
<h3>병렬 작업 종료 후 통합 예외 처리</h3>
<p>이러한 문제를 방지하기 위해, <strong>모든 병렬 작업이 끝난 후</strong>에 한꺼번에 예외를 처리하는 방식으로 코드를 개선했다.</p>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">ImageUploadResponse</span> <span class="token function">uploadFiles</span><span class="token punctuation">(</span><span class="token class-name">MultipartFile</span><span class="token punctuation">[</span><span class="token punctuation">]</span> imageFiles<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">validate</span><span class="token punctuation">(</span>imageFiles<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">AtomicBoolean</span> catchException <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AtomicBoolean</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> fileNames <span class="token operator">=</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span>imageFiles<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">parallel</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>file <span class="token operator">-&gt;</span> <span class="token function">uploadFile</span><span class="token punctuation">(</span>file<span class="token punctuation">,</span> catchException<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token class-name">Objects</span><span class="token operator">::</span><span class="token function">nonNull</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">handleException</span><span class="token punctuation">(</span>catchException<span class="token punctuation">,</span> fileNames<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token function">convertFileNamesToResponse</span><span class="token punctuation">(</span>fileNames<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">private</span> <span class="token class-name">String</span> <span class="token function">uploadFile</span><span class="token punctuation">(</span><span class="token class-name">MultipartFile</span> file<span class="token punctuation">,</span> <span class="token class-name">AtomicBoolean</span> catchException<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> storageClient<span class="token punctuation">.</span><span class="token function">upload</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        catchException<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">handleException</span><span class="token punctuation">(</span><span class="token class-name">AtomicBoolean</span> catchException<span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> fileNames<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>catchException<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        executor<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token function">deleteFiles</span><span class="token punctuation">(</span>fileNames<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">InternalServerException</span><span class="token punctuation">(</span><span class="token string">&quot;이미지 업로드 시 예외가 발생했습니다.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>여기서는 <code class="language-text">AtomicBoolean</code>을 활용하여 예외 발생 여부를 각 스레드에서 안전하게 추적한다. 업로드 과정에서 예외가 발생하면, 해당 변수를 true로 설정하여 상태를 기록한다.</p>
<p>모든 병렬 작업이 종료된 후, 이 <code class="language-text">AtomicBoolean</code> 상태를 검사함으로써 예외 발생 유무를 확인한다.
이렇게 함으로써 동시성 문제를 피하면서 안정적으로 예외를 처리할 수 있게 되었다.</p>
<h2>병렬 스트림의 제약점</h2>
<p>병렬 스트림은 내부적으로 <code class="language-text">ForkJoinPool</code>을 사용하여 자동으로 작업을 여러 스레드에 분배한다. 이러한 분배는 시스템의 프로세서 수를 고려하여 스레드 수를 결정한다. 본 포스트의 성능 측정은 7개의 스레드가 활용된 환경에서 이루어졌다.</p>
<p>병렬 스트림의 스레드 수를 조절하는 것은 기술적으로 가능하나, 이 조정은 <code class="language-text">ForJoinPool.commonPool()</code>에 대한 전역 설정을 변경하는 것이므로, 모든 병렬 스트림 작업에 영향을 미친다.</p>
<p>예를 들어, 작업 A에 최적화하기 위해 스레드 수를 10으로 설정한다면, 이는 작업 B,C,D 등 현재 진행 중인 다른 모든 병렬 스트림 작업에도 동일하게 적용된다. 따라서 각 작업의 특성에 따라 최적의 성능을 얻기 위해 병렬 스트림의 스레드 수를 독립적으로 조절하는 것이 쉽지 않다.</p>
<p>그렇다면, 더 세밀한 병렬 처리 제어를 원할 땐 어떻게 해야 할까?</p>
<h1>CompletableFuture를 활용한 병렬 업로드</h1>
<p>Java 8이 등장하면서, <code class="language-text">CompletableFuture</code>는 비동기 프로그래밍에 큰 변화를 불러왔다. 이 클래스는 비동기 연산의 결과를 나타내는 것뿐만 아니라, 그 완료 시점과 연산의 수명 주기를 세부적으로 제어할 수 있게 해준다. 이는 단순히 결과를 기다리는 것을 넘어, 연산을 시작하고, 완료하며, 여러 작업을 결합하고, 예외를 처리하는 등의 복잡한 비동기 흐름을 명시적으로 제어할 수 있다는 의미다.</p>
<p><code class="language-text">ForkJoinPool</code>은 큰 작업을 작은 단위로 분할하여 병렬로 처리한 다음, 그 결과를 합치는 데 초점을 맞추고 있다. 반면, <code class="language-text">CompletableFuture</code>는 기본적으로 사용하는 <code class="language-text">ForkJoinPool</code> 외에도, 자체적으로 지정한 executor를 통해 스레드 풀을 직접 제어할 수 있다. 이를 통해 특정 작업에 최적화된 병렬 처리가 가능해지고, 복잡한 비동기 작업 흐름을 필요에 맞게 구성할 수 있게 된다.</p>
<p>예를 들어, 이미지 업로드 작업과 같이 I/O 집약적인 작업이 있을 때,<code class="language-text">CompletableFuture</code>를 사용하여 특정 <code class="language-text">coreSize</code>인 <code class="language-text">ThreadPoolTaskExecutor</code>를 사용함으로써, 독립적인 스레드 풀을 구성하여 업로드를 병렬로 수행할 수 있다. 이는 각각의 작업이 다른 작업의 리소스 사용에 영향을 끼치지 않으면서 효율적으로 수행할 수 있도록 해준다. 이처럼 <code class="language-text">CompletableFuture</code>는 복잡한 비동기 흐름을 잘 제어하고, 각 작업에 맞는 병렬 처리를 해야 하는 상황에서 유용한 도구이다.</p>
<p>본 예제에서는 한 포스트에 최대 10장의 이미지를 업로드하는 상황을 가정하여, <code class="language-text">coreSize</code>가 10인 <code class="language-text">ThreadPoolTaskExecutor</code>를 설정해 병렬 업로드를 실행했다.</p>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AsyncConfig</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">Executor</span> <span class="token function">taskExecutor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ThreadPoolTaskExecutor</span> executor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ThreadPoolTaskExecutor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        executor<span class="token punctuation">.</span><span class="token function">setCorePoolSize</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        executor<span class="token punctuation">.</span><span class="token function">initialize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> executor<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token annotation punctuation">@Autowired</span>
<span class="token keyword">private</span> <span class="token class-name">Executor</span> executor<span class="token operator">:</span>

<span class="token keyword">public</span> <span class="token class-name">ImageUploadResponse</span> <span class="token function">uploadFiles</span><span class="token punctuation">(</span><span class="token class-name">MultipartFile</span><span class="token punctuation">[</span><span class="token punctuation">]</span> imageFiles<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">validate</span><span class="token punctuation">(</span>imageFiles<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">CompletableFuture</span><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> futures <span class="token operator">=</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span>imageFiles<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>file <span class="token operator">-&gt;</span> <span class="token class-name">CompletableFuture</span><span class="token punctuation">.</span><span class="token function">supplyAsync</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> storageClient<span class="token punctuation">.</span><span class="token function">upload</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">,</span> executor<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> fileNames <span class="token operator">=</span> <span class="token function">gatherFileNamesFromFutures</span><span class="token punctuation">(</span>futures<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token function">convertFileNamesToResponse</span><span class="token punctuation">(</span>fileNames<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">gatherFileNamesFromFutures</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">CompletableFuture</span><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> futures<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> fileNames <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">AtomicBoolean</span> catchException <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AtomicBoolean</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    futures<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>future <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            fileNames<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>future<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">CompletionException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            catchException<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">handleException</span><span class="token punctuation">(</span>catchException<span class="token punctuation">,</span> fileNames<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> fileNames<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">handleException</span><span class="token punctuation">(</span><span class="token class-name">AtomicBoolean</span> catchException<span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> fileNames<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>catchException<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        executor<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token function">deleteFiles</span><span class="token punctuation">(</span>fileNames<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">InternalServerException</span><span class="token punctuation">(</span><span class="token string">&quot;이미지 업로드 시 예외가 발생했습니다.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p><code class="language-text">uploadFiles</code> 메서드는 이미지 파일들을 병렬로 업로드한다.
<code class="language-text">CompletableFuture.supplyAsync()</code>를 사용해 병렬 작업을 시작하며 그 결과를 <code class="language-text">CompletableFuture</code>로 반환한다.</p>
<p><code class="language-text">gatherFileNamesFromFutures</code> 메서드는 <code class="language-text">join()</code> 메서드를 사용해 각 <code class="language-text">CompletableFuture</code>의 결과를 기다린 후, 해당 결과를 <code class="language-text">fileNames</code> 리스트에 추가한다.
<code class="language-text">join()</code> 메서드는 <code class="language-text">CompletableFuture</code>의 작업이 완료될 때까지 대기하고 그 결과를 반환한다.</p>
<p>만약 <code class="language-text">join()</code> 메서드 수행 중 예외가 발생하면 <code class="language-text">CompletableException</code>으로 감싸져 던져진다.
위 코드에서는 <code class="language-text">AtomicBoolean</code>을 사용하여 예외 발생 여부를 관리한다.</p>
<p>이후의 예외 처리 전략은 병렬 스트림에서 사용된 방식과 동일하다.</p>
<h2>성능 측정</h2>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">// CommonForkJoinPool
[PostFacadeService.createPost] 실행 시간(ms): 312
[PostFacadeService.createPost] 실행 시간(ms): 261
[PostFacadeService.createPost] 실행 시간(ms): 322
[PostFacadeService.createPost] 실행 시간(ms): 251
[PostFacadeService.createPost] 실행 시간(ms): 241

// ThreadPoolTaskExecutor (coreSize 10)
[PostFacadeService.createPost] 실행 시간(ms): 182
[PostFacadeService.createPost] 실행 시간(ms): 161
[PostFacadeService.createPost] 실행 시간(ms): 197
[PostFacadeService.createPost] 실행 시간(ms): 191
[PostFacadeService.createPost] 실행 시간(ms): 179</code></pre></div>
<p>스레드풀을 별도로 지정하지 않았을 때의 평균 처리 시간은 277ms였다.
반면, 커스텀 스레드풀을 적용했을 때의 평균 처리 시간은 182ms로 감소했으며, 이는 기존 병렬 스트림의 처리 시간 229ms와 비교하여 더 짧은 시간이다.</p>
<p>이 결과로부터 병렬 스트림과 <code class="language-text">CompletableFuture</code>를 사용한 일반적인 처리에서 성능 차이는 크지 않지만, 특정 작업에 최적화된 executor를 사용하면 성능이 향상될 수 있다는 결론을 얻을 수 있다.
예를 들어, 대규모 파일 I/O 작업을 수행하는 경우에는 I/O 작업에 최적화된 스레드 풀 설정을 적용하여 디스크 접근과 네트워크 전송을 병렬로 처리할 수 있다. 고성능 컴퓨팅 작업에서는 CPU 사용률을 극대화할 수 있는 스레드 풀 구성으로 성능을 향상할 수 있다.</p>
<p>이처럼 실제 사용 시나리오와 요구 사항을 고려하여 성능 테스트를 실시하고, 테스트 결과를 바탕으로 특정 작업에 최적화된 스레드 풀을 선택하는 것이 중요하다.</p>
<h1>마무리</h1>
<p>이 글을 통해, 병렬 처리를 통해 다중 이미지를 효율적으로 업로드하는 기법들을 알아보았다. 그러나 이러한 기법들은 이미지 업로드에만 국한되지 않는다.</p>
<p>예를 들면, 웹 크롤링을 할 때 여러 사이트의 데이터를 동시에 수집하는 작업에서도 병렬 처리는 큰 이점을 가져다준다. 배치 작업에서도, 서로 독립적인 작업 항목들을 병렬로 처리함으로써 전체 작업 시간을 대폭 줄일 수 있다. 데이터베이스에서는 복잡한 쿼리나 대용량 데이터 처리를 병렬로 실행하여 응답 시간을 단축할 수 있다. 서버 측에서는 사용자의 다양한 요청을 동시에 처리하기 위해 요청 처리를 병렬로 수행하여, 더 빠른 서비스 제공이 가능해진다.</p>
<p>이처럼 병렬 처리는 단순히 업로드 시간을 단축하는 것을 넘어, 다양한 분야에서 응답성과 성능을 향상하는 핵심 기술이다.</p>
<p>본문에서는 특히 병렬 스트림과 <code class="language-text">CompletableFuture</code>에 초점을 맞추어 알아보았는데, 이들은 각각의 사용 사례에 따라 장점이 있다.</p>
<p>병렬 스트림은 사용이 매우 간편하다는 장점이 있으나, 고정된 스레드 풀을 사용한다는 점에서 유연성이 다소 떨어진다.
반면, <code class="language-text">CompletableFuture</code>는 보다 복잡한 비동기 작업을 우아하게 처리할 수 있으며, 특히 커스텀 스레드 풀을 사용하여 성능을 최적화할 수 있다.</p>
<p>이들 외에도 다양한 병렬 처리 방식이 존재한다. 상황과 요구 사항에 따라 가장 적합한 방법을 선택하고 적용하는 것이 중요하다. 따라서 다양한 방법을 시도하고, 성능 측정 결과를 바탕으로 자신에게 맞는 최적의 해결책을 찾는 것이 핵심이다.</p></div></section></article></div><div></div></main><style data-emotion="css 3pb1mm">.css-3pb1mm{position:relative;padding:0 5vw;}</style><style data-emotion="css rtegya">.css-rtegya{border-bottom:1px solid rgba(255, 255, 255, 0.1);background:#0a0b0c;position:relative;padding:0 5vw;}.css-rtegya .post-card{padding-bottom:0;border-bottom:none;}.css-rtegya .post-card:after{display:none;}.css-rtegya .post-card-primary-tag{color:#fff;opacity:0.6;}.css-rtegya .post-card-title{color:#fff;opacity:0.8;-webkit-transition:all 0.2s ease-in-out;transition:all 0.2s ease-in-out;}.css-rtegya .post-card:hover .post-card-image{opacity:1;}.css-rtegya .post-card-excerpt{color:rgba(255, 255, 255, 0.6);}.css-rtegya .static-avatar{border-color:#000;}.css-rtegya .post-card-byline-content{color:rgba(255, 255, 255, 0.6);}.css-rtegya .post-card-byline-content a{color:rgba(255, 255, 255, 0.8);}.css-rtegya .author-avatar{border-color:#0a0b0c;}.css-rtegya .author-profile-image{background:#0a0b0c;}@media (max-width: 650px){.css-rtegya .post-card{-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;margin:25px;padding:25px 0 0;border-bottom:1px solid rgba(255, 255, 255, 0.1);}}</style><aside class="read-next css-rtegya"><div class="css-1q5n7pp"><style data-emotion="css si41tf">.css-si41tf{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-flex-wrap:wrap;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin:0 -25px;padding:60px 0 0 0;}</style><div class="read-next-feed css-si41tf"><style data-emotion="css 1pe6fj0">.css-1pe6fj0{position:relative;-webkit-flex:1 1 301px;-ms-flex:1 1 301px;flex:1 1 301px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;overflow:hidden;margin:0 0 40px;padding:0 20px 40px;min-height:220px;border-bottom:1px solid #eaeff1;-webkit-background-size:cover;background-size:cover;}@media (prefers-color-scheme: dark){.css-1pe6fj0{border-bottom-color:#2b2f36;}}</style><article class="post-card   css-1pe6fj0"><style data-emotion="css 19py1iz">.css-19py1iz{position:relative;display:block;overflow:hidden;border-radius:5px 5px 0 0;}</style><a class="post-card-image-link css-19py1iz" href="/post/2023-11-06-zero-downtime-deployment-2/"><style data-emotion="css zj03fh">.css-zj03fh{width:auto;height:200px;background:#c5d2d9 no-repeat center center;-webkit-background-size:cover;background-size:cover;}</style><div class="post-card-image css-zj03fh"><div class=" gatsby-image-wrapper" style="position:relative;overflow:hidden;height:100%"><div aria-hidden="true" style="width:100%;padding-bottom:51.182795698924735%"></div><img aria-hidden="true" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAACI0lEQVQoz02R22sTQRTG819Z8dkLCHnxLxFffBME31p9aKQWpdIoQk3BB0XEpgimJZLUZO/Z3aQV29zjZi8zs7nq59nZKH348X1z5pxvZncyEYsQRSHCKEgJfalBOCZPRL4kWHnZLwnTuTCATzDOCIHM/01SJsPTUEbNjOpc1nxZ5zR0GcY5hBCYxBPpubgUOA48jPwRPFKfbjMaDzDw+miPLuBR3ae6t+rpeT2pPh0yCn6hQ+uQcriIkeGMUfMYRteGNXBg9BrQu5ZUd9iC2jWgdQw0yRtUN3s2TjoqGsMmzL4De3SKGu336YA4ntINk0/jEdrtc+i6BkWpw7IM1OvfpSpKDY5jwbZNqFodtmtDN3W4TReu69KMjvPOBXgs0hv+C+xQUVEVlMvHaDRM1ChQ11VUKt9gUkBC6agEx3WgUp+qqTK0elKl2TZEHKeBAQX6Yfp6POZggiGiA9iK5GWbTQcN25Kvz2lfTAS9Os3wxMc0I+gfclpT4HIqsJgwzESEeRxJv4gZ5rSe8YA0QOQPwekfTUUoWSY9xHLK8Xsa489iBiQs58i8Lqs4NFyU7BZxik9aA3cLB7hXKOKA/GfVQrX1A0fOGSqktbOf2KvoePTxGM+/1pH7UsOD9+RLGh4X68jcyO3g5tNd3N7ak2SfvcGt3EtiF9mtfVzfLOD+uyIefjjEnRf7yG6/xZX1V1hbz2NtI49rT/K4urFDfpvYxF9AJclSZjSiLQAAAABJRU5ErkJggg==" alt="데이터베이스 복제하기(리플리케이션) 2 - 테코와 알아보는 대규모 데이터 관리 cover image" style="position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;object-position:center;opacity:1;transition-delay:500ms"/><noscript><picture><source srcset="/static/00bbc2420e9b2bcd8663a901ea1f44ed/3a443/replication-thumbnail2.png 930w,
/static/00bbc2420e9b2bcd8663a901ea1f44ed/f26ba/replication-thumbnail2.png 1372w" sizes="(max-width: 1372px) 100vw, 1372px" /><img loading="lazy" sizes="(max-width: 1372px) 100vw, 1372px" srcset="/static/00bbc2420e9b2bcd8663a901ea1f44ed/3a443/replication-thumbnail2.png 930w,
/static/00bbc2420e9b2bcd8663a901ea1f44ed/f26ba/replication-thumbnail2.png 1372w" src="/static/00bbc2420e9b2bcd8663a901ea1f44ed/f26ba/replication-thumbnail2.png" alt="데이터베이스 복제하기(리플리케이션) 2 - 테코와 알아보는 대규모 데이터 관리 cover image" style="position:absolute;top:0;left:0;opacity:1;width:100%;height:100%;object-fit:cover;object-position:center"/></picture></noscript></div></div></a><style data-emotion="css susx73">.css-susx73{-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}</style><div class="post-card-content css-susx73"><style data-emotion="css 11xyrw0">.css-11xyrw0{position:relative;display:block;color:#15171A;}.css-11xyrw0:hover{-webkit-text-decoration:none;text-decoration:none;}</style><a class="post-card-content-link css-11xyrw0" href="/post/2023-11-06-zero-downtime-deployment-2/"><style data-emotion="css 1s5mbbt">.css-1s5mbbt{margin:15px 0 0;}</style><header class="post-card-header css-1s5mbbt"><style data-emotion="css 1ws4skr">.css-1ws4skr{height:25px;margin:0 0 0.2em;color:#3eb0ef;font-size:1.7rem;font-weight:500;letter-spacing:0.2px;text-transform:uppercase;}</style><div class="post-card-primary-tag css-1ws4skr">#Database</div><style data-emotion="css 1pqz7yn">.css-1pqz7yn{margin:0 0 0.4em;line-height:1.15em;-webkit-transition:color 0.2s ease-in-out;transition:color 0.2s ease-in-out;}@media (prefers-color-scheme: dark){.css-1pqz7yn{color:rgba(255, 255, 255, 0.85);}}</style><h2 class="post-card-title css-1pqz7yn">데이터베이스 복제하기(리플리케이션) 2 - 테코와 알아보는 대규모 데이터 관리</h2></header><style data-emotion="css eyqgbm">.css-eyqgbm{font-family:Georgia,serif;}@media (prefers-color-scheme: dark){.css-eyqgbm{color:#90a2aa!important;}}</style><section class="post-card-excerpt css-eyqgbm"><p>테코의 고민 2 - 이벤트에  어떤 내용을 기록해야 해? GTID…</p></section></a><style data-emotion="css k6f2l9">.css-k6f2l9{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;padding:0;}</style><footer class="post-card-meta css-k6f2l9"><ul class="author-list css-teqkql"><li class="author-list-item css-1q168dw"><style data-emotion="css 1o16atw">.css-1o16atw{position:absolute;bottom:105%;z-index:999;display:block;padding:2px 8px;color:white;font-size:1.2rem;letter-spacing:0.2px;white-space:nowrap;background:#15171A;border-radius:3px;box-shadow:rgba(39, 44, 49, 0.08) 0 12px 26px,rgba(39, 44, 49, 0.03) 1px 3px 8px;opacity:0;-webkit-transition:all 0.35s cubic-bezier(0.4, 0.01, 0.165, 0.99);transition:all 0.35s cubic-bezier(0.4, 0.01, 0.165, 0.99);-webkit-transform:translateY(6px);-moz-transform:translateY(6px);-ms-transform:translateY(6px);transform:translateY(6px);pointer-events:none;}@media (max-width: 700px){.css-1o16atw{display:none;}}</style><div class="author-name-tooltip css-1o16atw">5기_여우</div><a class="author-avatar css-cdhz0m" href="/author/5-기-여우/"><div class="author-profile-image css-121fnpm gatsby-image-wrapper" style="position:relative;overflow:hidden"><div aria-hidden="true" style="width:100%;padding-bottom:97.00000000000001%"></div><img aria-hidden="true" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAAAsTAAALEwEAmpwYAAACq0lEQVQ4y31US08UQRDeX4YXIweNXjXxokejCScS9WRIvHoiEkF8cCGaiBEBkcSDkccSwIOSxcDOY2F33rOzO5nZmQH97K7peS3Gw5fu6ar6uuqr6qlFjorIZXAUDGwFMdsPbDnfk53ZUqhVkG9xHlgSajFzJLjpmrB1wAyRLbG9ikScJZk98yfIeRxHaDVLhJSBXJC71YsyAn5RZuf+eYzwrUW2OOSZMefcSQRkhETUbeG016E9j0vPZZKIJCHCcsnu0L5ElnhthMomvB+LSPpGWq5zPqY2TET65RKkZfKz2JFgLz9Ee3IE/u4ckp6Wlx9lPkTo/EMrt9qk0JJhHazDXByHMX8Lxtx1BL9WEfc1uigW5RaEmX52STvuyLpMdruZZqTvw/w2A337LXobU4h7OkLzSMSkCaRNsQvxs7EgnagRx0h8E1G3jf72LMyFMRiNTbg/V0V2Ko1X0eVz4qpE4rEM7De34SzcRXflPq3G1AUYq4+hH9ThSTtIuiqqY1fSMB8XNhq9r0/gvL8Hc/oSjGcXoc1ehT49Cv3pCMxPE7AOdxFqDfGS5Mr81orX0WSaaAgay7BYZpGygc7zKziaH4Ov7MCX6vBXxnH86ga0vSWc+WmXeXd5yTSP5acXWUxc34K3Pgn7xWVIHx5hbfoBOo0tnLFuspZi8+NLTNy5hoP6ZyBgutoKDXVeIduXnh67ib2C4PALzJlRnLy+iWZ9Ca70nTVHAfpt7K2v4d38HEx5H797J9SQfBKE/jU6LCHxOhgoWwikDYT6IcucjYzbItsfRopAwylrWt7dDOKbEbbYqAiIwMTTiJh/52di5WXm3646ZKenx9lblZsKGdQKGe3FxYRKMmra5dxYAQ8cDq5KU0b6s+XPTz6vYVz5K6fDOiDIhPC/kPAXI1J1I2tzSR0AAAAASUVORK5CYII=" alt="5기_여우" style="position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;object-position:center;opacity:1"/><noscript><picture><source srcset="/static/1bd577fab62487b8309c9e635d0ce7b2/8ac63/fox.png 200w,
/static/1bd577fab62487b8309c9e635d0ce7b2/3891b/fox.png 400w,
/static/1bd577fab62487b8309c9e635d0ce7b2/bc8e0/fox.png 800w,
/static/1bd577fab62487b8309c9e635d0ce7b2/74c84/fox.png 889w" sizes="(max-width: 800px) 100vw, 800px" /><img loading="lazy" sizes="(max-width: 800px) 100vw, 800px" srcset="/static/1bd577fab62487b8309c9e635d0ce7b2/8ac63/fox.png 200w,
/static/1bd577fab62487b8309c9e635d0ce7b2/3891b/fox.png 400w,
/static/1bd577fab62487b8309c9e635d0ce7b2/bc8e0/fox.png 800w,
/static/1bd577fab62487b8309c9e635d0ce7b2/74c84/fox.png 889w" src="/static/1bd577fab62487b8309c9e635d0ce7b2/bc8e0/fox.png" alt="5기_여우" style="position:absolute;top:0;left:0;opacity:1;width:100%;height:100%;object-fit:cover;object-position:center"/></picture></noscript></div></a></li></ul><style data-emotion="css 12ys16c">.css-12ys16c{-webkit-flex:1 1 50%;-ms-flex:1 1 50%;flex:1 1 50%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;margin:4px 0 0 10px;color:#90a2aa;font-size:1.2rem;line-height:1.4em;font-weight:400;letter-spacing:0.2px;text-transform:uppercase;}.css-12ys16c span{margin:0;}.css-12ys16c a{color:#434952;font-weight:600;}@media (prefers-color-scheme: dark){.css-12ys16c a{color:rgba(255, 255, 255, 0.75);}}</style><div class="post-card-byline-content css-12ys16c"><span><a href="/author/5-기-여우/">5기_여우</a></span><span class="post-card-byline-date"><time dateTime="2023-11-23">23 Nov 2023</time> <span class="bull">•</span> <!-- -->10<!-- --> min read</span></div></footer></div></article></div></div></aside><style data-emotion="css 1snipao">.css-1snipao{position:relative;padding:0 5vw;position:relative;padding-top:20px;padding-bottom:60px;color:#fff;background:#000;}</style><footer class="css-1snipao"><style data-emotion="css 1fhv7oo">.css-1fhv7oo{margin:0 auto;max-width:1040px;width:100%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-flex-wrap:wrap;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(255, 255, 255, 0.7);font-size:1.3rem;}.css-1fhv7oo a{color:rgba(255, 255, 255, 0.7);}.css-1fhv7oo a:hover{color:rgba(255, 255, 255, 1);-webkit-text-decoration:none;text-decoration:none;}@media (max-width: 650px){.css-1fhv7oo{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}}</style><div class="css-1fhv7oo"><section class="copyright"><a href="/">Tecoble</a> © <!-- -->2023<!-- --> <a href="/">| <!-- -->Tecoble<!-- --> <!-- -->is based on woowacourse</a></section><style data-emotion="css 29c7f9">.css-29c7f9{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}.css-29c7f9 a{position:relative;margin-left:20px;}.css-29c7f9 a:before{content:'';position:absolute;top:11px;left:-11px;display:block;width:2px;height:2px;background:#fff;border-radius:100%;}.css-29c7f9 a:first-of-type:before{display:none;}@media (max-width: 650px){.css-29c7f9 a:first-of-type{margin-left:0;}}</style><nav class="css-29c7f9"><a href="/">Latest Posts</a><a href="https://github.com/scttcper/gatsby-casper" target="_blank" rel="noopener noreferrer">Casper</a><a href="/rss.xml">RSS</a></nav></div></footer></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-7YLT36LV0M"></script><script>
      
      
      if(true) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){window.dataLayer && window.dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-7YLT36LV0M', {"send_page_view":false});
      }
      </script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/post/2023-11-23-multiple-image-upload/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-f33cc994945b2249d5ee.js"],"app":["/app-7871a49fb71b5d2fd8af.js"],"component---src-pages-404-tsx":["/component---src-pages-404-tsx-f7da68947e50ce346751.js"],"component---src-pages-about-tsx":["/component---src-pages-about-tsx-947f5f80f30345c8f7f8.js"],"component---src-templates-author-tsx":["/component---src-templates-author-tsx-e3b8ed1aaa2c94077bfa.js"],"component---src-templates-index-tsx":["/component---src-templates-index-tsx-ead65a5aeec7d773bee7.js"],"component---src-templates-post-tsx":["/component---src-templates-post-tsx-a08628f9047d81b892e4.js"],"component---src-templates-tags-tsx":["/component---src-templates-tags-tsx-a3927cd825a62272db18.js"]};/*]]>*/</script><script src="/polyfill-f33cc994945b2249d5ee.js" nomodule=""></script><script src="/component---src-templates-post-tsx-a08628f9047d81b892e4.js" async=""></script><script src="/commons-4c188b18bcaae3f07bde.js" async=""></script><script src="/app-7871a49fb71b5d2fd8af.js" async=""></script><script src="/framework-2de79c8137b068b61a3a.js" async=""></script><script src="/webpack-runtime-674180cef417bd6b6e8f.js" async=""></script></body></html>